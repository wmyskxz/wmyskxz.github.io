<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#3.0.0-rc.1'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
      <meta name="robots" content="noindex,follow">
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
  <title>标签：项目 - 我没有三颗心脏的博客</title>
  

  

  <!-- feed -->
  

  <!-- import meta -->
  

  <!-- link -->
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  

  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
  

  

  <!-- import link -->
  

  
    
      
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.18.1/styles/solarized-light.css">

    
  
  
    
<link rel="stylesheet" href="/css/style.css">

  

  
  
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body>
  
  
  
  <div class="cover-wrapper">
    <cover class='cover ' style="display: none;">
      <div class='cover-body'>
  <div class='a'>
    
    
      <p class="title">我没有三颗心脏</p>
    
    
      <p class="subtitle">分享知识&技术&成长&思考</p>
    
  </div>
  <div class='b'>
    
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <input type="text" class="input u-search-input" placeholder="search here..." />
          <i class="icon fas fa-search fa-fw"></i>
        </form>
      </div>
    
    <div class='menu navigation search'>
      <div class='list-h'>
        
          
            <a href="/"
              
              
              id="home">
              <i class='fas fa-rss fa-fw'></i><p>博客</p>
            </a>
          
            <a href="/categories/"
              
              
              id="categories">
              <i class='fas fa-folder-open fa-fw'></i><p>分类</p>
            </a>
          
            <a href="/tags/"
              
              
              id="tags">
              <i class='fas fa-tags fa-fw'></i><p>标签</p>
            </a>
          
            <a href="/archives/"
              
              
              id="archives">
              <i class='fas fa-archive fa-fw'></i><p>归档</p>
            </a>
          
            <a href="/about/"
              
              
              id="about">
              <i class='fas fa-info-circle fa-fw'></i><p>关于</p>
            </a>
          
        
      </div>
    </div>
  </div>
</div>

      <div class="scroll-down" style="display: none;"><i class="fa fa-chevron-down scroll-down-effects"></i></div>
    </cover>
    <header class="l_header shadow blur">
  <div class='container'>
  <div class='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h m-phone' id="pjax-header-nav-list">
        <li><a class="s-comment fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
            <img no-lazy class='logo' src='https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/Logo-NavBar@3x.png'/>
          
          
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h m-pc'>
          
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>

			<ul class='switcher nav-list-h m-phone'>
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

  </div>
  


  <div class="l_body nocover">
    <div class='body-wrapper' id="pjax-container">
      
        <!--此文件用来存放一些不方便取值的变量--> 
<!--思路大概是将值藏到重加载的区域内--> 
 
 
 
<div id="pjax-data" style="display: none"> 
  <div id="pjax-ispage">false</div> 
  <div id="pjax-pageTitle"></div> 
  <div id="pjax-enable-cover">true</div> 
  <div id="pjax-comment-path">none</div> 
  <div id="pjax-comment-placeholder">none</div> 
</div> 
 
 
<script> 
  // 处理封面 此时 jquery 还没加载 
  if ("none" == "none") { // 移除封面 
    document.getElementsByClassName('cover')[0].style.display = "none"; 
    document.getElementsByClassName('l_body')[0].classList.add("nocover"); 
    document.getElementsByClassName('l_header', 'cover-wrapper')[0].classList.add("show"); 
  } else { 
    if ("none" == "blog") { // 半屏 
      document.getElementsByClassName('cover')[0].classList.remove("full"); 
      document.getElementsByClassName('cover')[0].classList.add("half"); 
      document.getElementsByClassName('scroll-down')[0].style.display = "none"; 
    } else if ("none" == "docs") { // 全屏 
      document.getElementsByClassName('cover')[0].classList.remove("half"); 
      document.getElementsByClassName('cover')[0].classList.add("full"); 
      document.getElementsByClassName('scroll-down')[0].style.display = ""; 
    } 
    document.getElementsByClassName('cover')[0].style.display = ""; 
    document.getElementsByClassName('l_body', 'show')[0].classList.remove("nocover"); 
    document.getElementsByClassName('l_header', 'cover-wrapper')[0].classList.remove("show"); 
  } 
</script> 

      
      


<div class='l_main'>
  
    
      
  <section class="post-list ">
    
    
      
        
          <div class='post-wrapper'>
            <article class="post white-box shadow reveal ">
  


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h2 class="title">
    <a href="/2018/04/28/mo-fang-tian-mao-shi-zhan-ssm-ban-hou-tai-kai-fa/">
      模仿天猫实战【SSM版】——后台开发
    </a>
  </h2>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a class='author' href="" rel="nofollow">
    <img no-lazy src="">
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/JavaWeb%E5%9F%BA%E7%A1%80/SSM/%E9%A1%B9%E7%9B%AE/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>JavaWeb基础/SSM/项目</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2018年4月28日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  


            
          
            
              

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>上一篇文章链接：<a href="https://www.jianshu.com/p/5e44ee046b43" target="_blank" rel="noopener">模仿天猫实战【SSM版】——项目起步</a></p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-3eee3c0023557f8e.png" alt=""></p>
<h2 id="后台需求分析"><a href="#后台需求分析" class="headerlink" title="后台需求分析"></a>后台需求分析</h2><p>在开始码代码之前，还是需要先清楚自己要做什么事情，后台具体需要实现哪些功能：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-ccc3aa2fdf8e00de.png" alt=""></p>
<ul>
<li><strong>注意：</strong> 订单、用户、订单、推荐链接均不提供增删的功能。</li>
</ul>
<hr>
<h2 id="后台界面设计"><a href="#后台界面设计" class="headerlink" title="后台界面设计"></a>后台界面设计</h2><p>不像前端那样有原型直接照搬就可以了，后台的设计还真的有难到我…毕竟我是一个对美有一定要求的人，一方面想尽量的简洁、简单，另一方面又不想要太难看，那怎么办呢？</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-c27798bcd2932a19.png" alt=""></p>
<p>那当然是找模板了，找到一个顺眼的下载下来就开始改，</p>
<p>这个模板的原地址在这里：<a href="http://www.cssmoban.com/cssthemes/7381.shtml" target="_blank" rel="noopener">戳这里</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-f1c023b9fdbb91ff.png" alt=""></p>
<p>顺便安利一下 FireFox ，真是开发神器，配合着修改，棒棒哒：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-16d9367e5b6b201e.png" alt=""></p>
<h4 id="经过一番折腾…"><a href="#经过一番折腾…" class="headerlink" title="经过一番折腾…"></a>经过一番折腾…</h4><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-c5f593fb37178a82.png" alt=""></p>
<p>摁，就这风格了，而且我还发现右上角的【Search】框是下载的模板用 js 实现的…对于管理来说更加方便了….而且居然还实现了分页….</p>
<p>一个邪恶的想法又诞生了…</p>
<h4 id="一些规定"><a href="#一些规定" class="headerlink" title="一些规定"></a>一些规定</h4><blockquote>
<ul>
<li>为了降低项目的难度，我们做了很多的精简，现在我们作出如下的规定：</li>
</ul>
</blockquote>
<ul>
<li><strong>全站没有商家，只有一家 Tmall ，后台没有验证，可以直接进入</strong></li>
<li><strong>前台的路径就是默认路径，后台的路径需要加上 “/admin” 后缀，</strong>如访问后台则为：localhost/admin （<strong>默认为分类管理页</strong>）</li>
<li><strong>管理路径统一为：admin/listXxxxx</strong>，如分类管理路径为：admin/listCategory，用户管理路径为：admin/listUser，诸如此类</li>
<li><strong>编辑路径统一为：admin/editXxxxx</strong>，如编辑分类路径为：admin/editCategory，产品编辑页为：admin/editProduct，诸如此类</li>
<li><strong>删除路径统一为：admin/deleteXxxxx</strong></li>
<li><strong>更新路径统一为：admin/updateXxxxx</strong></li>
</ul>
<blockquote>
<ul>
<li>关于页面路径的一些规定：</li>
</ul>
</blockquote>
<ul>
<li>前端页面统一在【WEB-INF/views】下，后端页面统一在【WEB-INF/views/admin】下</li>
</ul>
<hr>
<h2 id="分类管理"><a href="#分类管理" class="headerlink" title="分类管理"></a>分类管理</h2><p>正式开始编写我们的代码，以 Category 为例。</p>
<h4 id="编写-Service-层"><a href="#编写-Service-层" class="headerlink" title="编写 Service 层"></a>编写 Service 层</h4><p>我们需要在这一层上考虑需要完成的功能，对应我们上面画的后台功能图，分类管理也就是完成分类的查询还有修改的工作：</p>
<pre><code>package cn.wmyskxz.service;

import cn.wmyskxz.pojo.Category;

import java.util.List;

public interface CategoryService {

    /**
     * 返回分类列表
     * @return
     */
    List&lt;Category&gt; list();

    /**
     * 通过id获取对应的数据
     * @param id
     * @return
     */
    Category get(Integer id);

    /**
     * 更新分类
     * @param category
     * @return
     */
    void update(Category category);
}</code></pre><ul>
<li>编写 CategoryServiceImpl ：<br>在同一包下编写实现类</li>
</ul>
<pre><code>package cn.wmyskxz.service;

import cn.wmyskxz.mapper.CategoryMapper;
import cn.wmyskxz.pojo.Category;
import cn.wmyskxz.pojo.CategoryExample;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;

/**
 * CategoryService 的实现类
 *
 * @author: @我没有三颗心脏
 * @create: 2018-04-27-下午 16:35
 */
@Service
public class CategoryServiceImpl implements CategoryService {

    @Autowired
    CategoryMapper categoryMapper;

    public List&lt;Category&gt; list() {
        CategoryExample example = new CategoryExample();
        List&lt;Category&gt; categories = categoryMapper.selectByExample(example);
        return categories;
    }

    public Category get(Integer id) {
        return categoryMapper.selectByPrimaryKey(id);
    }

    public void update(Category category) {
        categoryMapper.updateByPrimaryKey(category);
    }
}</code></pre><h4 id="编写-CategoryController"><a href="#编写-CategoryController" class="headerlink" title="编写 CategoryController"></a>编写 CategoryController</h4><p>根据业务需求可以很容易的编写出来：</p>
<pre><code>package cn.wmyskxz.controller;

import cn.wmyskxz.pojo.Category;
import cn.wmyskxz.service.CategoryService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;

import java.util.List;

/**
 * Category 的控制类
 *
 * @author: @我没有三颗心脏
 * @create: 2018-04-27-下午 16:37
 */
@Controller
@RequestMapping(&quot;/admin&quot;)
public class CategoryController {

    @Autowired
    CategoryService categoryService;

    @RequestMapping(&quot;/listCategory&quot;)
    public String list(Model model) {
        List&lt;Category&gt; categories = categoryService.list();
        model.addAttribute(&quot;categories&quot;, categories);
        return &quot;admin/listCategory&quot;;
    }

    @RequestMapping(&quot;/editCategory&quot;)
    public String edit(Category category,Model model) {
        model.addAttribute(&quot;category&quot;, category);
        return &quot;admin/editCategory&quot;;
    }

    @RequestMapping(&quot;/updateCategory&quot;)
    public String update(Category category) {
        categoryService.update(category);
        return &quot;redirect:listCategory&quot;;
    }
}</code></pre><h4 id="JSP-相关文件编写"><a href="#JSP-相关文件编写" class="headerlink" title="JSP 相关文件编写"></a>JSP 相关文件编写</h4><p>自己研究了一会儿这个模板，感觉还是挺好改的，然后就给改成了大概以下这个样子（<em>自己在数据库中加入了 16 条数据</em>）：</p>
<ul>
<li>分类管理页</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-4a983d7478357872.png" alt=""></p>
<ul>
<li>分类编辑页</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-16014296cfec5ea8.png" alt=""></p>
<p>模板下载下来之后文件目录是这样的：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-971cc1225aa97f5a.png" alt=""></p>
<p>我们直接整个拷贝【assets】文件夹放在【webapp】目录下，然后根据模板里面的代码就可以开始修改了，修改下来的两个文件源码如下：</p>
<ul>
<li>listCategory.jsp</li>
</ul>
<pre><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;
         pageEncoding=&quot;UTF-8&quot; isELIgnored=&quot;false&quot; %&gt;
&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
    &lt;title&gt;模仿天猫-后台&lt;/title&gt;
    &lt;!-- Bootstrap Styles--&gt;
    &lt;link href=&quot;../assets/css/bootstrap.css&quot; rel=&quot;stylesheet&quot; /&gt;
    &lt;!-- FontAwesome Styles--&gt;
    &lt;link href=&quot;../assets/css/font-awesome.css&quot; rel=&quot;stylesheet&quot; /&gt;
    &lt;!-- Morris Chart Styles--&gt;

    &lt;!-- Custom Styles--&gt;
    &lt;link href=&quot;../assets/css/custom-styles.css&quot; rel=&quot;stylesheet&quot; /&gt;
    &lt;!-- Google Fonts--&gt;
    &lt;link href=&#39;https://fonts.googleapis.com/css?family=Open+Sans&#39; rel=&#39;stylesheet&#39; type=&#39;text/css&#39; /&gt;
    &lt;!-- TABLE STYLES--&gt;
    &lt;link href=&quot;../assets/js/dataTables/dataTables.bootstrap.css&quot; rel=&quot;stylesheet&quot; /&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;wrapper&quot;&gt;
    &lt;nav class=&quot;navbar navbar-default top-navbar&quot; role=&quot;navigation&quot;&gt;
        &lt;div class=&quot;navbar-header&quot;&gt;
            &lt;button type=&quot;button&quot; class=&quot;navbar-toggle&quot; data-toggle=&quot;collapse&quot; data-target=&quot;.sidebar-collapse&quot;&gt;
                &lt;span class=&quot;sr-only&quot;&gt;Toggle navigation&lt;/span&gt;
                &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
                &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
                &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
            &lt;/button&gt;
            &lt;a class=&quot;navbar-brand&quot; href=&quot;listCategory&quot;&gt;Tmall&lt;/a&gt;
        &lt;/div&gt;
    &lt;/nav&gt;

    &lt;!--/. NAV TOP  --&gt;
    &lt;nav class=&quot;navbar-default navbar-side&quot; role=&quot;navigation&quot;&gt;
        &lt;div class=&quot;sidebar-collapse&quot;&gt;
            &lt;ul class=&quot;nav&quot; id=&quot;main-menu&quot;&gt;

                &lt;li&gt;
                    &lt;a class=&quot;active-menu&quot; href=&quot;listCategory&quot;&gt;&lt;i class=&quot;fa fa-bars&quot;&gt;&lt;/i&gt; 分类管理&lt;/a&gt;
                &lt;/li&gt;
                &lt;li&gt;
                    &lt;a href=&quot;listUser&quot;&gt;&lt;i class=&quot;fa fa-user&quot;&gt;&lt;/i&gt; 用户管理&lt;/a&gt;
                &lt;/li&gt;
                &lt;li&gt;
                    &lt;a href=&quot;listOrder&quot;&gt;&lt;i class=&quot;fa fa-list-alt&quot;&gt;&lt;/i&gt; 订单管理&lt;/a&gt;
                &lt;/li&gt;
                &lt;li&gt;
                    &lt;a href=&quot;listProduct&quot;&gt;&lt;i class=&quot;fa fa-th-list&quot;&gt;&lt;/i&gt; 产品管理&lt;/a&gt;
                &lt;/li&gt;
                &lt;li&gt;
                    &lt;a href=&quot;listLink&quot;&gt;&lt;i class=&quot;fa fa-link&quot;&gt;&lt;/i&gt; 推荐链接管理&lt;/a&gt;
                &lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;

    &lt;/nav&gt;
    &lt;!-- /. NAV SIDE  --&gt;
    &lt;div id=&quot;page-wrapper&quot;&gt;
        &lt;div id=&quot;page-inner&quot;&gt;
            &lt;div class=&quot;row&quot;&gt;
                &lt;div class=&quot;col-md-12&quot;&gt;
                    &lt;h1 class=&quot;page-header&quot;&gt;
                        分类管理
                        &lt;small&gt;&lt;/small&gt;
                    &lt;/h1&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class=&quot;row&quot;&gt;
                &lt;div class=&quot;col-md-12&quot;&gt;
                    &lt;!-- Advanced Tables --&gt;
                    &lt;div class=&quot;panel panel-default&quot;&gt;
                        &lt;div class=&quot;panel-heading&quot;&gt;
                            分类管理表
                        &lt;/div&gt;
                        &lt;div class=&quot;panel-body&quot;&gt;
                            &lt;div class=&quot;table-responsive&quot;&gt;
                                &lt;table class=&quot;table table-striped table-bordered table-hover&quot; id=&quot;dataTables-example&quot;&gt;
                                    &lt;thead&gt;
                                    &lt;tr&gt;
                                        &lt;th&gt;分类id&lt;/th&gt;
                                        &lt;th&gt;分类名称&lt;/th&gt;

                                        &lt;th&gt;编辑分类&lt;/th&gt;
                                        &lt;th&gt;产品管理&lt;/th&gt;
                                        &lt;th&gt;属性管理&lt;/th&gt;
                                    &lt;/tr&gt;
                                    &lt;/thead&gt;
                                    &lt;tbody&gt;
                                    &lt;c:forEach items=&quot;${categories}&quot; var=&quot;c&quot;&gt;
                                        &lt;tr&gt;
                                            &lt;td&gt;${c.id}&lt;/td&gt;
                                            &lt;td&gt;${c.name}&lt;/td&gt;

                                            &lt;td&gt;&lt;a href=&quot;editCategory?id=${c.id}&amp;name=${c.name}&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-th-list&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
                                            &lt;td&gt;&lt;a href=&quot;listProduct?category_id=${c.id}&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-shopping-cart&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
                                            &lt;td&gt;&lt;a href=&quot;listProperty?category_id=${c.id}&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-edit&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
                                        &lt;/tr&gt;
                                    &lt;/c:forEach&gt;
                                    &lt;/tbody&gt;
                                &lt;/table&gt;
                            &lt;/div&gt;

                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;!--End Advanced Tables --&gt;
                &lt;/div&gt;
            &lt;/div&gt;

        &lt;/div&gt;
    &lt;/div&gt;
    &lt;!-- /. PAGE WRAPPER  --&gt;
&lt;/div&gt;
&lt;!-- /. WRAPPER  --&gt;
&lt;!-- JS Scripts--&gt;
&lt;!-- jQuery Js --&gt;
&lt;script src=&quot;../assets/js/jquery-1.10.2.js&quot;&gt;&lt;/script&gt;
&lt;!-- Bootstrap Js --&gt;
&lt;script src=&quot;../assets/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;!-- Metis Menu Js --&gt;
&lt;script src=&quot;../assets/js/jquery.metisMenu.js&quot;&gt;&lt;/script&gt;
&lt;!-- DATA TABLE SCRIPTS --&gt;
&lt;script src=&quot;../assets/js/dataTables/jquery.dataTables.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;../assets/js/dataTables/dataTables.bootstrap.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
    $(document).ready(function () {
        $(&#39;#dataTables-example&#39;).dataTable();
    });
&lt;/script&gt;
&lt;!-- Custom Js --&gt;
&lt;script src=&quot;../assets/js/custom-scripts.js&quot;&gt;&lt;/script&gt;


&lt;/body&gt;
&lt;/html&gt;</code></pre><ul>
<li>editCategory.jsp</li>
</ul>
<pre><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;
         pageEncoding=&quot;UTF-8&quot; isELIgnored=&quot;false&quot; %&gt;
&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;/&gt;
    &lt;title&gt;模仿天猫-后台&lt;/title&gt;
    &lt;!-- Bootstrap Styles--&gt;
    &lt;link href=&quot;../assets/css/bootstrap.css&quot; rel=&quot;stylesheet&quot;/&gt;
    &lt;!-- FontAwesome Styles--&gt;
    &lt;link href=&quot;../assets/css/font-awesome.css&quot; rel=&quot;stylesheet&quot;/&gt;
    &lt;!-- Morris Chart Styles--&gt;

    &lt;!-- Custom Styles--&gt;
    &lt;link href=&quot;../assets/css/custom-styles.css&quot; rel=&quot;stylesheet&quot;/&gt;
    &lt;!-- Google Fonts--&gt;
    &lt;link href=&#39;https://fonts.googleapis.com/css?family=Open+Sans&#39; rel=&#39;stylesheet&#39; type=&#39;text/css&#39;/&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;wrapper&quot;&gt;
    &lt;nav class=&quot;navbar navbar-default top-navbar&quot; role=&quot;navigation&quot;&gt;
        &lt;div class=&quot;navbar-header&quot;&gt;
            &lt;button type=&quot;button&quot; class=&quot;navbar-toggle&quot; data-toggle=&quot;collapse&quot; data-target=&quot;.sidebar-collapse&quot;&gt;
                &lt;span class=&quot;sr-only&quot;&gt;Toggle navigation&lt;/span&gt;
                &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
                &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
                &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
            &lt;/button&gt;
            &lt;a class=&quot;navbar-brand&quot; href=&quot;listCategory&quot;&gt;Tmall&lt;/a&gt;
        &lt;/div&gt;
    &lt;/nav&gt;

    &lt;!--/. NAV TOP  --&gt;
    &lt;nav class=&quot;navbar-default navbar-side&quot; role=&quot;navigation&quot;&gt;
        &lt;div class=&quot;sidebar-collapse&quot;&gt;
            &lt;ul class=&quot;nav&quot; id=&quot;main-menu&quot;&gt;

                &lt;li&gt;
                    &lt;a class=&quot;active-menu&quot; href=&quot;listCategory&quot;&gt;&lt;i class=&quot;fa fa-bars&quot;&gt;&lt;/i&gt; 分类管理&lt;/a&gt;
                &lt;/li&gt;
                &lt;li&gt;
                    &lt;a href=&quot;listUser&quot;&gt;&lt;i class=&quot;fa fa-user&quot;&gt;&lt;/i&gt; 用户管理&lt;/a&gt;
                &lt;/li&gt;
                &lt;li&gt;
                    &lt;a href=&quot;listOrder&quot;&gt;&lt;i class=&quot;fa fa-list-alt&quot;&gt;&lt;/i&gt; 订单管理&lt;/a&gt;
                &lt;/li&gt;
                &lt;li&gt;
                    &lt;a href=&quot;listProduct&quot;&gt;&lt;i class=&quot;fa fa-th-list&quot;&gt;&lt;/i&gt; 产品管理&lt;/a&gt;
                &lt;/li&gt;
                &lt;li&gt;
                    &lt;a href=&quot;listLink&quot;&gt;&lt;i class=&quot;fa fa-link&quot;&gt;&lt;/i&gt; 推荐链接管理&lt;/a&gt;
                &lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;

    &lt;/nav&gt;
    &lt;!-- /. NAV SIDE  --&gt;
    &lt;div id=&quot;page-wrapper&quot;&gt;
        &lt;div id=&quot;page-inner&quot;&gt;
            &lt;div class=&quot;row&quot;&gt;
                &lt;div class=&quot;col-md-12&quot;&gt;
                    &lt;h1 class=&quot;page-header&quot;&gt;
                        分类管理
                        &lt;small&gt; - id:${category.id} &lt;/small&gt;
                    &lt;/h1&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class=&quot;row&quot;&gt;
                &lt;div class=&quot;col-md-6&quot;&gt;
                    &lt;!-- Advanced Tables --&gt;
                    &lt;div class=&quot;panel panel-default&quot;&gt;
                        &lt;div class=&quot;panel-heading&quot;&gt;
                            编辑分类
                        &lt;/div&gt;
                        &lt;div class=&quot;panel-body&quot;&gt;
                            &lt;div class=&quot;row col-lg-12&quot;&gt;
                                &lt;form action=&quot;updateCategory&quot; role=&quot;form&quot;&gt;
                                    &lt;div class=&quot;form-group&quot;&gt;
                                        &lt;%-- 隐藏id属性，一并提交 --%&gt;
                                        &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;${category.id}&quot;&gt;
                                        &lt;label&gt;分类名称：&lt;/label&gt;
                                        &lt;input name=&quot;name&quot; class=&quot;form-control&quot; value=&quot;${category.name}&quot;&gt; &lt;br/&gt;
                                        &lt;div class=&quot;pull-right&quot;&gt;
                                            &lt;input type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;
                                        &lt;/div&gt;
                                    &lt;/div&gt;
                                &lt;/form&gt;
                            &lt;/div&gt;

                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;!--End Advanced Tables --&gt;
                &lt;/div&gt;
            &lt;/div&gt;

        &lt;/div&gt;
    &lt;/div&gt;
    &lt;!-- /. PAGE WRAPPER  --&gt;
&lt;/div&gt;
&lt;!-- /. WRAPPER  --&gt;
&lt;!-- JS Scripts--&gt;
&lt;!-- jQuery Js --&gt;
&lt;script src=&quot;../assets/js/jquery-1.10.2.js&quot;&gt;&lt;/script&gt;
&lt;!-- Bootstrap Js --&gt;
&lt;script src=&quot;../assets/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h4 id="这样就完成了-Category-的后台管理模块"><a href="#这样就完成了-Category-的后台管理模块" class="headerlink" title="这样就完成了 Category 的后台管理模块"></a>这样就完成了 Category 的后台管理模块</h4><p>其他模块的思路跟 Category 如出一辙，就比较偏向于体力劳动了…</p>
<ul>
<li><strong>注意：</strong> 所有本类的 id 属性均为 <code>id</code> ，所有外键的 id 都是 <code>属性名_id</code> 这样的格式，保持统一！</li>
</ul>
<hr>
<h2 id="Example-条件查询"><a href="#Example-条件查询" class="headerlink" title="Example 条件查询"></a>Example 条件查询</h2><p>MyBatis 逆向工程自动生成文件的时候自动生成了 Example 条件查询类，我们到底应该怎么使用它呢，这里简要的说明一下。</p>
<p>不得不说这个东西还挺神奇，也很方便，比如我们需要查询 category_id 对应下的属性表，我们可以这样写：</p>
<pre><code>public List&lt;Property&gt; list(Integer category_id) {
    PropertyExample example = new PropertyExample();
    example.or().andCategory_idEqualTo(category_id);
    List&lt;Property&gt; properties = propertyMapper.selectByExample(example);
    return properties;
}</code></pre><p>通过方法名其实也很容易看懂这些是什么意思，我们首先创建了一个 PropertyExample 实例对象，然后通过 <code>.or()</code> 方法开启条件查询，<code>.andCategory_idEqualTo()</code> 匹配对应的 category_id ，自动生成的 sql 语句就像这样：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-77a9f0157eba3e78.png" alt=""></p>
<blockquote>
<p><a href="https://blog.csdn.net/biandous/article/details/65630783" target="_blank" rel="noopener">更多详情戳这里 - 引用其他博客的详细说明</a></p>
</blockquote>
<hr>
<h2 id="IDEA-快速重构"><a href="#IDEA-快速重构" class="headerlink" title="IDEA 快速重构"></a>IDEA 快速重构</h2><p>当我编写好了 PropertyService 、PropertyServiceImpl、 PropertyController 之后再想要去编写 Product 的这一系列文件的时候，发现其实很多代码都是重复的，只是很少一部分的代码需要改动，暂时不考虑设计模式的话，我们可以使用 IDEA 来完成快速重构：</p>
<ul>
<li>直接复制 PropertyController 的代码到 ProductController 中，然后【Ctrl + F】搜索 Property ：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-02324398e7cb52b3.png" alt=""></p>
<p>我们可以发现所有的 Property 都高亮了，然后我们怎么批量修改呢？</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-22868fcd1d7ab8ff.gif" alt=""></p>
<p>然后继续疯狂码代码…</p>
<hr>
<h2 id="开发过程中遇到的一些问题"><a href="#开发过程中遇到的一些问题" class="headerlink" title="开发过程中遇到的一些问题"></a>开发过程中遇到的一些问题</h2><h4 id="PropertyValue-遇到的麻烦"><a href="#PropertyValue-遇到的麻烦" class="headerlink" title="PropertyValue 遇到的麻烦"></a>PropertyValue 遇到的麻烦</h4><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-320fc236c47427d3.png" alt=""></p>
<p>PropertyValue 属性值表，这个表关联了两个外键，一个指向 Product ，另一个指向 Property ，当我按照之前的设计把 listProduct.jsp 设计成下面这个样子的时候，点击【编辑属性】，Property 的信息应该怎么传递？</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-663fe5770f82dc3d.png" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-c1937d1fb2ff0ad2.png" alt=""></p>
<ul>
<li>也就是说，如何处理从 listProduct 跳转到 listPropertyValue 页面时凭空跳出来的 Property 的相关信息？</li>
</ul>
<p><strong>解决方案：</strong></p>
<p>在 PropertyValueServiceImpl 中增加：</p>
<pre><code>@Autowired
PropertyService propertyService;</code></pre><p>我们现在有 category_id 和 product_id ，我们可以利用 Property 和 Category 之间的联系，通过 category_id 查询出所有对应的 Property ，然后再筛选出同时匹配 property_id 和 product_id 的 PropertyValue：</p>
<pre><code>public List&lt;PropertyValue&gt; list(Integer product_id, Integer category_id) {
    PropertyValueExample example = new PropertyValueExample();
    List&lt;PropertyValue&gt; propertyValues = new ArrayList&lt;PropertyValue&gt;();
    List&lt;Property&gt; properties = propertyService.list(category_id);
    for (Property property : properties) {
        // 筛选出同时匹配 property_id 和 product_id 的值
        example.or().andProperti_idEqualTo(property.getId()).andProduct_idEqualTo(product_id);
        propertyValues.addAll(propertyValueMapper.selectByExample(example));
    }
    return propertyValues;
}</code></pre><p>emmm…这样的思路出来之后，对应的 Controller 就清晰了：</p>
<pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/listPropertyValue"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> String <span class="token function">list</span><span class="token punctuation">(</span>Model model<span class="token punctuation">,</span> Integer product_id<span class="token punctuation">,</span> Integer category_id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    List<span class="token operator">&lt;</span>PropertyValue<span class="token operator">></span> propertyValues <span class="token operator">=</span> propertyValueService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>product_id<span class="token punctuation">,</span> category_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"propertyValues"</span><span class="token punctuation">,</span> propertyValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Product product <span class="token operator">=</span> productService<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>product_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"product"</span><span class="token punctuation">,</span> product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">"admin/listPropertyValue"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>加入一条数据测试：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-6e15372ceb60a814.png" alt=""></p>
<ul>
<li>bingo！</li>
</ul>
<p><strong>另一个问题是添加属性值：</strong> </p>
<p>添加的属性值必须是当前 Category 下有的属性值，所以我们可以在 Controller 上自动注入一个 PropertyService 通过 category_id 查询到当前分类下所有的 Property 然后传递给 listPropertyValue ：</p>
<pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Autowired</span>
PropertyService propertyService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/listPropertyValue"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> String <span class="token function">list</span><span class="token punctuation">(</span>Model model<span class="token punctuation">,</span> Integer product_id<span class="token punctuation">,</span> Integer category_id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    List<span class="token operator">&lt;</span>PropertyValue<span class="token operator">></span> propertyValues <span class="token operator">=</span> propertyValueService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>product_id<span class="token punctuation">,</span> category_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"propertyValues"</span><span class="token punctuation">,</span> propertyValues<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Product product <span class="token operator">=</span> productService<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>product_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"product"</span><span class="token punctuation">,</span> product<span class="token punctuation">)</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span>Property<span class="token operator">></span> properties <span class="token operator">=</span> propertyService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>category_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"properties"</span><span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">"admin/listPropertyValue"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<blockquote>
<p>期间发现一个 BUG，PropertyValue 表里的 property_id 居然写成了 properti_id，吓得我赶紧检查了一下所有表的字段，其他的没问题，重新生成一下逆向工程</p>
</blockquote>
<p><strong>然后获取属性名称：</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-913cf5641162aaa8.png" alt=""></p>
<ul>
<li>完善之后大概是这样：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-63c0a4d1c28f7633.png" alt=""></p>
<h4 id="产品图片管理"><a href="#产品图片管理" class="headerlink" title="产品图片管理"></a>产品图片管理</h4><p>产品图片的管理需要涉及到文件的上传操作，我们需要先提供必要的 jar 包依赖：</p>
<ul>
<li>commons-fileupload</li>
<li>commons-io</li>
</ul>
<p>同样的搜索 maven 库添加依赖到 pom.xml中：</p>
<pre><code>&lt;!-- 上传文件fileupload --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;commons-fileupload&lt;/groupId&gt;
    &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt;
    &lt;version&gt;1.3.3&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;commons-io&lt;/groupId&gt;
    &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
    &lt;version&gt;2.6&lt;/version&gt;
&lt;/dependency&gt;</code></pre><p><strong>产品图片如何管理？</strong></p>
<ul>
<li><strong>规定一：</strong><br>所有的产品图片均保存在【img/product/】对应的 product_id 目录下，并且默认的文件名为 1，2，3，4，5 ，例如 product_id 为 1 的产品的产品图片 1 保存于：【img/product/1/1.jpg】</li>
<li><strong>规定二：</strong><br>每一个产品对应五张图片，文件名分别为 1.jpg ，2.jpg 以此类推，不能少也不能多，删除也只是将对应目录下的图片删除，id 并不改变</li>
<li><strong>规定三：</strong><br>默认产品打开的大图即为该产品图片目录中的 1.jpg</li>
</ul>
<blockquote>
<ul>
<li>界面大概设计成了这样：</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-77a779e13d7b2d50.png" alt=""></p>
<blockquote>
<ul>
<li>莫名其妙一个 BUG：</li>
</ul>
</blockquote>
<p>我把表单设计成了这样，隐藏了两个属性，一个 product_id，一个 id：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-7ef327a861da75d4.png" alt=""></p>
<p>为了方便操作，我想要直接申明两个参数用来接收上面的两个属性，大概是这样：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-dc05f02505bc41ac.png" alt=""></p>
<p>但是上面两种方法都不行，我还查了一些资料在 @RequestParam 注解里设置了 required 属性，仍然获取不到，但是我改成用 ProductImage 来接收就好了..Why?</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-6bf39c8f3fe9ca82.png" alt=""></p>
<p>后来写着写着，又必须要使用上面两种方法了….</p>
<blockquote>
<ul>
<li>根据我们的规定来完成代码</li>
</ul>
</blockquote>
<p>ProductImageService 层还是跟之前的没有多大的区别，但是值得注意的是，根据我们的规定，我们的删除需要做一些改动（根据 product_id 批量删除）：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>wmyskxz<span class="token punctuation">.</span>service<span class="token punctuation">;</span>

<span class="token keyword">import</span> cn<span class="token punctuation">.</span>wmyskxz<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span>PropertyValueMapper<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>wmyskxz<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span>*<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span>Service<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ArrayList<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * cn.wmyskxz.pojo.PropertyValueValueService 实现类
 *
 * @author: @我没有三颗心脏
 * @create: 2018-04-28-上午 7:47
 */</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PropertyValueServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">PropertyValueService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    PropertyValueMapper propertyValueMapper<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    PropertyService propertyService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    ProductService productService<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>PropertyValue propertyValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        propertyValueMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>propertyValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        propertyValueMapper<span class="token punctuation">.</span><span class="token function">deleteByPrimaryKey</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteByProductId</span><span class="token punctuation">(</span>Integer product_id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 按条件查询出需要删除的列表</span>
        PropertyValueExample example <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyValueExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        example<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">andProduct_idEqualTo</span><span class="token punctuation">(</span>product_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Integer category_id <span class="token operator">=</span> productService<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>product_id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCategory_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        List<span class="token operator">&lt;</span>PropertyValue<span class="token operator">></span> propertyValues <span class="token operator">=</span> <span class="token function">list</span><span class="token punctuation">(</span>product_id<span class="token punctuation">,</span> category_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// 循环删除</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> propertyValues<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            propertyValueMapper<span class="token punctuation">.</span><span class="token function">deleteByPrimaryKey</span><span class="token punctuation">(</span>propertyValues<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span>PropertyValue propertyValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        propertyValueMapper<span class="token punctuation">.</span><span class="token function">updateByPrimaryKey</span><span class="token punctuation">(</span>propertyValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>PropertyValue<span class="token operator">></span> <span class="token function">list</span><span class="token punctuation">(</span>Integer product_id<span class="token punctuation">,</span> Integer category_id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        PropertyValueExample example <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyValueExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        List<span class="token operator">&lt;</span>PropertyValue<span class="token operator">></span> propertyValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>PropertyValue<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        List<span class="token operator">&lt;</span>Property<span class="token operator">></span> properties <span class="token operator">=</span> propertyService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>category_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>Property property <span class="token operator">:</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 筛选出同时匹配 property_id 和 product_id 的值</span>
            example<span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">andProperty_idEqualTo</span><span class="token punctuation">(</span>property<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">andProduct_idEqualTo</span><span class="token punctuation">(</span>product_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
            propertyValues<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>propertyValueMapper<span class="token punctuation">.</span><span class="token function">selectByExample</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> propertyValues<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> PropertyValue <span class="token function">get</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> propertyValueMapper<span class="token punctuation">.</span><span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<ul>
<li>首先在 ProductController 中 add 和 delete 方法中增加以下代码：</li>
</ul>
<pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Autowired</span>
ProductImageService productImageService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/addProduct"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> String <span class="token function">add</span><span class="token punctuation">(</span>Product product<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    productService<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 创建新的 Product 时默认创建 5 个对应的 ProductImage 数据</span>
    ProductImage productImage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProductImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    productImage<span class="token punctuation">.</span><span class="token function">setProduct_id</span><span class="token punctuation">(</span>product<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        productImage<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        productImageService<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>productImage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token string">"redirect:listProduct?category_id="</span> <span class="token operator">+</span> product<span class="token punctuation">.</span><span class="token function">getCategory_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/deleteProduct"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> String <span class="token function">delete</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">,</span> HttpServletRequest request<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">// 在删除产品的时候将对应的 5 个 ProductImage 数据也删除了</span>
    productImageService<span class="token punctuation">.</span><span class="token function">deleteByProductId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// 同时删除目录下的相关文件</span>
    String path <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span><span class="token string">""</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">deleteDir</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 删除外键对应的数据</span>
    propertyValueService<span class="token punctuation">.</span><span class="token function">deleteByProductId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> category_id <span class="token operator">=</span> productService<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCategory_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    productService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token string">"redirect:listProduct?category_id="</span> <span class="token operator">+</span> category_id<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/**
 * 递归删除目录下的所有文件及子目录下所有文件
 *
 * @param dir 将要删除的文件目录
 * @return boolean Returns "true" if all deletions were successful.
 * If a deletion fails, the method stops attempting to
 * delete and returns "false".
 */</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">deleteDir</span><span class="token punctuation">(</span>File dir<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>dir<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        String<span class="token punctuation">[</span><span class="token punctuation">]</span> children <span class="token operator">=</span> dir<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//递归删除目录中的子目录下</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">boolean</span> success <span class="token operator">=</span> <span class="token function">deleteDir</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">// 目录此时为空，可以删除</span>
    <span class="token keyword">return</span> dir<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>然后编写我们的 ProductImageController ：</p>
<pre><code>package cn.wmyskxz.controller;

import cn.wmyskxz.pojo.Product;
import cn.wmyskxz.pojo.ProductImage;
import cn.wmyskxz.service.ProductImageService;
import cn.wmyskxz.service.ProductService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.multipart.MultipartFile;

import javax.servlet.http.HttpServletRequest;
import java.io.File;
import java.util.List;

/**
 * ProductImage 的控制器
 *
 * @author: @我没有三颗心脏
 * @create: 2018-04-28-下午 14:10
 */
@Controller
@RequestMapping(&quot;/admin&quot;)
public class ProductImageController {

    @Autowired
    ProductImageService productImageService;

    @Autowired
    ProductService productService;

    @RequestMapping(&quot;/editProductImage&quot;)
    public String edit(Model model, Integer product_id) {
        List&lt;ProductImage&gt; productImages = productImageService.list(product_id);
        model.addAttribute(&quot;productImages&quot;, productImages);
        Product product = productService.get(product_id);
        model.addAttribute(&quot;product&quot;, product);
        return &quot;admin/editProductImage&quot;;
    }

    @RequestMapping(value = &quot;/updateProductImage&quot;, method = RequestMethod.POST)
    public String update(HttpServletRequest request,
//                         @RequestParam(&quot;productImage&quot;) ProductImage productImage,
                         Integer product_id, 
                         Integer id,
                         @RequestParam(&quot;picture&quot;) MultipartFile picture) {

        // 上传文件到指定位置
        String filePath = request.getSession().getServletContext()
                .getRealPath(&quot;img/product/&quot; + product_id);
        // 因为 id 是自增长键，所以需要 % 5 来作为文件名
        String fileName = (id % 5 == 0 ? 5 : id % 5) + &quot;.jpg&quot;;
        File uploadPicture = new File(filePath, fileName);
        if (!uploadPicture.exists()) {
            uploadPicture.mkdirs();
        }
        // 保存
        try {
            picture.transferTo(uploadPicture);
        } catch (Exception e) {
            e.printStackTrace();
        }
        return &quot;redirect:editProductImage?product_id=&quot; + product_id;
    }

    @RequestMapping(&quot;/deleteProductImage&quot;)
    public String delete(Integer id, Integer product_id, HttpServletRequest request) {
        // 不删除表中的数据（在 ProductController 中统一删除），删除对应文件
        String filePath = request.getSession().getServletContext()
                .getRealPath(&quot;img/product/&quot; + product_id);
        String fileName = id + &quot;.jpg&quot;;
        new File(filePath, fileName).delete();

        return &quot;redirect:editProductImage?product_id=&quot; + product_id;
    }
}
</code></pre><blockquote>
<ul>
<li>再优化一下界面的东西，增加没有图片显示的 error 图片，大概就是这个样子：</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-1503d0b3ed63d785.png" alt=""></p>
<p>这里就只贴一下 table 的代码吧：</p>
<pre><code>&lt;c:forEach items=&quot;${productImages}&quot; var=&quot;pi&quot;&gt;
    &lt;tr&gt;
        &lt;td&gt;${pi.product_id}&lt;/td&gt;
        &lt;td&gt;${pi.id}&lt;/td&gt;
        &lt;td&gt;&lt;img class=&quot;col-md-8&quot;
                 src=&quot;../img/product/${pi.product_id}/${pi.id%5==0?5:pi.id%5}.jpg&quot;
                 onerror=&quot;this.src=&#39;../img/product/error.png&#39;&quot;&gt;&lt;/td&gt;
        &lt;td class=&quot;col-md-5&quot;&gt;
            &lt;form action=&quot;updateProductImage&quot; method=&quot;post&quot;
                  enctype=&quot;multipart/form-data&quot;&gt;
                &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;${pi.id}&quot;&gt;
                &lt;input type=&quot;hidden&quot; name=&quot;product_id&quot;
                       value=&quot;${pi.product_id}&quot;&gt;
                &lt;input type=&quot;file&quot; name=&quot;picture&quot; class=&quot;pull-left&quot;&gt;
                &lt;input type=&quot;submit&quot; class=&quot;btn btn-primary pull-right&quot; value=&quot;上传&quot;&gt;
            &lt;/form&gt;
        &lt;/td&gt;
        &lt;td&gt;
            &lt;a href=&quot;deleteProductImage?product_id=${pi.product_id}&amp;id=${pi.id}&quot;&gt;&lt;span
                    class=&quot;glyphicon glyphicon-trash&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
&lt;/c:forEach&gt;</code></pre><h4 id="在写图片管理的时候又遇到一个坑"><a href="#在写图片管理的时候又遇到一个坑" class="headerlink" title="在写图片管理的时候又遇到一个坑"></a>在写图片管理的时候又遇到一个坑</h4><p><strong>在删除顶层数据库数据的时候，要注意删除其下的有外键关联的数据</strong>，特别是 product_id 这个东西，是很多表的外键，删除 product 之前需要先清空有关联的其他表的数据….</p>
<p>总之坑是很多啦..不过项目在进展总归是好事…耐心耐心…</p>
<h4 id="接着码代码…"><a href="#接着码代码…" class="headerlink" title="接着码代码…."></a>接着码代码….</h4><p>还剩下一些体力活的东西，就先结博文啦…（心累.jpg）</p>
<p>有一些催更的朋友，希望能别催啦…每天都在码啦，而且本身也是很low的东西，写完之后我会上传 github 的。</p>
<hr>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/7896890-dc0bd48aaa532767.jpg" alt=""></p>
<p>当我给自己埋了一个大坑说要模仿天猫，并且陷进去的时候，一方面痛苦着一方面也察觉了自己很多不足的地方，就觉得还是很值得，现在来做一下简短的总结。</p>
<ul>
<li>进度比想象中慢了很多，虽然一步一步按照之前的分析图来编写代码总体是顺畅的，但是有那种写着写着突然发现之前的设计有问题的感觉，中途也改了几次，<strong>发现自己分析问题不够全面。</strong></li>
<li>项目中有许多类似的代码，并且在 Controller 和 Impl 中不断有其他的东西加入，总觉得是糟糕的代码，但是又不知道应该进一步如何改进。</li>
<li><strong>方向永远比努力重要，在行动之前思考清楚，</strong>我一直觉得是很重要的一点，我觉得通过对项目的分析，对我项目的进展有一个整体的构思，各个模块该有什么功能都比较清晰，特别在编写 JSP 文件的时候能明显感觉不会很迷茫，这是比较好的一点</li>
<li><strong>发现自己阅读代码量很少，</strong>这种感觉体现在很多地方，一是写代码时感觉到自己思想的局限性，二是觉得自己写的代码有很多的相似性，虽然这个项目是自己突发奇想的想要去做的，但是有很多细节的地方，是自己没有去注意到的，比如类型要求、边界判断、事务处理等等等…</li>
</ul>
<blockquote>
<p>欢迎转载，转载请注明出处！<br>简书ID：<a href="https://www.jianshu.com/u/a40d61a49221" target="_blank" rel="noopener">@我没有三颗心脏</a><br>github：<a href="https://github.com/wmyskxz/" target="_blank" rel="noopener">wmyskxz</a><br>欢迎关注公众微信号：wmyskxz_javaweb<br>分享自己的Java Web学习之路以及各种Java学习资料</p>
</blockquote>

      
    </div>
    
      
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post white-box shadow reveal ">
  


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h2 class="title">
    <a href="/2018/04/27/mo-fang-tian-mao-shi-zhan-ssm-ban-xiang-mu-qi-bu/">
      模仿天猫实战【SSM版】——项目起步
    </a>
  </h2>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a class='author' href="" rel="nofollow">
    <img no-lazy src="">
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/JavaWeb%E5%9F%BA%E7%A1%80/SSM/%E9%A1%B9%E7%9B%AE/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>JavaWeb基础/SSM/项目</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2018年4月27日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  


            
          
            
              

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-3eee3c0023557f8e.png" alt=""></p>
<blockquote>
<p><strong>前言：</strong>现在自己的学习似乎遇到了瓶颈，感觉学习了 SSM 之后有一些迷茫，不知道接下来该往哪里去努力了，我觉得这是个很不好的状态，为了度过这段时期，我准备把天猫模仿下来（给自己找点事做）之后开始去巩固 Java 的基础知识，也准备好暑假去找实习。</p>
</blockquote>
<h2 id="第一步：需求分析"><a href="#第一步：需求分析" class="headerlink" title="第一步：需求分析"></a>第一步：需求分析</h2><p>首先要确定要实现哪些功能，需要对需求进行完整的分析，才能在编写项目的时候有条不紊，<strong>我们的目的很明确：就是模仿天猫前端 + 自己实现后端。</strong>并且尽最大努力去降低这个项目的复杂度（<em>毕竟高深的东西不懂</em>）。</p>
<h4 id="前端需求分析"><a href="#前端需求分析" class="headerlink" title="前端需求分析"></a>前端需求分析</h4><p><strong>规定：全天猫没有店铺，就只有唯一一家叫做 Tmall 的商家，卖所有的东西。</strong></p>
<blockquote>
<ul>
<li>1.数据的显示：</li>
</ul>
</blockquote>
<p><strong>首页数据显示分析：</strong></p>
<p>首先是搜索栏下方的九个商品，需要从数据库中取出销量最高的几个产品，关于标红的关键字，是要满足一定条件的，比如：这一个星期内销量超过多少…</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-ee6c3bed893d7229.png" alt=""></p>
<p>接着是分类导航栏，首先是商品分类右边固定的两个链接【天猫超市】和【天猫国际】，还有紧跟着的八个超链，这个可以设计为一个单表，存储它显示的文字和链接过去的地址，然后是具体的 16 个分类以及轮播：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-e85879cb8e4d5aa8.png" alt=""></p>
<p>下面的具体产品展示比较复杂，我们可以自己做一下简化，比如就展示几个产品比较多的固定的几个分类就好了，其他的就直接舍弃：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-84ef80bc6a962d35.png" alt=""></p>
<ul>
<li><strong>总结：</strong> 总之就是需要显示各种数据库中的数据</li>
</ul>
<blockquote>
<ul>
<li>2.登录/注册页</li>
</ul>
</blockquote>
<p>需要有一个登录/注册页，能够完成用户的登录和注册功能，并能提供基础的例如判断空值等功能。</p>
<blockquote>
<ul>
<li>3.产品搜索页</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-3740347e272b1ef0.png" alt=""></p>
<p>左上角的图标我们可以统一简化成 Tmall 的图片，商品图片，我们可以整个大分类使用一张图，主要就是实现排序功能还有搜索功能</p>
<blockquote>
<ul>
<li>4.产品展示页</li>
</ul>
</blockquote>
<p>天猫原生的产品展示页有些复杂，我们可以自己简化一下，就不要选这么多东西，都是一口价，</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-6e04b72b9365b941.png" alt=""></p>
<p>另外下方规格参数和评价都不能省略：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-67d2078a8f016c95.png" alt=""></p>
<blockquote>
<ul>
<li>5.购物车/购买页面</li>
</ul>
</blockquote>
<hr>
<h2 id="第二步：表结构设计"><a href="#第二步：表结构设计" class="headerlink" title="第二步：表结构设计"></a>第二步：表结构设计</h2><p>根据对于前端的分析，数据库有了一些眉目，为了简化项目的难度，所以我们需要自己想点办法，先来构思一下大概需要一些什么样的表：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-70e86e80be27582b.png" alt=""></p>
<p>我大概就想出来需要用到这些表，我们一个一个来创建它们：</p>
<h4 id="表一：分类表"><a href="#表一：分类表" class="headerlink" title="表一：分类表"></a>表一：分类表</h4><p>首先我们需要一个表来存储我们的分类信息，也就是【女装/内衣】、【男装/运动户外】在内的 16 个分类，为了高度一致，这 16 个分类不能多也不能少。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-5ac9b6db283570f1.png" alt=""></p>
<p>为了简化任务，可以观察出，【热门手机】、【特色手机】分栏下的东西都是【手机/数码/电脑办公】类别里的东西，所以我们直接砍掉，右边的一些图片超链也给直接砍掉，我们规定每一行显示的产品数目就可以了，这样就简单多了。</p>
<pre><code>CREATE TABLE category (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  name varchar(255) NOT NULL COMMENT &#39;分类的名字&#39;,
  PRIMARY KEY (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;</code></pre><h4 id="表二：商品分类右边的超链表"><a href="#表二：商品分类右边的超链表" class="headerlink" title="表二：商品分类右边的超链表"></a>表二：商品分类右边的超链表</h4><p>即在【天猫国际】右边的 8 个超链，我们单独新建一个表来存储超链显示的文字和链接的地址，这样就可以任意的修改其内容：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-4c4dd522d7725685.png" alt=""></p>
<p>百度翻译【推荐链接】翻译为【Referral links】，那我们也这么给我们的表命名好了：</p>
<pre><code>CREATE TABLE referal_link (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  text varchar(255) NOT NULL COMMENT &#39;超链显示的文字&#39;,
  link varchar(255) NOT NULL COMMENT &#39;超链的地址&#39;,
  PRIMARY KEY (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;</code></pre><h4 id="表三：产品表"><a href="#表三：产品表" class="headerlink" title="表三：产品表"></a>表三：产品表</h4><p>每个分类下都要一定的产品，这些产品还有自己的一些属性，所以另外需要属性表，这个表另外创建，我们先来观察一下一个产品表需要一些什么东西：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-1c882a1c5e908c2a.png" alt=""></p>
<ul>
<li>用于展示的 5 张<strong>图片</strong></li>
<li><strong>产品名称</strong></li>
<li><strong>小标题</strong>（即名称下面一排标红的小字）</li>
<li><strong>价格</strong>（就一口价，没别的）</li>
<li><strong>销量</strong>（别月销量了，能简化就简化一下）</li>
<li><strong>累计评价</strong>（还需要设计一个评价表）</li>
<li><strong>库存</strong></li>
<li><strong>属性</strong>（需要关联另外的属性表）</li>
</ul>
<pre><code>CREATE TABLE product (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  name varchar(255) NOT NULL COMMENT &#39;产品的名称&#39;,
  sub_title varchar(255) DEFAULT NULL COMMENT &#39;小标题&#39;,
  price float DEFAULT NULL COMMENT &#39;价格&#39;,
  sale int(11) DEFAULT NULL COMMENT &#39;销量&#39;,
  stock int(11) DEFAULT NULL COMMENT &#39;库存&#39;,
  category_id int(11) DEFAULT NULL COMMENT &#39;对应的分类id&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_product_category FOREIGN KEY (category_id) REFERENCES category (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;</code></pre><ul>
<li><strong>注意：</strong> 其中产品图片，累计评价，属性都作为单独的表存在并让当前表的 id 作为外键</li>
</ul>
<h4 id="表四：属性表"><a href="#表四：属性表" class="headerlink" title="表四：属性表"></a>表四：属性表</h4><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-755570d44559ce1a.png" alt=""></p>
<p>去掉详细的规格参数划分，其实属性也就是一个名字而已（简化简化简化）。</p>
<pre><code>CREATE TABLE property (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  name varchar(255) DEFAULT NULL COMMENT &#39;属性名称&#39;,
  product_id int(11) NOT NULL COMMENT &#39;对应的产品id&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_property_product FOREIGN KEY (product_id) REFERENCES product(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;</code></pre><blockquote>
<ul>
<li><strong>突然想到的问题：</strong><br>每一个产品的属性其实是很多的，如果每一个产品都对应很多属性的话，对于天猫这样的数据量来说，应该会让数据库爆炸的吧…</li>
<li><strong>改进方法：</strong><br>将属性表关联到 category 表上，因为其实每一个分类下的产品的属性差不多！</li>
</ul>
</blockquote>
<h4 id="修改数据库"><a href="#修改数据库" class="headerlink" title="修改数据库"></a>修改数据库</h4><p>根据以上问题，修改一下数据库表之间的关系</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-8dcfd056d47a8b0f.png" alt=""></p>
<p>并将属性表的外键修改为 category 的主键：</p>
<pre><code>CREATE TABLE property (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  name varchar(255) DEFAULT NULL COMMENT &#39;属性名称&#39;,
  category_id int(11) NOT NULL COMMENT &#39;对应的分类id&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_property_category FOREIGN KEY (category_id) REFERENCES category(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;</code></pre><h4 id="表五：属性值表"><a href="#表五：属性值表" class="headerlink" title="表五：属性值表"></a>表五：属性值表</h4><p>其中就是保存了对应属性的值，并且应该有两个外键，一个指向 Property 表，而另一个则指向 Product 表</p>
<pre><code>CREATE TABLE property_value (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  product_id int(11) NOT NULL COMMENT &#39;对应产品id&#39;,
  properti_id int(11) NOT NULL COMMENT &#39;对应属性id&#39;,
  value varchar(255) DEFAULT NULL COMMENT &#39;具体的属性值&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_property_value_property FOREIGN KEY (properti_id) REFERENCES property (id),
  CONSTRAINT fk_property_value_product FOREIGN KEY (product_id) REFERENCES product (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;</code></pre><h4 id="表六：产品图片表"><a href="#表六：产品图片表" class="headerlink" title="表六：产品图片表"></a>表六：产品图片表</h4><p>这个表名义上是保存了产品的图片，其实只是保存了产品图片的位置即图片名称，我们可以规定所有的产品图片都放在一个统一的文件夹下面，然后<strong>通过 id 来获取对应名称的图片</strong>：</p>
<pre><code>CREATE TABLE product_image (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  product_id int(11) DEFAULT NULL COMMENT &#39;对应的产品id&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_product_image_product FOREIGN KEY (product_id) REFERENCES product (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;</code></pre><ul>
<li><strong>注意：</strong> 我们通过把产品图片的文件命名为 id.jpg ，然后通过相对路径来获取到产品图片</li>
</ul>
<h4 id="表七：用户表"><a href="#表七：用户表" class="headerlink" title="表七：用户表"></a>表七：用户表</h4><p>用户表很简单，也没有权限之类的东西：</p>
<pre><code>CREATE TABLE user (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  name varchar(255) NOT NULL COMMENT &#39;用户名称&#39;,
  password varchar(255) NOT NULL COMMENT &#39;用户密码&#39;,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;</code></pre><ul>
<li>我们或许会在之后把密码弄成 “<strong>*****</strong>” 这种形式的，但是现在一切为了简单！</li>
</ul>
<h4 id="表八：评价表"><a href="#表八：评价表" class="headerlink" title="表八：评价表"></a>表八：评价表</h4><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-048235277c4287f2.png" alt=""></p>
<p>评价表对应了用户和产品两个表，也比较简单，我们为了简单，把上面红色的部分全部砍掉，因为没有商家，所以也不需要回复用户的评价，都砍掉砍掉！</p>
<pre><code>CREATE TABLE review (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  content varchar(4000) DEFAULT NULL COMMENT &#39;评价内容&#39;,
  user_id int(11) NOT NULL COMMENT &#39;对应的用户id&#39;,
  product_id int(11) NOT NULL COMMENT &#39;对应的产品id&#39;,
  createDate datetime DEFAULT NULL COMMENT &#39;评价时间&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_review_product FOREIGN KEY (product_id) REFERENCES product (id),
    CONSTRAINT fk_review_user FOREIGN KEY (user_id) REFERENCES user (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;</code></pre><h4 id="表九：订单表"><a href="#表九：订单表" class="headerlink" title="表九：订单表"></a>表九：订单表</h4><p>由于 Order 是 MySql 的一个关键字，所以我们在订单表的最后添加一个下划线：</p>
<pre><code>CREATE TABLE order_ (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  order_code varchar(255) NOT NULL COMMENT &#39;订单号&#39;,
  address varchar(255) NOT NULL COMMENT &#39;收货地址&#39;,
  post varchar(255) NOT NULL COMMENT &#39;邮编&#39;,
  receiver varchar(255) NOT NULL COMMENT &#39;收货人姓名&#39;,
  mobile varchar(255) NOT NULL COMMENT &#39;手机号码&#39;,
  user_message varchar(255) NOT NULL COMMENT &#39;用户备注的信息&#39;,
  create_date datetime NOT NULL COMMENT &#39;订单创建时间&#39;,
  pay_date datetime DEFAULT NULL COMMENT &#39;订单支付时间&#39;,
  delivery_date datetime DEFAULT NULL COMMENT &#39;发货日期&#39;,
  confirm_date datetime DEFAULT NULL COMMENT &#39;确认收货日期&#39;,
  user_id int(11) DEFAULT NULL COMMENT &#39;对应的用户id&#39;,
  status varchar(255) NOT NULL COMMENT &#39;订单状态&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_order_user FOREIGN KEY (user_id) REFERENCES user (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;</code></pre><h4 id="表十：订单项表"><a href="#表十：订单项表" class="headerlink" title="表十：订单项表"></a>表十：订单项表</h4><p>一个订单里面可能有多个订单项，一个产品也可能对应多个订单项，所以这个表应该有两个外键：</p>
<pre><code>CREATE TABLE order_item (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  product_id int(11) NOT NULL COMMENT &#39;对应产品id&#39;,
  order_id int(11) NOT NULL COMMENT &#39;对应订单id&#39;,
  number int(11) DEFAULT NULL COMMENT &#39;对应产品购买的数量&#39;,
  PRIMARY KEY (id) COMMENT &#39;邮编&#39;,
  CONSTRAINT fk_order_item_product FOREIGN KEY (product_id) REFERENCES product (id),
  CONSTRAINT fk_order_item_order FOREIGN KEY (order_id) REFERENCES order_ (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;</code></pre><h4 id="汇总："><a href="#汇总：" class="headerlink" title="汇总："></a>汇总：</h4><p>我们在创建表之前，应该创建一个新的数据库，并命名为【tmall_ssm】</p>
<pre><code>DROP DATABASE IF EXISTS tmall_ssm;
CREATE DATABASE tmall_ssm DEFAULT CHARACTER SET utf8;</code></pre><p>将这十个表汇个总就是：</p>
<pre><code>DROP DATABASE IF EXISTS tmall_ssm;
CREATE DATABASE tmall_ssm DEFAULT CHARACTER SET utf8;

use tmall_ssm;

CREATE TABLE category (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  name varchar(255) NOT NULL COMMENT &#39;分类的名字&#39;,
  PRIMARY KEY (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

CREATE TABLE referal_link (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  text varchar(255) NOT NULL COMMENT &#39;超链显示的文字&#39;,
  link varchar(255) NOT NULL COMMENT &#39;超链的地址&#39;,
  PRIMARY KEY (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

CREATE TABLE product (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  name varchar(255) NOT NULL COMMENT &#39;产品的名称&#39;,
  sub_title varchar(255) DEFAULT NULL COMMENT &#39;小标题&#39;,
  price float DEFAULT NULL COMMENT &#39;价格&#39;,
  sale int(11) DEFAULT NULL COMMENT &#39;销量&#39;,
  stock int(11) DEFAULT NULL COMMENT &#39;库存&#39;,
  category_id int(11) DEFAULT NULL COMMENT &#39;对应的分类id&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_product_category FOREIGN KEY (category_id) REFERENCES category (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

CREATE TABLE property (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  name varchar(255) DEFAULT NULL COMMENT &#39;属性名称&#39;,
  category_id int(11) NOT NULL COMMENT &#39;对应的分类id&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_property_category FOREIGN KEY (category_id) REFERENCES category(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE property_value (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  product_id int(11) NOT NULL COMMENT &#39;对应产品id&#39;,
  properti_id int(11) NOT NULL COMMENT &#39;对应属性id&#39;,
  value varchar(255) DEFAULT NULL COMMENT &#39;具体的属性值&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_property_value_property FOREIGN KEY (properti_id) REFERENCES property (id),
  CONSTRAINT fk_property_value_product FOREIGN KEY (product_id) REFERENCES product (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

CREATE TABLE product_image (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  product_id int(11) DEFAULT NULL COMMENT &#39;对应的产品id&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_product_image_product FOREIGN KEY (product_id) REFERENCES product (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE user (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  name varchar(255) NOT NULL COMMENT &#39;用户名称&#39;,
  password varchar(255) NOT NULL COMMENT &#39;用户密码&#39;,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE review (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  content varchar(4000) DEFAULT NULL COMMENT &#39;评价内容&#39;,
  user_id int(11) NOT NULL COMMENT &#39;对应的用户id&#39;,
  product_id int(11) NOT NULL COMMENT &#39;对应的产品id&#39;,
  createDate datetime DEFAULT NULL COMMENT &#39;评价时间&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_review_product FOREIGN KEY (product_id) REFERENCES product (id),
  CONSTRAINT fk_review_user FOREIGN KEY (user_id) REFERENCES user (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

CREATE TABLE order_ (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  order_code varchar(255) NOT NULL COMMENT &#39;订单号&#39;,
  address varchar(255) NOT NULL COMMENT &#39;收货地址&#39;,
  post varchar(255) NOT NULL COMMENT &#39;邮编&#39;,
  receiver varchar(255) NOT NULL COMMENT &#39;收货人姓名&#39;,
  mobile varchar(255) NOT NULL COMMENT &#39;手机号码&#39;,
  user_message varchar(255) NOT NULL COMMENT &#39;用户备注的信息&#39;,
  create_date datetime NOT NULL COMMENT &#39;订单创建时间&#39;,
  pay_date datetime DEFAULT NULL COMMENT &#39;订单支付时间&#39;,
  delivery_date datetime DEFAULT NULL COMMENT &#39;发货日期&#39;,
  confirm_date datetime DEFAULT NULL COMMENT &#39;确认收货日期&#39;,
  user_id int(11) DEFAULT NULL COMMENT &#39;对应的用户id&#39;,
  status varchar(255) NOT NULL COMMENT &#39;订单状态&#39;,
  PRIMARY KEY (id),
  CONSTRAINT fk_order_user FOREIGN KEY (user_id) REFERENCES user (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

CREATE TABLE order_item (
  id int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;唯一索引id&#39;,
  product_id int(11) NOT NULL COMMENT &#39;对应产品id&#39;,
  order_id int(11) NOT NULL COMMENT &#39;对应订单id&#39;,
  number int(11) DEFAULT NULL COMMENT &#39;对应产品购买的数量&#39;,
  PRIMARY KEY (id) COMMENT &#39;邮编&#39;,
  CONSTRAINT fk_order_item_product FOREIGN KEY (product_id) REFERENCES product (id),
  CONSTRAINT fk_order_item_order FOREIGN KEY (order_id) REFERENCES order_ (id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;</code></pre><p>直接复制进 MySql 中执行，就能看到我们创建好的十个数据库：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-559c02b039ba4d57.png" alt=""></p>
<hr>
<h2 id="第三步：创建-SSM-开发环境"><a href="#第三步：创建-SSM-开发环境" class="headerlink" title="第三步：创建 SSM 开发环境"></a>第三步：创建 SSM 开发环境</h2><p>根据之前我写过的博文：<a href="https://www.jianshu.com/p/3098050b0d14" target="_blank" rel="noopener">IDEA 整合 SSM</a> 搭建好 SSM 开发环境，这里给出完整的项目结构和 pom.xml 文件：</p>
<ul>
<li>完整的项目结构：</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-7371e706e33bf2f4.png" alt=""></p>
<ul>
<li>pom.xml 文件：</li>
</ul>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;

    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;

    &lt;name&gt;wmyskxz&lt;/name&gt;
    &lt;groupId&gt;cn.wmyskxz&lt;/groupId&gt;
    &lt;artifactId&gt;wmyskxz&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;maven-jetty-plugin&lt;/artifactId&gt;
                &lt;version&gt;6.1.7&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;connectors&gt;
                        &lt;connector implementation=&quot;org.mortbay.jetty.nio.SelectChannelConnector&quot;&gt;
                            &lt;port&gt;8888&lt;/port&gt;
                            &lt;maxIdleTime&gt;30000&lt;/maxIdleTime&gt;
                        &lt;/connector&gt;
                    &lt;/connectors&gt;
                    &lt;webAppSourceDirectory&gt;${project.build.directory}/${pom.artifactId}-${pom.version}
                    &lt;/webAppSourceDirectory&gt;
                    &lt;contextPath&gt;/&lt;/contextPath&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;properties&gt;
        &lt;!-- 设置项目编码编码 --&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;!-- spring版本号 --&gt;
        &lt;spring.version&gt;4.3.5.RELEASE&lt;/spring.version&gt;
        &lt;!-- mybatis版本号 --&gt;
        &lt;mybatis.version&gt;3.4.1&lt;/mybatis.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;

        &lt;!-- pageHelper --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;
            &lt;artifactId&gt;pagehelper&lt;/artifactId&gt;
            &lt;version&gt;5.1.2-beta&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!--jsqlparser--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.github.jsqlparser&lt;/groupId&gt;
            &lt;artifactId&gt;jsqlparser&lt;/artifactId&gt;
            &lt;version&gt;1.0&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- jstl标签 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
            &lt;artifactId&gt;jstl&lt;/artifactId&gt;
            &lt;version&gt;1.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.taglibs&lt;/groupId&gt;
            &lt;artifactId&gt;taglibs-standard-impl&lt;/artifactId&gt;
            &lt;version&gt;1.2.5&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- java ee --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax&lt;/groupId&gt;
            &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;
            &lt;version&gt;7.0&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- 单元测试 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- 实现slf4j接口并整合 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
            &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
            &lt;version&gt;1.2.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- JSON --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
            &lt;version&gt;2.8.7&lt;/version&gt;
        &lt;/dependency&gt;


        &lt;!-- 数据库 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;version&gt;5.1.41&lt;/version&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;

        &lt;!-- 数据库连接池 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.mchange&lt;/groupId&gt;
            &lt;artifactId&gt;c3p0&lt;/artifactId&gt;
            &lt;version&gt;0.9.5.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- MyBatis --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
            &lt;version&gt;${mybatis.version}&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- mybatis/spring整合包 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
            &lt;version&gt;1.3.1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- Spring --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;

&lt;/project&gt;</code></pre><hr>
<h2 id="MyBatis-逆向工程"><a href="#MyBatis-逆向工程" class="headerlink" title="MyBatis 逆向工程"></a>MyBatis 逆向工程</h2><p>按照正常的流程，我们应该去创建数据库对应的 POJO 和 DAO 类还有对应的 mapper 映射文件，按照上面的分析我们一共有十张表，想象一下为这十张表做这些无技术含量的机械化的繁杂的工作是多么头疼的一件事，我们希望的是：<strong>有人帮我自动创建好这些！</strong></p>
<ul>
<li><strong>MyBatis 官方提供了一种名为 “逆向工程” 的机制</strong>，其可以针对数据库中的单表自动生成 MyBatis 执行所需要的代码</li>
<li>包括：</li>
</ul>
<p><strong>Java 实体类、Mapper映射配置、Mapper代理接口</strong></p>
<h4 id="第一步：添加必要的-jar-包"><a href="#第一步：添加必要的-jar-包" class="headerlink" title="第一步：添加必要的 jar 包"></a>第一步：添加必要的 jar 包</h4><p>我们使用逆向工程，需要先导入 Mybatis Generator 的官方包，由于我们使用的是 Maven 搭建的 SSM 项目，所有我们可以去 Maven 的官网去查询需要的相关包：<a href="http://mvnrepository.com/" target="_blank" rel="noopener">http://mvnrepository.com/</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-048c0f3c81ce740d.png" alt=""></p>
<p>戳进去点击最新的包：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-8b63aa02666d95ed.png" alt=""></p>
<p>就可以在下方找到 Maven 依赖添加的语句：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-6242885479edbf79.png" alt=""></p>
<p>直接粘进 pom.xml 就可以了，这里就不演示了。</p>
<h4 id="第二步：generatorConfig-xml"><a href="#第二步：generatorConfig-xml" class="headerlink" title="第二步：generatorConfig.xml"></a>第二步：generatorConfig.xml</h4><p>在【resources】下创建 generatorConfig.xml 配置文件，该配置文件说明了一些逆向工程的细节：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE generatorConfiguration
        PUBLIC &quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;&gt;
&lt;generatorConfiguration&gt;

    &lt;context id=&quot;DB2Tables&quot; targetRuntime=&quot;MyBatis3&quot;&gt;

        &lt;!-- 是否去除自动生成的代码中的注释 true：是 false：否--&gt;
        &lt;commentGenerator&gt;
            &lt;property name=&quot;suppressDate&quot; value=&quot;true&quot;/&gt;
            &lt;property name=&quot;suppressAllComments&quot; value=&quot;true&quot;/&gt;
        &lt;/commentGenerator&gt;

        &lt;!-- 数据库连接信息：驱动类、连接地址、用户名、密码 --&gt;
        &lt;jdbcConnection driverClass=&quot;com.mysql.jdbc.Driver&quot; connectionURL=&quot;jdbc:mysql://localhost/tmall_ssm&quot;
                        userId=&quot;root&quot; password=&quot;root&quot;&gt;
        &lt;/jdbcConnection&gt;

        &lt;!-- 默认 false，把 JDBC DECIMAL 和 NUMERIC 类型解析为 Integer
             为 true 时解析为 java.math.BigDecimal --&gt;
        &lt;javaTypeResolver&gt;
            &lt;property name=&quot;forceBigDecimals&quot; value=&quot;false&quot;/&gt;
        &lt;/javaTypeResolver&gt;

        &lt;!-- targetProject：生成 POJO 类的位置 --&gt;
        &lt;javaModelGenerator targetPackage=&quot;cn.wmyskxz.pojo&quot; targetProject=&quot;src/main/java&quot;&gt;
            &lt;!-- enableSubPackages：是否让 schema 作为包的后缀--&gt;
            &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot;/&gt;
            &lt;!-- trimStrings：从数据库返回的值被清理前后的空格 --&gt;
            &lt;property name=&quot;trimStrings&quot; value=&quot;true&quot;/&gt;
        &lt;/javaModelGenerator&gt;

        &lt;!-- targetProject：生成xml映射文件存放位置 --&gt;
        &lt;sqlMapGenerator targetPackage=&quot;mapper&quot; targetProject=&quot;src/main/resources&quot;&gt;
            &lt;!-- enableSubPackages：是否让 schema 作为包的后缀--&gt;
            &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot;/&gt;
        &lt;/sqlMapGenerator&gt;

        &lt;!-- targetProject：生成mapper类存放位置 --&gt;
        &lt;javaClientGenerator type=&quot;XMLMAPPER&quot; targetPackage=&quot;cn.wmyskxz.mapper&quot; targetProject=&quot;src/main/java&quot;&gt;
            &lt;!-- enableSubPackages：是否让 schema 作为包的后缀--&gt;
            &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot;/&gt;
        &lt;/javaClientGenerator&gt;

        &lt;!--生成对应表及类名
            tableName:要生成的表名
            domainObjectName:生成后的实例名
            enableCountByExample:Count语句中加入where条件查询，默认为true开启
            enableUpdateByExample:Update语句中加入where条件查询，默认为true开启
            enableDeleteByExample:Delete语句中加入where条件查询，默认为true开启
            enableSelectByExample:Select多条语句中加入where条件查询，默认为true开启
            selectByExampleQueryId:Select单个对象语句中加入where条件查询，默认为true开启
        --&gt;
        &lt;table tableName=&quot;category&quot; domainObjectName=&quot;Category&quot; enableCountByExample=&quot;false&quot;
               enableUpdateByExample=&quot;false&quot; enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;true&quot;
               selectByExampleQueryId=&quot;false&quot;&gt;
            &lt;!-- 使用数据库中实际的字段名作为生成的实体类的属性 --&gt;
            &lt;property name=&quot;useActualColumnNames&quot; value=&quot;true&quot;/&gt;
            &lt;!-- 使用自增长键 --&gt;
            &lt;property name=&quot;my.isgen.usekeys&quot; value=&quot;true&quot;/&gt;
            &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;JDBC&quot;/&gt;
        &lt;/table&gt;

        &lt;table tableName=&quot;property&quot; domainObjectName=&quot;Property&quot; enableCountByExample=&quot;false&quot;
               enableUpdateByExample=&quot;false&quot; enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;true&quot;
               selectByExampleQueryId=&quot;false&quot;&gt;
            &lt;property name=&quot;useActualColumnNames&quot; value=&quot;true&quot;/&gt;
            &lt;property name=&quot;my.isgen.usekeys&quot; value=&quot;true&quot;/&gt;
            &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;JDBC&quot;/&gt;
        &lt;/table&gt;

        &lt;table tableName=&quot;product&quot; domainObjectName=&quot;Product&quot; enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;
               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;true&quot; selectByExampleQueryId=&quot;false&quot;&gt;
            &lt;property name=&quot;my.isgen.usekeys&quot; value=&quot;true&quot;/&gt;
            &lt;property name=&quot;useActualColumnNames&quot; value=&quot;true&quot;/&gt;
            &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;JDBC&quot;/&gt;
        &lt;/table&gt;

        &lt;table tableName=&quot;product_image&quot; domainObjectName=&quot;ProductImage&quot; enableCountByExample=&quot;false&quot;
               enableUpdateByExample=&quot;false&quot; enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;true&quot;
               selectByExampleQueryId=&quot;false&quot;&gt;
            &lt;property name=&quot;my.isgen.usekeys&quot; value=&quot;true&quot;/&gt;
            &lt;property name=&quot;useActualColumnNames&quot; value=&quot;true&quot;/&gt;
            &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;JDBC&quot;/&gt;
        &lt;/table&gt;

        &lt;table tableName=&quot;order_&quot; domainObjectName=&quot;Order&quot; enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;
               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;true&quot; selectByExampleQueryId=&quot;false&quot;&gt;
            &lt;property name=&quot;my.isgen.usekeys&quot; value=&quot;true&quot;/&gt;
            &lt;property name=&quot;useActualColumnNames&quot; value=&quot;true&quot;/&gt;
            &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;JDBC&quot;/&gt;
        &lt;/table&gt;

        &lt;table tableName=&quot;property_value&quot; domainObjectName=&quot;PropertyValue&quot; enableCountByExample=&quot;false&quot;
               enableUpdateByExample=&quot;false&quot; enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;true&quot;
               selectByExampleQueryId=&quot;false&quot;&gt;
            &lt;property name=&quot;my.isgen.usekeys&quot; value=&quot;true&quot;/&gt;
            &lt;property name=&quot;useActualColumnNames&quot; value=&quot;true&quot;/&gt;
            &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;JDBC&quot;/&gt;
        &lt;/table&gt;

        &lt;table tableName=&quot;review&quot; domainObjectName=&quot;Review&quot; enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;
               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;true&quot; selectByExampleQueryId=&quot;false&quot;&gt;
            &lt;property name=&quot;my.isgen.usekeys&quot; value=&quot;true&quot;/&gt;
            &lt;property name=&quot;useActualColumnNames&quot; value=&quot;true&quot;/&gt;
            &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;JDBC&quot;/&gt;
        &lt;/table&gt;

        &lt;table tableName=&quot;user&quot; domainObjectName=&quot;User&quot; enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;
               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;true&quot; selectByExampleQueryId=&quot;false&quot;&gt;
            &lt;property name=&quot;my.isgen.usekeys&quot; value=&quot;true&quot;/&gt;
            &lt;property name=&quot;useActualColumnNames&quot; value=&quot;true&quot;/&gt;
            &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;JDBC&quot;/&gt;
        &lt;/table&gt;

        &lt;table tableName=&quot;order_item&quot; domainObjectName=&quot;OrderItem&quot; enableCountByExample=&quot;false&quot;
               enableUpdateByExample=&quot;false&quot; enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;true&quot;
               selectByExampleQueryId=&quot;false&quot;&gt;
            &lt;property name=&quot;my.isgen.usekeys&quot; value=&quot;true&quot;/&gt;
            &lt;property name=&quot;useActualColumnNames&quot; value=&quot;true&quot;/&gt;
            &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;JDBC&quot;/&gt;
        &lt;/table&gt;

        &lt;table tableName=&quot;referal_link&quot; domainObjectName=&quot;ReferalLink&quot; enableCountByExample=&quot;false&quot;
               enableUpdateByExample=&quot;false&quot; enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;true&quot;
               selectByExampleQueryId=&quot;false&quot;&gt;
            &lt;property name=&quot;my.isgen.usekeys&quot; value=&quot;true&quot;/&gt;
            &lt;property name=&quot;useActualColumnNames&quot; value=&quot;true&quot;/&gt;
            &lt;generatedKey column=&quot;id&quot; sqlStatement=&quot;JDBC&quot;/&gt;
        &lt;/table&gt;
    &lt;/context&gt;
&lt;/generatorConfiguration&gt;</code></pre><p>这样配置文件也就编写好了</p>
<h4 id="第三步：逆向数据文件生成类"><a href="#第三步：逆向数据文件生成类" class="headerlink" title="第三步：逆向数据文件生成类"></a>第三步：逆向数据文件生成类</h4><p>在编写完配置文件只有，就需要加载该配置文件，利用逆向工程的机制来对数据库的各个表进行一系列文件的生成，我们在【test/java】包下创建【TestMyBatisGenerator】类：</p>
<pre><code>import org.mybatis.generator.api.MyBatisGenerator;
import org.mybatis.generator.api.ShellCallback;
import org.mybatis.generator.config.Configuration;
import org.mybatis.generator.config.xml.ConfigurationParser;
import org.mybatis.generator.internal.DefaultShellCallback;

import java.io.File;
import java.util.ArrayList;
import java.util.List;

/**
 * 逆向工程测试类
 *
 * @author: @我没有三颗心脏
 * @create: 2018-04-27-上午 8:26
 */
public class TestMybatisGenerator {

    public static void main(String[] args) throws Exception {
        // warnings 为用于放置生成过程中警告信息的集合对象
        List&lt;String&gt; warnings = new ArrayList&lt;String&gt;();
        // 指定是否覆盖重名文件
        boolean overwrite = true;
        // 加载配置文件
        File configFile = new File(MyBatisGenerator.class.getClassLoader().getResource(&quot;generatorConfig.xml&quot;).toURI());
        // 配置解析类
        ConfigurationParser cp = new ConfigurationParser(warnings);
        // 配置解析类解析配置文件并生成 Configuration 配置对象
        Configuration config = cp.parseConfiguration(configFile);
        // ShellCallback 负责如何处理重复文件
        ShellCallback callback = new DefaultShellCallback(overwrite);
        // 逆向工程对象
        MyBatisGenerator myBatisGenerator = new MyBatisGenerator(config, callback, warnings);
        // 执行逆向文件生成操作
        myBatisGenerator.generate(null);
        // 打印提示信息
        System.out.println(&quot;MyBatis 逆向工程执行成功，刷新项目查看文件！&quot;);
    }
}</code></pre><p>执行该测试类，就能看见自动生成的文件：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-207d1abeb35a84c0.png" alt=""></p>
<ul>
<li>Oh！这真的是太爽了！突然开心(*^▽^*)</li>
</ul>
<h4 id="看一下自动生成的文件"><a href="#看一下自动生成的文件" class="headerlink" title="看一下自动生成的文件"></a>看一下自动生成的文件</h4><p>以 Category 为例，我们来看一下自动生成的文件：</p>
<blockquote>
<ul>
<li>Category 实体类：</li>
</ul>
</blockquote>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>wmyskxz<span class="token punctuation">.</span>pojo<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> Integer id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> Integer <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token operator">==</span> null <span class="token operator">?</span> null <span class="token operator">:</span> name<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<blockquote>
<ul>
<li>CategoryMapper 映射类：</li>
</ul>
</blockquote>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>wmyskxz<span class="token punctuation">.</span>mapper<span class="token punctuation">;</span>

<span class="token keyword">import</span> cn<span class="token punctuation">.</span>wmyskxz<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span>Category<span class="token punctuation">;</span>
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>wmyskxz<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span>CategoryExample<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CategoryMapper</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token function">deleteByPrimaryKey</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">insert</span><span class="token punctuation">(</span>Category record<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">insertSelective</span><span class="token punctuation">(</span>Category record<span class="token punctuation">)</span><span class="token punctuation">;</span>

    List<span class="token operator">&lt;</span>Category<span class="token operator">></span> <span class="token function">selectByExample</span><span class="token punctuation">(</span>CategoryExample example<span class="token punctuation">)</span><span class="token punctuation">;</span>

    Category <span class="token function">selectByPrimaryKey</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">updateByPrimaryKeySelective</span><span class="token punctuation">(</span>Category record<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> <span class="token function">updateByPrimaryKey</span><span class="token punctuation">(</span>Category record<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<blockquote>
<ul>
<li>CategoryMapper.xml 映射文件：</li>
</ul>
</blockquote>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;mapper namespace=&quot;cn.wmyskxz.mapper.CategoryMapper&quot;&gt;
    &lt;resultMap id=&quot;BaseResultMap&quot; type=&quot;cn.wmyskxz.pojo.Category&quot;&gt;
        &lt;id column=&quot;id&quot; jdbcType=&quot;INTEGER&quot; property=&quot;id&quot;/&gt;
        &lt;result column=&quot;name&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;name&quot;/&gt;
    &lt;/resultMap&gt;
    &lt;sql id=&quot;Example_Where_Clause&quot;&gt;
        &lt;where&gt;
            &lt;foreach collection=&quot;oredCriteria&quot; item=&quot;criteria&quot; separator=&quot;or&quot;&gt;
                &lt;if test=&quot;criteria.valid&quot;&gt;
                    &lt;trim prefix=&quot;(&quot; prefixOverrides=&quot;and&quot; suffix=&quot;)&quot;&gt;
                        &lt;foreach collection=&quot;criteria.criteria&quot; item=&quot;criterion&quot;&gt;
                            &lt;choose&gt;
                                &lt;when test=&quot;criterion.noValue&quot;&gt;
                                    and ${criterion.condition}
                                &lt;/when&gt;
                                &lt;when test=&quot;criterion.singleValue&quot;&gt;
                                    and ${criterion.condition} #{criterion.value}
                                &lt;/when&gt;
                                &lt;when test=&quot;criterion.betweenValue&quot;&gt;
                                    and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                                &lt;/when&gt;
                                &lt;when test=&quot;criterion.listValue&quot;&gt;
                                    and ${criterion.condition}
                                    &lt;foreach close=&quot;)&quot; collection=&quot;criterion.value&quot; item=&quot;listItem&quot; open=&quot;(&quot;
                                             separator=&quot;,&quot;&gt;
                                        #{listItem}
                                    &lt;/foreach&gt;
                                &lt;/when&gt;
                            &lt;/choose&gt;
                        &lt;/foreach&gt;
                    &lt;/trim&gt;
                &lt;/if&gt;
            &lt;/foreach&gt;
        &lt;/where&gt;
    &lt;/sql&gt;
    &lt;sql id=&quot;Base_Column_List&quot;&gt;
    id, name
  &lt;/sql&gt;
    &lt;select id=&quot;selectByExample&quot; parameterType=&quot;cn.wmyskxz.pojo.CategoryExample&quot; resultMap=&quot;BaseResultMap&quot;&gt;
        select
        &lt;if test=&quot;distinct&quot;&gt;
            distinct
        &lt;/if&gt;
        &#39;false&#39; as QUERYID,
        &lt;include refid=&quot;Base_Column_List&quot;/&gt;
        from category
        &lt;if test=&quot;_parameter != null&quot;&gt;
            &lt;include refid=&quot;Example_Where_Clause&quot;/&gt;
        &lt;/if&gt;
        &lt;if test=&quot;orderByClause != null&quot;&gt;
            order by ${orderByClause}
        &lt;/if&gt;
    &lt;/select&gt;
    &lt;select id=&quot;selectByPrimaryKey&quot; parameterType=&quot;java.lang.Integer&quot; resultMap=&quot;BaseResultMap&quot;&gt;
        select
        &lt;include refid=&quot;Base_Column_List&quot;/&gt;
        from category
        where id = #{id,jdbcType=INTEGER}
    &lt;/select&gt;
    &lt;delete id=&quot;deleteByPrimaryKey&quot; parameterType=&quot;java.lang.Integer&quot;&gt;
    delete from category
    where id = #{id,jdbcType=INTEGER}
  &lt;/delete&gt;
    &lt;insert id=&quot;insert&quot; keyColumn=&quot;id&quot; keyProperty=&quot;id&quot; parameterType=&quot;cn.wmyskxz.pojo.Category&quot;
            useGeneratedKeys=&quot;true&quot;&gt;
    insert into category (name)
    values (#{name,jdbcType=VARCHAR})
  &lt;/insert&gt;
    &lt;insert id=&quot;insertSelective&quot; keyColumn=&quot;id&quot; keyProperty=&quot;id&quot; parameterType=&quot;cn.wmyskxz.pojo.Category&quot;
            useGeneratedKeys=&quot;true&quot;&gt;
        insert into category
        &lt;trim prefix=&quot;(&quot; suffix=&quot;)&quot; suffixOverrides=&quot;,&quot;&gt;
            &lt;if test=&quot;name != null&quot;&gt;
                name,
            &lt;/if&gt;
        &lt;/trim&gt;
        &lt;trim prefix=&quot;values (&quot; suffix=&quot;)&quot; suffixOverrides=&quot;,&quot;&gt;
            &lt;if test=&quot;name != null&quot;&gt;
                #{name,jdbcType=VARCHAR},
            &lt;/if&gt;
        &lt;/trim&gt;
    &lt;/insert&gt;
    &lt;update id=&quot;updateByPrimaryKeySelective&quot; parameterType=&quot;cn.wmyskxz.pojo.Category&quot;&gt;
        update category
        &lt;set&gt;
            &lt;if test=&quot;name != null&quot;&gt;
                name = #{name,jdbcType=VARCHAR},
            &lt;/if&gt;
        &lt;/set&gt;
        where id = #{id,jdbcType=INTEGER}
    &lt;/update&gt;
    &lt;update id=&quot;updateByPrimaryKey&quot; parameterType=&quot;cn.wmyskxz.pojo.Category&quot;&gt;
    update category
    set name = #{name,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  &lt;/update&gt;
&lt;/mapper&gt;</code></pre><p>其中就只有映射文件稍微有些复杂，但细看下来其实跟我们自己写的差不多，甚至自动生成的完成得更好。</p>
<blockquote>
<p>xxxExample</p>
</blockquote>
<p>MybatisGenerator会生成一个类叫做XXXXExample的。，它的作用是进行排序，条件查询的时候使用。</p>
<p>这里有详细的说明，了解一下就好了：<a href="https://blog.csdn.net/biandous/article/details/65630783" target="_blank" rel="noopener">戳这里</a></p>
<h4 id="第四步：测试"><a href="#第四步：测试" class="headerlink" title="第四步：测试"></a>第四步：测试</h4><p>我们这里仅仅就用 CategoryMapper 映射类来进行简单测试了：</p>
<pre><code>@Autowired
CategoryMapper categoryMapper;

@Test
public void test() {
    Category category = new Category();
    category.setName(&quot;分类1&quot;);
    categoryMapper.insert(category);
}</code></pre><p>由于我们使用了自增长键 id ，所以仅仅只需要提供 name 属性就可以了，执行，可以看到数据库中有正确的数据：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E6%A8%A1%E4%BB%BF%E5%A4%A9%E7%8C%AB%E5%AE%9E%E6%88%98%E3%80%90SSM%E7%89%88%E3%80%91%E2%80%94%E2%80%94%E9%A1%B9%E7%9B%AE%E8%B5%B7%E6%AD%A5/7896890-b1e9cbc59225eb31.png" alt=""></p>
<hr>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>根据以上的 “折腾” 算是完成了项目的起步工作了吧，我是一边写项目一边写博客的，所以可能有时候想着想着写着写着思绪会有点飘，写得凌乱，这也是没有办法的事，不管写得好还是差我都希望能记录下来，这些都是属于我自己的思路和学习路程。</p>
<blockquote>
<p>欢迎转载，转载请注明出处！<br>简书ID：<a href="https://www.jianshu.com/u/a40d61a49221" target="_blank" rel="noopener">@我没有三颗心脏</a><br>github：<a href="https://github.com/wmyskxz/" target="_blank" rel="noopener">wmyskxz</a><br>欢迎关注公众微信号：wmyskxz_javaweb<br>分享自己的Java Web学习之路以及各种Java学习资料</p>
</blockquote>

      
    </div>
    
      
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post white-box shadow reveal ">
  


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h2 class="title">
    <a href="/2018/04/24/xue-sheng-guan-li-xi-tong-ssm-jian-yi-ban-zong-jie/">
      学生管理系统（SSM简易版）总结
    </a>
  </h2>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a class='author' href="" rel="nofollow">
    <img no-lazy src="">
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/JavaWeb%E5%9F%BA%E7%A1%80/SSM/%E9%A1%B9%E7%9B%AE/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>JavaWeb基础/SSM/项目</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2018年4月24日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  


            
          
            
              

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>之前用 Servlet + JSP 实现了一个<a href="https://www.jianshu.com/p/553fc76bb8eb" target="_blank" rel="noopener">简易版的学生管理系统</a>，在学习了 SSM 框架之后，我们来对之前写过的项目重构一下！</p>
</blockquote>
<h2 id="技术准备"><a href="#技术准备" class="headerlink" title="技术准备"></a>技术准备</h2><p>为了完成这个项目，需要掌握如下技术：</p>
<ul>
<li>Java<br>基础知识</li>
<li>前端：<br>HTML, CSS, JAVASCRIPT, JQUERY</li>
<li>J2EE：<br>Tomcat, Servlet, JSP, Filter</li>
<li>框架：<br><a href="https://www.jianshu.com/p/1af66a499f49" target="_blank" rel="noopener">Spring</a>, <a href="https://www.jianshu.com/p/91a2d0a1e45a" target="_blank" rel="noopener">Spring MVC</a>, <a href="https://www.jianshu.com/p/c77e3691867d" target="_blank" rel="noopener">MyBatis</a>, <a href="https://www.jianshu.com/p/412051d41d73" target="_blank" rel="noopener">Spring 与 MyBatis 整合</a>, <a href="https://www.jianshu.com/p/3098050b0d14" target="_blank" rel="noopener">SSM 整合</a></li>
<li>数据库：<br>MySQL</li>
<li>开发工具：<br>IDEA, Maven</li>
</ul>
<h2 id="开发流程"><a href="#开发流程" class="headerlink" title="开发流程"></a>开发流程</h2><p>之前虽然已经使用 <strong>Servlet + JSP</strong> 完成了简单的开发，这次使用 <strong>SSM</strong> 仅仅是重构工作，但我们仍然按照商业项目的开发步骤来一步一步完成，进一步熟悉这个过程，<strong>重复的部分我就直接复制了。</strong></p>
<h4 id="①-需求分析"><a href="#①-需求分析" class="headerlink" title="① 需求分析"></a>① 需求分析</h4><p>首先要确定要做哪些功能</p>
<ul>
<li>使用<strong>数据库</strong>来<strong>保存数据</strong></li>
<li>能<strong>增删改查</strong>学生的信息<em>（学号，名称，年龄，性别，出生日期）</em></li>
</ul>
<h4 id="②-表结构设计"><a href="#②-表结构设计" class="headerlink" title="② 表结构设计"></a>② 表结构设计</h4><p>根据需求，那么只需要一个 student 表就能够完成功能了。</p>
<ul>
<li><p><strong>创建数据库：student</strong><br>将数据库编码格式设置为 UTF-8 ，便于存取中文数据</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> student<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> student <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARACTER SET</span> utf8<span class="token punctuation">;</span></code></pre>
</li>
<li><p><strong>创建学生表：student</strong><br>不用<strong>学生学号(studentID)</strong>作为主键的原因是：不方便操作，例如在更新数据的时候，同时也要更改学号，那这样的操作怎么办呢？<br>所以我们加了一个 <strong>id</strong> 用来唯一表示当前数据。</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student<span class="token punctuation">(</span>
id <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
student_id <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span>
name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
age <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
sex <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
birthday <span class="token keyword">date</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span></code></pre>
</li>
</ul>
<blockquote>
<p>MySQL 在 Windows 下不区分大小写，但在 Linux 下默认区分大小写，因此，<strong>数据库名、表明、字段名都不允许出现任何大写字母</strong>，避免节外生枝。</p>
</blockquote>
<h4 id="③-原型设计"><a href="#③-原型设计" class="headerlink" title="③ 原型设计"></a>③ 原型设计</h4><p>就是设计界面，在商业项目中，这是很重要的一步，我们可以<strong>解除界面原型，低成本、高效率</strong>的与客户达成<strong>需求的一致性</strong>。</p>
<p>这个项目一共就分为两个页面：</p>
<ul>
<li><p>主页面：<br><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-0169962ea353fcbd.png" alt="首页"></p>
</li>
<li><p>学生编辑页面：<br><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-2eac73f04dcf3ea4.png" alt="编辑页面"></p>
</li>
</ul>
<h4 id="④-SSM-环境搭建"><a href="#④-SSM-环境搭建" class="headerlink" title="④ SSM 环境搭建"></a>④ SSM 环境搭建</h4><p>在真正开始编写代码之前，我们首先需要先来搭建好我们的 SSM 环境。</p>
<h4 id="第一步：创建-Maven-webapp-项目"><a href="#第一步：创建-Maven-webapp-项目" class="headerlink" title="第一步：创建 Maven webapp 项目"></a>第一步：创建 Maven webapp 项目</h4><p>首先新建工程，选择 Maven 标签，然后勾选上【Create from archetype】选择 webapp：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-37bca8243a63a411.png" alt=""></p>
<p>点击下一步，填写上【GroupId】和【ArtifactId】：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-87095d22145798ac.png" alt=""></p>
<ul>
<li>GroupId：项目组织唯一的标识符，实际对应 JAVA 的包的结构，也就是 main 目录下 java 的目录结构（包）</li>
<li>AritifactId：项目的唯一标识符，实际对应项目的名称，就是项目根目录的名称</li>
<li>实际上你可以乱填上试试，我就不乱填了</li>
</ul>
<p>然后是确认项目路径，这一步你可以看到 Maven 配置中的参数，不需要做改动，直接下一步就可以（<em>图中的路径是我配置的本地 Maven 仓库的地址</em>）：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-5ff7e5ec2ad03ebc.png" alt=""></p>
<p>确认项目名称和路径，点击【Finish】即可：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-491970db6a349a5e.png" alt=""></p>
<p>等待一会儿，控制台就会有创建成功的提示信息，我们把【Enable Auto-Import】点上，这个提示会在每次 pom.xml 有改动时出现，自动导入，省掉麻烦：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-2ebc5e0cd0503ad7.png" alt=""></p>
<h4 id="第二步：搭建项目目录结构"><a href="#第二步：搭建项目目录结构" class="headerlink" title="第二步：搭建项目目录结构"></a>第二步：搭建项目目录结构</h4><p>下面就是 Maven 风格的 webapp 的默认目录结构：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-4ac356da8a41ee5b.png" alt=""></p>
<ul>
<li><strong>注意：</strong> webapp 是默认没有 java 源文件也没有 test 目录的。</li>
</ul>
<p>遵循 Maven 的统一项目结构，我们搭建出项目的完整目录结构如下图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-51e8952802f0ec9c.png" alt=""></p>
<ul>
<li>我们并没有使用 Log4j 来输出日志，而是使用 logback </li>
<li><strong>提示：</strong>我们可以在 IDEA 中右键目录然后选择【Make Directory as】，让 IDEA 识别不同的目录作用</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-6ca8b5c413335048.png" alt=""></p>
<p>这里的目录建好之后还需要设置一下，让 IDEA 识别目录作用，选择【File】&gt;【Project Structure】：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-640537dba7ff226e.png" alt=""></p>
<p>设置好之后点击 OK，即完成了项目目录的搭建。</p>
<h4 id="第三步：配置文件内容"><a href="#第三步：配置文件内容" class="headerlink" title="第三步：配置文件内容"></a>第三步：配置文件内容</h4><p>在【pom.xml】文件中声明依赖的 jar 包 ：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;

    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;

    &lt;name&gt;StudentManagerSSM&lt;/name&gt;
    &lt;groupId&gt;cn.wmyskxz&lt;/groupId&gt;
    &lt;artifactId&gt;StudentManagerSSM&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;
                &lt;artifactId&gt;maven-jetty-plugin&lt;/artifactId&gt;
                &lt;version&gt;6.1.7&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;connectors&gt;
                        &lt;connector implementation=&quot;org.mortbay.jetty.nio.SelectChannelConnector&quot;&gt;
                            &lt;port&gt;8888&lt;/port&gt;
                            &lt;maxIdleTime&gt;30000&lt;/maxIdleTime&gt;
                        &lt;/connector&gt;
                    &lt;/connectors&gt;
                    &lt;webAppSourceDirectory&gt;${project.build.directory}/${pom.artifactId}-${pom.version}
                    &lt;/webAppSourceDirectory&gt;
                    &lt;contextPath&gt;/&lt;/contextPath&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;properties&gt;
        &lt;!-- 设置项目编码编码 --&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;!-- spring版本号 --&gt;
        &lt;spring.version&gt;4.3.5.RELEASE&lt;/spring.version&gt;
        &lt;!-- mybatis版本号 --&gt;
        &lt;mybatis.version&gt;3.4.1&lt;/mybatis.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;

        &lt;!-- jstl标签 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
            &lt;artifactId&gt;jstl&lt;/artifactId&gt;
            &lt;version&gt;1.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.taglibs&lt;/groupId&gt;
            &lt;artifactId&gt;taglibs-standard-impl&lt;/artifactId&gt;
            &lt;version&gt;1.2.5&lt;/version&gt;
        &lt;/dependency&gt;


        &lt;!-- java ee --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax&lt;/groupId&gt;
            &lt;artifactId&gt;javaee-api&lt;/artifactId&gt;
            &lt;version&gt;7.0&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- 单元测试 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- 实现slf4j接口并整合 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
            &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
            &lt;version&gt;1.2.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- JSON --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
            &lt;version&gt;2.8.7&lt;/version&gt;
        &lt;/dependency&gt;


        &lt;!-- 数据库 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;version&gt;5.1.41&lt;/version&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;

        &lt;!-- 数据库连接池 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.mchange&lt;/groupId&gt;
            &lt;artifactId&gt;c3p0&lt;/artifactId&gt;
            &lt;version&gt;0.9.5.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- MyBatis --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
            &lt;version&gt;${mybatis.version}&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- mybatis/spring整合包 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;
            &lt;version&gt;1.3.1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- Spring --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-web&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework&lt;/groupId&gt;
            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
            &lt;version&gt;${spring.version}&lt;/version&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;

&lt;/project&gt;</code></pre><ul>
<li><code>&lt;build&gt;</code> 标签是默认生成的</li>
<li>我们在 <code>&lt;properties&gt;</code> 中声明了编码格式以及使用的 spring 和 mybatis 的版本号，然后在 <code>&lt;dependencies&gt;</code> 中声明了具体的 jar 包 </li>
</ul>
<p>在【web.xml】中声明编码过滤器并配置 DispatcherServlet ：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;
         version=&quot;3.1&quot;&gt;

    &lt;!-- 编码过滤器 --&gt;
    &lt;filter&gt;
        &lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;
        &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;encoding&lt;/param-name&gt;
            &lt;param-value&gt;UTF-8&lt;/param-value&gt;
        &lt;/init-param&gt;
    &lt;/filter&gt;
    &lt;filter-mapping&gt;
        &lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/filter-mapping&gt;

    &lt;!-- 配置DispatcherServlet --&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;SpringMVC&lt;/servlet-name&gt;
        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
        &lt;!-- 配置springMVC需要加载的配置文件--&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
            &lt;param-value&gt;classpath:spring-*.xml&lt;/param-value&gt;
        &lt;/init-param&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
        &lt;async-supported&gt;true&lt;/async-supported&gt;
    &lt;/servlet&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;SpringMVC&lt;/servlet-name&gt;
        &lt;!-- 匹配所有请求 --&gt;
        &lt;url-pattern&gt;/&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;

&lt;/web-app&gt;</code></pre><p>在【spring-mybatis.xml】中完成 spring 和 mybatis 的配置：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt;

    &lt;!-- 扫描service包下所有使用注解的类型 --&gt;
    &lt;context:component-scan base-package=&quot;cn.wmyskxz.service&quot;/&gt;

    &lt;!-- 配置数据库相关参数properties的属性：${url} --&gt;
    &lt;context:property-placeholder location=&quot;classpath:jdbc.properties&quot;/&gt;

    &lt;!-- 数据库连接池 --&gt;
    &lt;bean id=&quot;dataSource&quot; class=&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;&gt;
        &lt;property name=&quot;driverClass&quot; value=&quot;${jdbc.driver}&quot;/&gt;
        &lt;property name=&quot;jdbcUrl&quot; value=&quot;${jdbc.url}&quot;/&gt;
        &lt;property name=&quot;user&quot; value=&quot;${jdbc.username}&quot;/&gt;
        &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot;/&gt;
        &lt;property name=&quot;maxPoolSize&quot; value=&quot;${c3p0.maxPoolSize}&quot;/&gt;
        &lt;property name=&quot;minPoolSize&quot; value=&quot;${c3p0.minPoolSize}&quot;/&gt;
        &lt;property name=&quot;autoCommitOnClose&quot; value=&quot;${c3p0.autoCommitOnClose}&quot;/&gt;
        &lt;property name=&quot;checkoutTimeout&quot; value=&quot;${c3p0.checkoutTimeout}&quot;/&gt;
        &lt;property name=&quot;acquireRetryAttempts&quot; value=&quot;${c3p0.acquireRetryAttempts}&quot;/&gt;
    &lt;/bean&gt;

    &lt;!-- 配置SqlSessionFactory对象 --&gt;
    &lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
        &lt;!-- 注入数据库连接池 --&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;
        &lt;!-- 扫描entity包 使用别名 --&gt;
        &lt;property name=&quot;typeAliasesPackage&quot; value=&quot;cn.wmyskxz.entity&quot;/&gt;
        &lt;!-- 扫描sql配置文件:mapper需要的xml文件 --&gt;
        &lt;property name=&quot;mapperLocations&quot; value=&quot;classpath:mapper/*.xml&quot;/&gt;
    &lt;/bean&gt;

    &lt;!-- 配置扫描Dao接口包，动态实现Dao接口，注入到spring容器中 --&gt;
    &lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;
        &lt;!-- 注入sqlSessionFactory --&gt;
        &lt;property name=&quot;sqlSessionFactoryBeanName&quot; value=&quot;sqlSessionFactory&quot;/&gt;
        &lt;!-- 给出需要扫描Dao接口包 --&gt;
        &lt;property name=&quot;basePackage&quot; value=&quot;cn.wmyskxz.dao&quot;/&gt;
    &lt;/bean&gt;

    &lt;!-- 配置事务管理器 --&gt;
    &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;
        &lt;!-- 注入数据库连接池 --&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;
    &lt;/bean&gt;

    &lt;!-- 配置基于注解的声明式事务 --&gt;
    &lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot;/&gt;

&lt;/beans&gt;</code></pre><p>在【spring-mvc.xml】中完成 Spring MVC 的相关配置：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd
       http://www.springframework.org/schema/mvc
       http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd&quot;&gt;

    &lt;!-- 扫描web相关的bean --&gt;
    &lt;context:component-scan base-package=&quot;cn.wmyskxz.controller&quot;/&gt;

    &lt;!-- 开启SpringMVC注解模式 --&gt;
    &lt;mvc:annotation-driven/&gt;

    &lt;!-- 静态资源默认servlet配置 --&gt;
    &lt;mvc:default-servlet-handler/&gt;

    &lt;!-- 配置jsp 显示ViewResolver --&gt;
    &lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;
        &lt;property name=&quot;viewClass&quot; value=&quot;org.springframework.web.servlet.view.JstlView&quot;/&gt;
        &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/views/&quot;/&gt;
        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;
    &lt;/bean&gt;

&lt;/beans&gt;</code></pre><p>在【jdbc.properties】中配置 c3p0 数据库连接池：</p>
<pre><code>jdbc.driver=com.mysql.jdbc.Driver
#数据库地址
jdbc.url=jdbc:mysql://localhost:3306/student?useUnicode=true&amp;characterEncoding=utf8
#用户名
jdbc.username=root
#密码
jdbc.password=root
#最大连接数
c3p0.maxPoolSize=30
#最小连接数
c3p0.minPoolSize=10
#关闭连接后不自动commit
c3p0.autoCommitOnClose=false
#获取连接超时时间
c3p0.checkoutTimeout=10000
#当获取连接失败重试次数
c3p0.acquireRetryAttempts=2</code></pre><p>在【logback.xml】中完成日志输出的相关配置：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration debug=&quot;true&quot;&gt;
    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
    &lt;root level=&quot;debug&quot;&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;
    &lt;/root&gt;
&lt;/configuration&gt;</code></pre><p>以上就完成了 SSM 框架的基本配置：</p>
<ul>
<li>添加进了 SSM 项目所需要的 jar 包</li>
<li>配置好了 spring/mybatis/spring MVC 的相关配置信息（自动扫描 <code>cn.wmyskxz</code> 包下的带有注解的类）</li>
<li>通过 xml 配置的方式配置好了日志和数据库</li>
</ul>
<h4 id="⑤-实体类设计"><a href="#⑤-实体类设计" class="headerlink" title="⑤ 实体类设计"></a>⑤ 实体类设计</h4><p>实体类仅仅是对数据库中表的一一映射（表中字段名应该和实体类中的名称一一对应），同时可能还需要兼顾对业务能力的支持。</p>
<ul>
<li>在 Packge【cn.wmyskxz.entity】下创建 Student 类：<pre><code>package cn.wmyskxz.entity;
</code></pre></li>
</ul>
<p>import java.util.Date;</p>
<p>/**</p>
<ul>
<li><p>Student 实体类</p>
</li>
<li></li>
<li><p>@author: @我没有三颗心脏</p>
</li>
<li><p>@create: 2018-04-23-下午 13:34</p>
</li>
<li><p>/<br>public class Student {</p>
<p>  private int id;<br>  private int student_id;<br>  private String name;<br>  private int age;<br>  private String sex;<br>  private Date birthday;</p>
<p>  /* getter and setter */<br>}</p>
<pre><code></code></pre></li>
</ul>
<h4 id="⑤-DAO-类的设计"><a href="#⑤-DAO-类的设计" class="headerlink" title="⑤ DAO 类的设计"></a>⑤ DAO 类的设计</h4><p>DAO，即 Date Access Object，数据库访问对象，就是对数据库相关操作的封装，让其他地方看不到 JDBC 的代码。</p>
<p>在【cn.wmyskxz.dao】包下创建【StudentDao】接口：</p>
<pre><code>package cn.wmyskxz.dao;

import cn.wmyskxz.entity.Student;

import java.util.List;

public interface StudentDao {
    int getTotal();
    void addStudent(Student student);
    void deleteStudent(int id);
    void updateStudent(Student student);
    Student getStudent(int id);
    List&lt;Student&gt; list(int start, int count);
}</code></pre><p>然后在【resources/mapper】下创建好对应的映射文件【StudengDao.xml】：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;

&lt;!-- 将namespace的值设置为DAO类对应的路径 --&gt;
&lt;mapper namespace=&quot;cn.wmyskxz.dao.StudentDao&quot;&gt;

    &lt;!-- 查询数据条目 --&gt;
    &lt;select id=&quot;getTotal&quot; resultType=&quot;int&quot;&gt;
        SELECT COUNT(*) FROM student
    &lt;/select&gt;

    &lt;!-- 增加一条数据 --&gt;
    &lt;insert id=&quot;addStudent&quot; parameterType=&quot;Student&quot;&gt;
        INSERT INTO student VALUES(NULL, #{student_id}, #{name}, #{age}, #{sex}, #{birthday})
    &lt;/insert&gt;

    &lt;!-- 删除一条数据 --&gt;
    &lt;delete id=&quot;deleteStudent&quot; parameterType=&quot;int&quot;&gt;
        DELETE FROM student WHERE id = #{id}
    &lt;/delete&gt;

    &lt;!-- 更新一条数据 --&gt;
    &lt;update id=&quot;updateStudent&quot; parameterType=&quot;Student&quot;&gt;
        UPDATE student SET student_id = #{student_id}, name = #{name},
        age = #{age}, sex = #{sex}, birthday = #{birthday} WHERE id = #{id}
    &lt;/update&gt;

    &lt;!-- 查询一条数据 --&gt;
    &lt;select id=&quot;getStudent&quot; resultMap=&quot;student&quot; parameterType=&quot;int&quot;&gt;
        SELECT * FROM student WHERE id = #{id}
    &lt;/select&gt;

    &lt;resultMap id=&quot;student&quot; type=&quot;student&quot;&gt;
        &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;
        &lt;result column=&quot;student_id&quot; property=&quot;student_id&quot;/&gt;
        &lt;result column=&quot;name&quot; property=&quot;name&quot;/&gt;
        &lt;result column=&quot;age&quot; property=&quot;age&quot;/&gt;
        &lt;result column=&quot;sex&quot; property=&quot;sex&quot;/&gt;
        &lt;result column=&quot;birthday&quot; property=&quot;birthday&quot;/&gt;
    &lt;/resultMap&gt;

    &lt;!-- 查询从start位置开始的count条数据--&gt;
    &lt;select id=&quot;list&quot; resultMap=&quot;student&quot;&gt;
        SELECT * FROM student ORDER BY student_id desc limit #{param1}, #{param2}
    &lt;/select&gt;
&lt;/mapper&gt;</code></pre><p>编写好了 Dao 类是需要测试的，这里测试类就不给出了。</p>
<h4 id="⑦-业务类设计"><a href="#⑦-业务类设计" class="headerlink" title="⑦ 业务类设计"></a>⑦ 业务类设计</h4><ul>
<li><strong>问题：</strong> 为什么不直接使用 Dao 类而是还要在上面封装一层 Service 层呢？</li>
<li>回答：<br>基于责任分离的原则，Dao 层就应该专注于对数据库的操作，而在 Service 层我们可以增加一些非 CRUD 的方法去更好的完成本身抽离出来的 service 服务（业务处理）。</li>
</ul>
<p>在【cn.wmyskxz.service】包下创建【StudentService】接口：</p>
<pre><code>package cn.wmyskxz.service;

import cn.wmyskxz.entity.Student;

import java.util.List;

public interface StudentService {

    /**
     * 获取到 Student 的总数
     * @return
     */
    int getTotal();

    /**
     * 增加一条数据
     * @param student
     */
    void addStudent(Student student);

    /**
     * 删除一条数据
     * @param id
     */
    void deleteStudent(int id);

    /**
     * 更新一条数据
     * @param student
     */
    void updateStudent(Student student);

    /**
     * 找到一条数据
     * @param id
     * @return
     */
    Student getStudent(int id);

    /**
     * 列举出从 start 位置开始的 count 条数据
     * @param start
     * @param count
     * @return
     */
    List&lt;Student&gt; list(int start, int count);
}</code></pre><p>并在相同包名下创建实现类【StudentServiceImpl】：</p>
<pre><code>package cn.wmyskxz.service;

import cn.wmyskxz.dao.StudentDao;
import cn.wmyskxz.entity.Student;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;

/**
 * StudentService 的实现类
 *
 * @author: @我没有三颗心脏
 * @create: 2018-04-23-下午 13:51
 */
@Service
public class StudentServiceImpl implements StudentService {

    @Autowired
    StudentDao studentDao;

    public int getTotal() {
        return studentDao.getTotal();
    }

    public void addStudent(Student student) {
        studentDao.addStudent(student);
    }

    public void deleteStudent(int id) {
        studentDao.deleteStudent(id);
    }

    public void updateStudent(Student student) {
        studentDao.updateStudent(student);
    }

    public Student getStudent(int id) {
        return studentDao.getStudent(id);
    }

    public List&lt;Student&gt; list(int start, int count) {
        return studentDao.list(start, count);
    }
}</code></pre><h4 id="⑧-功能开发"><a href="#⑧-功能开发" class="headerlink" title="⑧ 功能开发"></a>⑧ 功能开发</h4><p>在【cn.wmyskxz.controller】包下创建【StudentController】控制器，代码基本上都是复制黏贴之前在 Servlet 中的代码：</p>
<pre><code>package cn.wmyskxz.controller;

import cn.wmyskxz.entity.Student;
import cn.wmyskxz.service.StudentService;
import cn.wmyskxz.util.Page;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

/**
 * Student 控制器
 *
 * @author: @我没有三颗心脏
 * @create: 2018-04-23-下午 13:27
 */
@Controller
@RequestMapping(&quot;&quot;)
public class StudentController {

    @Autowired
    private StudentService studentService;

    @RequestMapping(&quot;/addStudent&quot;)
    public String addStudent(HttpServletRequest request, HttpServletResponse response) {

        Student student = new Student();

        int studentID = Integer.parseInt(request.getParameter(&quot;student_id&quot;));
        String name = request.getParameter(&quot;name&quot;);
        int age = Integer.parseInt(request.getParameter(&quot;age&quot;));
        String sex = request.getParameter(&quot;sex&quot;);
        Date birthday = null;
        // String 类型按照 yyyy-MM-dd 的格式转换为 java.util.Date 类
        SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);
        try {
            birthday = simpleDateFormat.parse(request.getParameter(&quot;birthday&quot;));
        } catch (ParseException e) {
            e.printStackTrace();
        }

        student.setStudent_id(studentID);
        student.setName(name);
        student.setAge(age);
        student.setSex(sex);
        student.setBirthday(birthday);

        studentService.addStudent(student);

        return &quot;redirect:listStudent&quot;;
    }

    @RequestMapping(&quot;/listStudent&quot;)
    public String listStudent(HttpServletRequest request, HttpServletResponse response) {

        // 获取分页参数
        int start = 0;
        int count = 10;

        try {
            start = Integer.parseInt(request.getParameter(&quot;page.start&quot;));
            count = Integer.parseInt(request.getParameter(&quot;page.count&quot;));
        } catch (Exception e) {
        }

        Page page = new Page(start, count);

        List&lt;Student&gt; students = studentService.list(page.getStart(), page.getCount());
        int total = studentService.getTotal();
        page.setTotal(total);

        request.setAttribute(&quot;students&quot;, students);
        request.setAttribute(&quot;page&quot;, page);

        return &quot;listStudent&quot;;
    }

    @RequestMapping(&quot;/deleteStudent&quot;)
    public String deleteStudent(int id) {
        studentService.deleteStudent(id);
        return &quot;redirect:listStudent&quot;;
    }

    @RequestMapping(&quot;/editStudent&quot;)
    public ModelAndView editStudent(int id) {
        ModelAndView mav = new ModelAndView(&quot;editStudent&quot;);
        Student student = studentService.getStudent(id);
        mav.addObject(&quot;student&quot;, student);
        return mav;
    }

    @RequestMapping(&quot;/updateStudent&quot;)
    public String updateStudent(HttpServletRequest request, HttpServletResponse response) {

        Student student = new Student();

        int id = Integer.parseInt(request.getParameter(&quot;id&quot;));
        int student_id = Integer.parseInt(request.getParameter(&quot;student_id&quot;));
        String name = request.getParameter(&quot;name&quot;);
        int age = Integer.parseInt(request.getParameter(&quot;age&quot;));
        String sex = request.getParameter(&quot;sex&quot;);

        SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);
        Date birthday = null;
        try {
            birthday = simpleDateFormat.parse(request.getParameter(&quot;birthday&quot;));
        } catch (ParseException e) {
            e.printStackTrace();
        }

        student.setId(id);
        student.setStudent_id(student_id);
        student.setName(name);
        student.setAge(age);
        student.setSex(sex);
        student.setBirthday(birthday);

        studentService.updateStudent(student);
        return &quot;redirect:listStudent&quot;;
    }
}
</code></pre><ul>
<li><strong>注意：</strong> 所有的学号都用 student_id 表示，为了契合在数据库中的字段名（包括下面的 JSP 文件）</li>
</ul>
<p>JSP 文件也直接黏之前的就好了，不过需要<strong>注意所有的 <code>name</code> 属性</strong>：</p>
<ul>
<li>【listStudent.jsp】：</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot;
         pageEncoding=&quot;UTF-8&quot; %&gt;
&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;

&lt;html&gt;
&lt;head&gt;

    &lt;%-- 引入JQ和Bootstrap --%&gt;
    &lt;script src=&quot;js/jquery/2.0.0/jquery.min.js&quot;&gt;&lt;/script&gt;
    &lt;link href=&quot;css/bootstrap/3.3.6/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
    &lt;script src=&quot;js/bootstrap/3.3.6/bootstrap.min.js&quot;&gt;&lt;/script&gt;
    &lt;link href=&quot;css/style.css&quot; rel=&quot;stylesheet&quot;&gt;

    &lt;title&gt;学生管理页面 - 首页&lt;/title&gt;

    &lt;script&gt;
        $(function () {
            $(&quot;ul.pagination li.disabled a&quot;).click(function () {
                return false;
            });
        });
    &lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&quot;listDIV&quot;&gt;
    &lt;table class=&quot;table table-striped table-bordered table-hover table-condensed&quot;&gt;

        &lt;caption&gt;学生列表 - 共${page.total}人&lt;/caption&gt;
        &lt;thead&gt;
        &lt;tr class=&quot;success&quot;&gt;
            &lt;th&gt;学号&lt;/th&gt;
            &lt;th&gt;姓名&lt;/th&gt;
            &lt;th&gt;年龄&lt;/th&gt;
            &lt;th&gt;性别&lt;/th&gt;
            &lt;th&gt;出生日期&lt;/th&gt;

            &lt;th&gt;编辑&lt;/th&gt;
            &lt;th&gt;删除&lt;/th&gt;
        &lt;/tr&gt;
        &lt;/thead&gt;

        &lt;tbody&gt;
        &lt;c:forEach items=&quot;${students}&quot; var=&quot;s&quot; varStatus=&quot;status&quot;&gt;
            &lt;tr&gt;
                &lt;td&gt;${s.student_id}&lt;/td&gt;
                &lt;td&gt;${s.name}&lt;/td&gt;
                &lt;td&gt;${s.age}&lt;/td&gt;
                &lt;td&gt;${s.sex}&lt;/td&gt;
                &lt;td&gt;${s.birthday}&lt;/td&gt;

                &lt;td&gt;&lt;a href=&quot;/editStudent?id=${s.id}&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-edit&quot;&gt;&lt;/span&gt; &lt;/a&gt;&lt;/td&gt;
                &lt;td&gt;&lt;a href=&quot;/deleteStudent?id=${s.id}&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-trash&quot;&gt;&lt;/span&gt; &lt;/a&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/c:forEach&gt;

        &lt;/tbody&gt;
    &lt;/table&gt;
&lt;/div&gt;

&lt;nav class=&quot;pageDIV&quot;&gt;
    &lt;ul class=&quot;pagination&quot;&gt;
        &lt;li &lt;c:if test=&quot;${!page.hasPreviouse}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=0&quot;&gt;
                &lt;span&gt;«&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;

        &lt;li &lt;c:if test=&quot;${!page.hasPreviouse}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=${page.start-page.count}&quot;&gt;
                &lt;span&gt;‹&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;

        &lt;c:forEach begin=&quot;0&quot; end=&quot;${page.totalPage-1}&quot; varStatus=&quot;status&quot;&gt;

            &lt;c:if test=&quot;${status.count*page.count-page.start&lt;=30 &amp;&amp; status.count*page.count-page.start&gt;=-10}&quot;&gt;
                &lt;li &lt;c:if test=&quot;${status.index*page.count==page.start}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
                    &lt;a
                            href=&quot;?page.start=${status.index*page.count}&quot;
                            &lt;c:if test=&quot;${status.index*page.count==page.start}&quot;&gt;class=&quot;current&quot;&lt;/c:if&gt;
                    &gt;${status.count}&lt;/a&gt;
                &lt;/li&gt;
            &lt;/c:if&gt;
        &lt;/c:forEach&gt;

        &lt;li &lt;c:if test=&quot;${!page.hasNext}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=${page.start+page.count}&quot;&gt;
                &lt;span&gt;›&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;
        &lt;li &lt;c:if test=&quot;${!page.hasNext}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=${page.last}&quot;&gt;
                &lt;span&gt;»&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;
    &lt;/ul&gt;
&lt;/nav&gt;

&lt;div class=&quot;addDIV&quot;&gt;

    &lt;div class=&quot;panel panel-success&quot;&gt;
        &lt;div class=&quot;panel-heading&quot;&gt;
            &lt;h3 class=&quot;panel-title&quot;&gt;增加学生&lt;/h3&gt;
        &lt;/div&gt;
        &lt;div class=&quot;panel-body&quot;&gt;

            &lt;form method=&quot;post&quot; action=&quot;/addStudent&quot; role=&quot;form&quot;&gt;
                &lt;table class=&quot;addTable&quot;&gt;
                    &lt;tr&gt;
                        &lt;td&gt;学号：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;student_id&quot; id=&quot;student_id&quot; placeholder=&quot;请在这里输入学号&quot;&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;姓名：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;name&quot; placeholder=&quot;请在这里输入名字&quot;&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;年龄：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;age&quot; id=&quot;age&quot; placeholder=&quot;请在这里输入年龄&quot;&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;性别：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;radio&quot; class=&quot;radio radio-inline&quot; name=&quot;sex&quot; value=&quot;男&quot;&gt; 男
                            &lt;input type=&quot;radio&quot; class=&quot;radio radio-inline&quot; name=&quot;sex&quot; value=&quot;女&quot;&gt; 女
                        &lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;出生日期：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;date&quot; name=&quot;birthday&quot; id=&quot;birthday&quot; placeholder=&quot;请在这里输入出生日期&quot;&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr class=&quot;submitTR&quot;&gt;
                        &lt;td colspan=&quot;2&quot; align=&quot;center&quot;&gt;
                            &lt;button type=&quot;submit&quot; class=&quot;btn btn-success&quot;&gt;提 交&lt;/button&gt;
                        &lt;/td&gt;

                    &lt;/tr&gt;

                &lt;/table&gt;
            &lt;/form&gt;
        &lt;/div&gt;
    &lt;/div&gt;

&lt;/div&gt;


&lt;/body&gt;
&lt;/html&gt;</code></pre><ul>
<li>【editStudent.jsp】：</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot;
         pageEncoding=&quot;UTF-8&quot; %&gt;
&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;

&lt;html&gt;
&lt;head&gt;

    &lt;%-- 引入JQ和Bootstrap --%&gt;
    &lt;script src=&quot;js/jquery/2.0.0/jquery.min.js&quot;&gt;&lt;/script&gt;
    &lt;link href=&quot;css/bootstrap/3.3.6/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
    &lt;script src=&quot;js/bootstrap/3.3.6/bootstrap.min.js&quot;&gt;&lt;/script&gt;
    &lt;link href=&quot;css/style.css&quot; rel=&quot;stylesheet&quot;&gt;

    &lt;title&gt;学生管理页面 - 编辑页面&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&quot;editDIV&quot;&gt;

    &lt;div class=&quot;panel panel-success&quot;&gt;
        &lt;div class=&quot;panel-heading&quot;&gt;
            &lt;h3 class=&quot;panel-title&quot;&gt;编辑学生&lt;/h3&gt;
        &lt;/div&gt;
        &lt;div class=&quot;panel-body&quot;&gt;

            &lt;form method=&quot;post&quot; action=&quot;/updateStudent&quot; role=&quot;form&quot;&gt;
                &lt;table class=&quot;editTable&quot;&gt;
                    &lt;tr&gt;
                        &lt;td&gt;学号：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;student_id&quot; id=&quot;student_id&quot; value=&quot;${student.student_id}&quot;
                                   placeholder=&quot;请在这里输入学号&quot;&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;姓名：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;name&quot; value=&quot;${student.name}&quot; placeholder=&quot;请在这里输入名字&quot;&gt;
                        &lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;年龄：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;age&quot; id=&quot;age&quot; value=&quot;${student.age}&quot; placeholder=&quot;请在这里输入年龄&quot;&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;性别：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;radio&quot; class=&quot;radio radio-inline&quot; name=&quot;sex&quot; value=&quot;男&quot;&gt; 男
                            &lt;input type=&quot;radio&quot; class=&quot;radio radio-inline&quot; name=&quot;sex&quot; value=&quot;女&quot;&gt; 女
                        &lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;出生日期：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;date&quot; name=&quot;birthday&quot; id=&quot;birthday&quot; value=&quot;${student.birthday}&quot;
                                   placeholder=&quot;请在这里输入出生日期&quot;&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr class=&quot;submitTR&quot;&gt;
                        &lt;td colspan=&quot;2&quot; align=&quot;center&quot;&gt;
                            &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;${student.id}&quot;&gt;
                            &lt;button type=&quot;submit&quot; class=&quot;btn btn-success&quot;&gt;提 交&lt;/button&gt;
                        &lt;/td&gt;

                    &lt;/tr&gt;

                &lt;/table&gt;
            &lt;/form&gt;
        &lt;/div&gt;
    &lt;/div&gt;

&lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre><ul>
<li>style.css 文件：</li>
</ul>
<pre><code>body {
    padding-top: 60px;
}

div.listDIV {
    width: 600px;
    margin: 0 auto;
}

div.editDIV {
    width: 400px;
    margin: 0 auto;
}

nav.pageDIV {
    text-align: center;
}

div.addDIV {
    width: 300px;
    margin: 0 auto;
}

table.addTable {
    width: 100%;
    padding: 5px;
}

table.addTable td {
    padding: 5px;
}

table.editTable {
    width: 100%;
    padding: 5px;
}

table.editTable td {
    padding: 5px;
}</code></pre><h4 id="项目的整体结构"><a href="#项目的整体结构" class="headerlink" title="项目的整体结构"></a>项目的整体结构</h4><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-3012fde670b3ff42.png" alt=""></p>
<h4 id="分页功能"><a href="#分页功能" class="headerlink" title="分页功能"></a>分页功能</h4><ul>
<li>首先在 Packge【util】包下创建一个 Page 工具类：</li>
</ul>
<pre><code>package cn.wmyskxz.util;

public class Page {

    int start;        // 开始数据
    int count;        // 每一页的数量
    int total;        // 总共的数据量

    public Page(int start, int count) {
        super();
        this.start = start;
        this.count = count;
    }

    public boolean isHasPreviouse(){
        if(start==0)
            return false;
        return true;

    }
    public boolean isHasNext(){
        if(start==getLast())
            return false;
        return true;
    }

    public int getTotalPage(){
        int totalPage;
        // 假设总数是50，是能够被5整除的，那么就有10页
        if (0 == total % count)
            totalPage = total /count;
            // 假设总数是51，不能够被5整除的，那么就有11页
        else
            totalPage = total / count + 1;

        if(0==totalPage)
            totalPage = 1;
        return totalPage;

    }

    public int getLast(){
        int last;
        // 假设总数是50，是能够被5整除的，那么最后一页的开始就是40
        if (0 == total % count)
            last = total - count;
            // 假设总数是51，不能够被5整除的，那么最后一页的开始就是50
        else
            last = total - total % count;

        last = last&lt;0?0:last;
        return last;
    }

    // 各种 setter 和 getter
}</code></pre><ul>
<li>totalPage 是计算得来的数，用来表示页码一共的数量</li>
</ul>
<p>在首页显示的 StudentList 用 page 的参数来获取：</p>
<pre><code>List&lt;Student&gt; students = studentService.list(page.getStart(), page.getCount());</code></pre><p>并且在映射文件中用 <strong>LIMIT</strong> 关键字：</p>
<pre><code>&lt;!-- 查询从start位置开始的count条数据--&gt;
&lt;select id=&quot;list&quot; resultMap=&quot;student&quot;&gt;
    SELECT * FROM student ORDER BY student_id desc limit #{param1}, #{param2}
&lt;/select&gt;</code></pre><ul>
<li><p>第一个参数为 start，第二个参数为 count<br>这样就能根据分页的信息来获取到响应的数据</p>
</li>
<li><p><strong>编写分页栏：</strong></p>
</li>
</ul>
<p>1.写好头和尾</p>
<pre><code>&lt;nav class=&quot;pageDIV&quot;&gt;
    &lt;ul class=&quot;pagination&quot;&gt;
    .....
    &lt;/ul&gt;
&lt;/nav&gt;</code></pre><p>2.写好<code>«</code> <code>‹</code>这两个功能按钮<br>使用 <code>&lt;c:if&gt;</code>标签来增加边界判断，如果没有前面的页码了则设置为disable状态</p>
<pre><code>        &lt;li &lt;c:if test=&quot;${!page.hasPreviouse}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=0&quot;&gt;
                &lt;span&gt;«&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;

        &lt;li &lt;c:if test=&quot;${!page.hasPreviouse}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=${page.start-page.count}&quot;&gt;
                &lt;span&gt;‹&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;</code></pre><p>再通过 JavaScrip 代码来完成禁用功能：</p>
<pre><code>&lt;script&gt;
    $(function () {
        $(&quot;ul.pagination li.disabled a&quot;).click(function () {
            return false;
        });
    });
&lt;/script&gt;</code></pre><p>3.完成中间页码的编写<br>从 <code>0</code> 循环到 <code>page.totalPage - 1</code> ，<code>varStatus</code> 相当于是循环变量</p>
<ul>
<li>status.count 是从1开始遍历</li>
<li>status.index 是从0开始遍历</li>
<li><strong>要求：</strong>显示当前页码的前两个和后两个就可，例如当前页码为3的时候，就显示 1 2 3(当前页) 4 5 的页码</li>
<li><strong>理解测试条件：</strong></li>
<li>10 &lt;= 当前页*每一页显示的数目 - 当前页开始的数据编号 &lt;= 30</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-1f82d91e47a31c7f.png" alt=""></p>
<ul>
<li>只要理解了这个判断条件，其他的就都好理解了</li>
</ul>
<pre><code>&lt;c:forEach begin=&quot;0&quot; end=&quot;${page.totalPage-1}&quot; varStatus=&quot;status&quot;&gt;

    &lt;c:if test=&quot;${status.count*page.count-page.start&lt;=30 &amp;&amp; status.count*page.count-page.start&gt;=-10}&quot;&gt;
        &lt;li &lt;c:if test=&quot;${status.index*page.count==page.start}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a
                    href=&quot;?page.start=${status.index*page.count}&quot;
                    &lt;c:if test=&quot;${status.index*page.count==page.start}&quot;&gt;class=&quot;current&quot;&lt;/c:if&gt;
            &gt;${status.count}&lt;/a&gt;
        &lt;/li&gt;
    &lt;/c:if&gt;
&lt;/c:forEach&gt;</code></pre><p>4.在控制器中获取参数</p>
<pre><code>// 获取分页参数
int start = 0;
int count = 10;

try {
    start = Integer.parseInt(request.getParameter(&quot;page.start&quot;));
    count = Integer.parseInt(request.getParameter(&quot;page.count&quot;));
} catch (Exception e) {
}

....

// 共享 page 数据
request.setAttribute(&quot;page&quot;, page);</code></pre><h4 id="Date-转换的问题"><a href="#Date-转换的问题" class="headerlink" title="Date 转换的问题"></a>Date 转换的问题</h4><p>最开始的时候，我们看到页面上显示的日期是这样的格式：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-6d4120db01b4df30.png" alt=""></p>
<p>这显然是我们不希望看到的</p>
<ul>
<li>解决方案：在映射文件中设置日期显示的类型。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-d70cfa9638709579.png" alt=""></p>
<p>重新部署文件，然后刷新页面，就能看到我们希望的效果啦：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-f99cbf278ce04c17.png" alt=""></p>
<h4 id="项目总结"><a href="#项目总结" class="headerlink" title="项目总结"></a>项目总结</h4><ol>
<li>由于之前的项目代码都有，所以在<strong>重构的时候，基本上没有花什么时间</strong>就完成了项目的搭建，能够体会到<strong>代码分离的重要性</strong>，这在很大程度上保证了我们的代码复用。</li>
<li>相较于之前用 Servlet + JSP 来完成，很明显的感觉是<strong>DAO层的编写方便了很多，仅仅需要编写一个 xml 映射文件和一个 Dao 层接口就可以完成功能，</strong>而不用自己再去重复的去在每一个 CRUD 方法中去处理结果集，重复而且繁琐。</li>
<li><strong>注解真的很方便，</strong>这不仅仅提升了我们自身开发的效率，写起来也很带劲儿。</li>
<li><strong>开发效率快，而且低耦合，</strong>我们基于 xml 配置了大部分的工作，在基于 SSM 框架开发时，我们<strong>可以把专注点集中在逻辑处理上。</strong></li>
<li>在 SSM 框架中<strong>能方便的对项目进行修改，</strong>这不仅仅得益于框架的约定，使得代码分离并且可复用，也得益于 Maven 工具对于项目的管理。</li>
<li>我们能够通过一个 Controller 来完成五个 Servlet 的功能，并且通过注解来完成配置。</li>
</ol>
<hr>
<h2 id="项目改进"><a href="#项目改进" class="headerlink" title="项目改进"></a>项目改进</h2><p>项目很简单，仅仅也只是在数据库增删改查的基础上增加了一个界面，我们来动手改一改。</p>
<h4 id="改进一：增加删除提示"><a href="#改进一：增加删除提示" class="headerlink" title="改进一：增加删除提示"></a>改进一：增加删除提示</h4><p>第一个想到的就是删除提示，没有删除提示是很要命的一件事情，如果手滑了一下那可能就悲剧了….</p>
<p>首先我们在顶部的 <code>&lt;head&gt;</code> 标签中的 <code>&lt;script&gt;</code> 中增加一段代码：</p>
<pre><code>function del() {
    var msg = &quot;您真的确定要删除吗？\n\n请确认！&quot;;
    if (confirm(msg) == true) {
        return true;
    } else {
        return false;
    }
}</code></pre><p>然后在删除 a 标签页中增加 onclick 属性：</p>
<pre><code>onclick=&quot;javascript:return del();&quot;
....就像下面这样....
td&gt;&lt;a href=&quot;/deleteStudent?id=${s.id}&quot; onclick=&quot;javascript:return del();&quot;&gt;&lt;span
        class=&quot;glyphicon glyphicon-trash&quot;&gt;&lt;/span&gt; &lt;/a&gt;&lt;/td&gt;</code></pre><p>当我们刷新页面后，点击删除就会弹出提示信息：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-944caee345a8b0a4.png" alt=""></p>
<h4 id="改进二：编辑页面自动勾选上性别"><a href="#改进二：编辑页面自动勾选上性别" class="headerlink" title="改进二：编辑页面自动勾选上性别"></a>改进二：编辑页面自动勾选上性别</h4><p>在当前的项目中，如果点击编辑按钮进入到编辑页面后，性别这个选项是空选的状态，这就很low：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-4e3152100e76f6f6.png" alt=""></p>
<p>这个也很简单，在 editStudent 页面增加一些判断就好了：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-90029a61673b0b1e.png" alt=""></p>
<p>用 <code>&lt;c:if&gt;</code> 标签来判断 sex 的值，然后根据对应的属性增加 checked 属性，这样就可以自动勾选上所对应的属性：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-814b777087dd85d0.png" alt=""></p>
<h4 id="改进三：空值判断"><a href="#改进三：空值判断" class="headerlink" title="改进三：空值判断"></a>改进三：空值判断</h4><p>我们允许设置为 null 的值仅仅为出生日期，其他的值均不允许出现空值，所以我们需要加入空值判断：</p>
<pre><code>function checkEmpty(id, name) {
    var value = $(&quot;#&quot; + id).val();
    if (value.length == 0) {
        alert(name + &quot;不能为空&quot;);
        $(&quot;#&quot; + id).focus();
        return false;
    }
    return true;
}</code></pre><p>然后再为 form 创建一个 id 属性值为 “addForm” 并添加进判断空值的方法：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-3a2a1bf8b9030c40.png" alt=""></p>
<ul>
<li><strong>注意：</strong> 这里需要写在 $(function(){}) 里面，等待文档加载完毕才能生效。</li>
<li>这里并没有为 sex 属性判断空值，我们采用一个简单的<strong>为 sex 添加一个默认勾选项</strong>来省略空值的判断。</li>
</ul>
<p>同样的，我们也在编辑页面，采用同样的方法进行空值判断：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88SSM%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-f51f469bcaef903d.png" alt=""></p>
<ul>
<li>当进入编辑页面的时候已经有默认的勾选项了，所以 sex 值仍然不需要判空</li>
<li>最后给出项目地址：<a href="https://github.com/wmyskxz/StudentManager-SSM" target="_blank" rel="noopener">https://github.com/wmyskxz/StudentManager-SSM</a></li>
</ul>
<blockquote>
<p>欢迎转载，转载请注明出处！<br>简书ID：<a href="https://www.jianshu.com/u/a40d61a49221" target="_blank" rel="noopener">@我没有三颗心脏</a><br>github：<a href="https://github.com/wmyskxz/" target="_blank" rel="noopener">wmyskxz</a><br>欢迎关注公众微信号：wmyskxz_javaweb<br>分享自己的Java Web学习之路以及各种Java学习资料</p>
</blockquote>

      
    </div>
    
      
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post white-box shadow reveal ">
  


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h2 class="title">
    <a href="/2018/04/09/chu-xue-java-web-9-xue-sheng-guan-li-xi-tong-jian-yi-ban-zong-jie/">
      初学Java Web(9)——学生管理系统(简易版)总结
    </a>
  </h2>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a class='author' href="" rel="nofollow">
    <img no-lazy src="">
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/JavaWeb%E5%9F%BA%E7%A1%80/%E9%A1%B9%E7%9B%AE/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>JavaWeb基础/项目</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2018年4月9日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  


            
          
            
              

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      
        <p>项目开始时间：2018年4月8日14:37:47<br>项目完成时间：2018年4月9日10:03:30</p>
<h2 id="技术准备"><a href="#技术准备" class="headerlink" title="技术准备"></a>技术准备</h2><blockquote>
<p>这个项目是自己用于巩固 J2EE 相关知识的练手项目，非常简单，但是相关的功能却非常实用，所以在这里分享一下</p>
</blockquote>
<p>为了完成这个项目，需要掌握如下技术：</p>
<ul>
<li>Java<br>基础知识</li>
<li>前端：<br>HTML, CSS, JAVASCRIPT, JQUERY</li>
<li>J2EE：<br>Tomcat, Servlet, JSP, Filter</li>
<li>数据库：<br>MySQL</li>
</ul>
<h2 id="开发流程"><a href="#开发流程" class="headerlink" title="开发流程"></a>开发流程</h2><p>项目虽然很简单，很小，但是为了开发的有条不紊，还是按照商业项目的开发来完成。</p>
<h4 id="①-需求分析"><a href="#①-需求分析" class="headerlink" title="① 需求分析"></a>① 需求分析</h4><p>首先要确定要做哪些功能</p>
<ul>
<li>使用<strong>数据库</strong>来<strong>保存数据</strong></li>
<li>能<strong>增删改查</strong>学生的信息<em>（学号，名称，年龄，性别，出生日期）</em></li>
</ul>
<h4 id="②-表结构设计"><a href="#②-表结构设计" class="headerlink" title="② 表结构设计"></a>② 表结构设计</h4><p>根据需求，那么只需要一个 student 表就能够完成功能了。</p>
<ul>
<li><p><strong>创建数据库：student</strong><br>将数据库编码格式设置为 UTF-8 ，便于存取中文数据</p>
<pre class=" language-MySQL"><code class="language-MySQL">DROP DATABASE IF EXISTS student;
CREATE DATABASE student DEFAULT CHARACTER SET utf8;</code></pre>
</li>
<li><p><strong>创建学生表：student</strong><br>不用<strong>学生学号(studentID)</strong>作为主键的原因是：不方便操作，例如在更新数据的时候，同时也要更改学号，那这样的操作怎么办呢？<br>所以我们加了一个 <strong>id</strong> 用来唯一表示当前数据。</p>
<pre class=" language-MySQL"><code class="language-MySQL">CREATE TABLE student(
id int(11) NOT NULL AUTO_INCREMENT,
studentID int(11) NOT NULL UNIQUE,
name varchar(255) NOT NULL,
age int(11) NOT NULL,
sex varchar(255) NOT NULL,
birthday date DEFAULT NULL,
PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;</code></pre>
</li>
</ul>
<h4 id="③-原型设计"><a href="#③-原型设计" class="headerlink" title="③ 原型设计"></a>③ 原型设计</h4><p>就是设计界面，在商业项目中，这是很重要的一步，我们可以<strong>解除界面原型，低成本、高效率</strong>的与客户达成<strong>需求的一致性</strong>。</p>
<p>这个项目一共就分为两个页面：</p>
<ul>
<li><p>主页面：<br><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%88%9D%E5%AD%A6Java-Web(9)%E2%80%94%E2%80%94%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-0169962ea353fcbd.png" alt="首页"></p>
</li>
<li><p>学生编辑页面：<br><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%88%9D%E5%AD%A6Java-Web(9)%E2%80%94%E2%80%94%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-2eac73f04dcf3ea4.png" alt="编辑页面"></p>
</li>
</ul>
<h4 id="④-实体类的设计"><a href="#④-实体类的设计" class="headerlink" title="④ 实体类的设计"></a>④ 实体类的设计</h4><p>实体类仅仅是对数据库中表的一一映射，同时可能还需要兼顾对业务能力的支持。</p>
<ul>
<li>在 Packge[bean]下创建 Student 类：<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> bean<span class="token punctuation">;</span>
</code></pre>
</li>
</ul>
<p>import java.util.Date;</p>
<p>public class Student {</p>
<pre><code>private int id;                // 在数据库中的ID
private int studentID;      // 学号，跟ID区分开为了方便数据库操作
private String name;        // 姓名
private int age;            // 年龄
private String sex;            // 性别
private Date birthday;        // 出生日期

// setter 和 getter (为节约篇幅没列出来)</code></pre><p>}</p>
<pre><code>
#### ⑤ DAO 类的设计
DAO，即 Date Access Object，数据库访问对象，就是对数据库相关操作的封装，让其他地方看不到 JDBC 的代码。

首先我们先创建一个数据库操作的工具类：
- 在 Packge[util]下创建 DBUtil 类：
```java
/**
 * 数据库工具类，这个类的作用是初始化驱动，并且提供一个getConnection用于获取连接。
 */
package util;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

public class DBUtil {

    static String ip = &quot;127.0.0.1&quot;;
    static int port = 3306;
    static String database = &quot;student&quot;;
    static String encoding = &quot;UTF-8&quot;;
    static String loginName = &quot;root&quot;;
    static String password = &quot;root&quot;;

    static {

        try {
            Class.forName(&quot;com.mysql.jdbc.Driver&quot;);
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
    }

    public static Connection getConnection() throws SQLException {
        String url = String.format(&quot;jdbc:mysql://%s:%d/%s?characterEncoding=%s&quot;, ip, port, database, encoding);
        return DriverManager.getConnection(url, loginName, password);
    }

    public static void main(String[] args) throws SQLException {
        System.out.println(getConnection());

    }

}</code></pre><ul>
<li>写工具类的好处：</li>
</ul>
<p><strong>便于统一维护，降低维护成本</strong></p>
<p>然后是 DAO 类，除了进行典型的 ORM 支持功能之外，也需要提供各种业务方法。</p>
<ul>
<li>在 Packge[dao]下创建 StudentDAO 类：<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> dao<span class="token punctuation">;</span>
</code></pre>
</li>
</ul>
<p>import bean.Student;<br>import util.DBUtil;</p>
<p>import java.sql.*;<br>import java.util.ArrayList;<br>import java.util.List;</p>
<p>public class StudentDAO {</p>
<pre><code>public int getTotal() {

    int total = 0;

    String sql = &quot;SELECT COUNT(*) FROM student&quot;;
    try (Connection c = DBUtil.getConnection(); Statement st = c.createStatement()) {

        ResultSet rs = st.executeQuery(sql);
        while (rs.next()) {
            total = rs.getInt(1);
        }
    } catch (SQLException e) {
        e.printStackTrace();
    }

    return total;
}

public void add(Student student) {

    String sql = &quot;INSERT INTO student VALUES(NULL,?,?,?,?,?)&quot;;
    try (Connection c = DBUtil.getConnection(); PreparedStatement ps = c.prepareStatement(sql)) {

        ps.setInt(1, student.getStudentID());
        ps.setString(2, student.getName());
        ps.setInt(3, student.getAge());
        ps.setString(4, student.getSex());
        ps.setDate(5, new java.sql.Date(student.getBirthday().getTime()));

        ps.execute();
    } catch (SQLException e) {
        e.printStackTrace();
    }
}

public void delete(int id) {

    String sql = &quot;DELETE FROM student WHERE ID = ?&quot;;
    try (Connection c = DBUtil.getConnection(); PreparedStatement ps = c.prepareStatement(sql)) {

        ps.setInt(1, id);

        ps.execute();

    } catch (SQLException e) {
        e.printStackTrace();
    }
}

public void update(Student student) {

    String sql = &quot;update student set student_id = ?, name = ?, age = ?, sex = ?, birthday = ? where id = ? &quot;;
    try (Connection c = DBUtil.getConnection(); PreparedStatement ps = c.prepareStatement(sql)) {

        ps.setInt(1, student.getStudentID());
        ps.setString(2, student.getName());
        ps.setInt(3, student.getAge());
        ps.setString(4, student.getSex());
        ps.setDate(5, new java.sql.Date(student.getBirthday().getTime()));
        ps.setInt(6, student.getId());

        ps.execute();

    } catch (SQLException e) {
        e.printStackTrace();
    }
}

public Student get(int id) {

    Student student = new Student();

    String sql = &quot;SELECT * FROM student WHERE ID = &quot; + id;
    try (Connection c = DBUtil.getConnection(); Statement st = c.createStatement()) {

        ResultSet rs = st.executeQuery(sql);

        if (rs.next()) {

            int student_id = rs.getInt(&quot;student_id&quot;);
            String name = rs.getString(&quot;name&quot;);
            int age = rs.getInt(&quot;age&quot;);
            String sex = rs.getString(&quot;sex&quot;);
            Date birthday = rs.getDate(&quot;birthday&quot;);
            student.setStudentID(student_id);
            student.setName(name);
            student.setAge(age);
            student.setSex(sex);
            student.setBirthday(birthday);
            student.setId(id);
        }

    } catch (SQLException e) {
        e.printStackTrace();
    }

    return student;
}

public List&lt;Student&gt; list() {
    return list(0, Short.MAX_VALUE);
}

public List&lt;Student&gt; list(int start, int count) {

    List&lt;Student&gt; students = new ArrayList&lt;&gt;();

    String sql = &quot;SELECT * FROM student ORDER BY student_id desc limit ?,?&quot;;

    try (Connection c = DBUtil.getConnection(); PreparedStatement ps = c.prepareStatement(sql)) {

        ps.setInt(1, start);
        ps.setInt(2, count);

        ResultSet rs = ps.executeQuery();

        while (rs.next()) {
            Student student = new Student();
            int id = rs.getInt(&quot;id&quot;);
            int studentID = rs.getInt(&quot;student_id&quot;);
            String name = rs.getString(&quot;name&quot;);
            int age = rs.getInt(&quot;age&quot;);
            String sex = rs.getString(&quot;sex&quot;);
            Date birthday = rs.getDate(&quot;birthday&quot;);
            student.setId(id);
            student.setStudentID(studentID);
            student.setName(name);
            student.setAge(age);
            student.setSex(sex);
            student.setBirthday(birthday);

            students.add(student);
        }

        rs.close();

    } catch (SQLException e) {
        e.printStackTrace();
    }

    return students;
}</code></pre><p>}</p>
<pre><code>- 该类中，既提供了**增删改查**这些基本的 **CRUD** 操作
1.增加：`public void add(Student student)`
2.删除：`public void delete(int id)`
3.修改：`public void update(Student student)`
4.查询所有：`public List&lt;Student&gt; list()`
- 又提供了一些非 **CRUD** 方法
1.获取总数：`public int getTotal()`
2.根据 id 获取：`public Student get(int id)`

#### ⑥ 业务类介绍
作为 J2EE Web 应用，一般都会按照如图所示的设计流程进行：
Servlet -&gt; Service（业务类） -&gt; DAO -&gt; database 

当浏览器提交请求到 Tomcat Web 服务器的时候，对应的 Servlet 的doGet/doPost 方法会被调用，接着在 Servlet 中调用 Service类，然后在 Service 类中调用DAO类，最后在 DAO 中访问数据库获取相应的数据。
![](https://cdn.jsdelivr.net/gh/wmyskxz/img/img/初学Java-Web(9)——学生管理系统（简易版）总结/7896890-7e224d06d164441a.png)

单本项目没有使用 Service 这一层，原因是在对 DAO 类进行开发中，已经提供了很好的支持业务的方法，没有必要再包括上一层 Service 业务类。

&gt; 参考链接：[这里](http://how2j.cn/k/tmall-j2ee/tmall-j2ee-995/995.html)

#### ⑦ 功能开发
需要按照模块之间的依赖关系，顺序开发。
- 首先为项目添加[必要的 jar 包](https://pan.baidu.com/s/19EXWcsi1DUMdUrCXgPeqVg)：
jstl.jar
mysql-connector-java-5.0.8-bin.jar
servlet-api.jar
standard.jar
这也是 Web 开发中最基本的 4 个包

#### ——【1.编写 Filter】——
由于项目中设计表单 POST 方式的提交，所以我们先来编写好相关编码的过滤器，好支持中文的存取

- 在 Packge[filter] 下编写 EncodingFilter 类：
```java
package filter;

import javax.servlet.*;
import javax.servlet.annotation.WebFilter;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebFilter(&quot;/*&quot;)
public class EncodingFilter implements Filter {

    public void destroy() {
    }

    public void doFilter(ServletRequest req, ServletResponse resp, FilterChain chain) throws ServletException, IOException {

        HttpServletRequest request = (HttpServletRequest) req;
        HttpServletResponse response = (HttpServletResponse) resp;

        // 设置编码格式为 UTF-8
        request.setCharacterEncoding(&quot;UTF-8&quot;);

        chain.doFilter(request, response);
    }

    public void init(FilterConfig config) throws ServletException {
    }

}</code></pre><h4 id="——【2-编写-Servlet-】——"><a href="#——【2-编写-Servlet-】——" class="headerlink" title="——【2. 编写 Servlet 】——"></a>——【2. 编写 Servlet 】——</h4><p>按照传统的方式，我们项目的业务为<strong>增删改查</strong>，所以对应四个路径，也就是需要编写四个 Servlet 才可以</p>
<ul>
<li><strong>AddServlet：</strong><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> servlet<span class="token punctuation">;</span>
</code></pre>
</li>
</ul>
<p>import bean.Student;<br>import dao.StudentDAO;</p>
<p>import javax.servlet.ServletException;<br>import javax.servlet.annotation.WebServlet;<br>import javax.servlet.http.HttpServlet;<br>import javax.servlet.http.HttpServletRequest;<br>import javax.servlet.http.HttpServletResponse;<br>import java.io.IOException;<br>import java.text.ParseException;<br>import java.text.SimpleDateFormat;<br>import java.util.Date;</p>
<p>@WebServlet(“/addStudent”)<br>public class AddServlet extends HttpServlet {</p>
<pre><code>protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

    Student student = new Student();

    // 直接从表单中获取数据
    int studentID = Integer.parseInt(req.getParameter(&quot;studentID&quot;));
    String name = req.getParameter(&quot;name&quot;);
    int age = Integer.parseInt(req.getParameter(&quot;age&quot;));
    String sex = req.getParameter(&quot;radio&quot;);
    Date birthday = null;

    // String 类型按照 yyyy-MM-dd 的格式转换为 java.util.Date 类
    SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);
    try {
        birthday = simpleDateFormat.parse(req.getParameter(&quot;birthday&quot;));
    } catch (ParseException e) {
        e.printStackTrace();
    }

    student.setStudentID(studentID);
    student.setName(name);
    student.setAge(age);
    student.setSex(sex);
    student.setBirthday(birthday);

    new StudentDAO().add(student);

    resp.sendRedirect(&quot;/listStudent&quot;);  // 这里可以理解为刷新，重新请求
}</code></pre><p>}</p>
<pre><code>
- **DeleteServlet：**</code></pre><p>package servlet;</p>
<p>import dao.StudentDAO;</p>
<p>import javax.servlet.ServletException;<br>import javax.servlet.annotation.WebServlet;<br>import javax.servlet.http.HttpServlet;<br>import javax.servlet.http.HttpServletRequest;<br>import javax.servlet.http.HttpServletResponse;<br>import java.io.IOException;</p>
<p>@WebServlet(“/deleteStudent”)<br>public class DeleteServlet extends HttpServlet {</p>
<pre><code>protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

    int id = Integer.parseInt(req.getParameter(&quot;id&quot;));
    new StudentDAO().delete(id);

    resp.sendRedirect(&quot;/listStudent&quot;);
}</code></pre><p>}</p>
<pre><code>
- **EditServlet：**
```java
package servlet;

import bean.Student;
import dao.StudentDAO;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet(&quot;/editStudent&quot;)
public class EditServlet extends HttpServlet {

    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

        int id = Integer.parseInt(req.getParameter(&quot;id&quot;));
        Student student = new StudentDAO().get(id);

        req.setAttribute(&quot;student&quot;, student);

        req.getRequestDispatcher(&quot;/editStudent.jsp&quot;).forward(req, resp);
    }
}</code></pre><ul>
<li><strong>ListServlet：</strong><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> servlet<span class="token punctuation">;</span>
</code></pre>
</li>
</ul>
<p>import bean.Student;<br>import dao.StudentDAO;<br>import util.Page;</p>
<p>import javax.servlet.ServletException;<br>import javax.servlet.annotation.WebServlet;<br>import javax.servlet.http.HttpServlet;<br>import javax.servlet.http.HttpServletRequest;<br>import javax.servlet.http.HttpServletResponse;<br>import java.io.IOException;<br>import java.util.List;</p>
<p>@WebServlet(“/listStudent”)<br>public class ListServlet extends HttpServlet {</p>
<pre><code>private StudentDAO studentDAO = new StudentDAO();

protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

    // 获取分页参数
    int start = 0;
    int count = 10;

    try {
        start = Integer.parseInt(req.getParameter(&quot;page.start&quot;));
        count = Integer.parseInt(req.getParameter(&quot;page.count&quot;));
    } catch (Exception e) {
    }

    Page page = new Page(start, count);

    List&lt;Student&gt; students = studentDAO.list(page.getStart(), page.getCount());
    int total = studentDAO.getTotal();
    page.setTotal(total);

    req.setAttribute(&quot;students&quot;, students);
    req.setAttribute(&quot;page&quot;, page);

    req.getRequestDispatcher(&quot;/listStudent.jsp&quot;).forward(req, resp);
}</code></pre><p>}</p>
<pre><code>
- **UpdateServlet：**
```java
package servlet;

import bean.Student;
import dao.StudentDAO;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;

@WebServlet(&quot;/updateStudent&quot;)
public class UpdateServlet extends HttpServlet {

    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

        Student student = new Student();

        int id = Integer.parseInt(req.getParameter(&quot;id&quot;));
        int studentID = Integer.parseInt(req.getParameter(&quot;studentID&quot;));
        String name = req.getParameter(&quot;name&quot;);
        int age = Integer.parseInt(req.getParameter(&quot;age&quot;));
        String sex = req.getParameter(&quot;radio&quot;);

        SimpleDateFormat simpleDateFormat = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);
        Date birthday = null;
        try {
            birthday = simpleDateFormat.parse(req.getParameter(&quot;birthday&quot;));
        } catch (ParseException e) {
            e.printStackTrace();
        }

        student.setId(id);
        student.setStudentID(studentID);
        student.setName(name);
        student.setAge(age);
        student.setSex(sex);
        student.setBirthday(birthday);

        new StudentDAO().update(student);

        resp.sendRedirect(&quot;/listStudent&quot;);
    }
}</code></pre><h4 id="——【3-JSP-的编写】——"><a href="#——【3-JSP-的编写】——" class="headerlink" title="——【3. JSP 的编写】——"></a>——【3. JSP 的编写】——</h4><p>我们把默认的 index.jsp 修改成如下代码：</p>
<pre class=" language-jsp"><code class="language-jsp"><%
    request.getRequestDispatcher("/listStudent").forward(request, response);
%></code></pre>
<ul>
<li>引入 JQ 和 Bootstrap<br>为了简化操作，引入了 JQuery 和 Bootstrap</li>
<li>编写 listStudent.jsp<br>其实主要还是利用 Bootstrap 编写好整个页面，我写的时候也是对照<a href="http://www.runoob.com/bootstrap/bootstrap-panels.html" target="_blank" rel="noopener">这里</a>写的</li>
</ul>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot;
         pageEncoding=&quot;UTF-8&quot; %&gt;
&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt;

&lt;html&gt;
&lt;head&gt;

    &lt;%-- 引入JQ和Bootstrap --%&gt;
    &lt;script src=&quot;js/jquery/2.0.0/jquery.min.js&quot;&gt;&lt;/script&gt;
    &lt;link href=&quot;css/bootstrap/3.3.6/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
    &lt;script src=&quot;js/bootstrap/3.3.6/bootstrap.min.js&quot;&gt;&lt;/script&gt;
    &lt;link href=&quot;css/style.css&quot; rel=&quot;stylesheet&quot;&gt;

    &lt;title&gt;学生管理页面 - 首页&lt;/title&gt;

    &lt;script&gt;
        $(function () {
            $(&quot;ul.pagination li.disabled a&quot;).click(function () {
                return false;
            });
        });
    &lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;div class=&quot;listDIV&quot;&gt;
    &lt;table class=&quot;table table-striped table-bordered table-hover table-condensed&quot;&gt;

        &lt;caption&gt;学生列表 - 共${page.total}人&lt;/caption&gt;
        &lt;thead&gt;
        &lt;tr class=&quot;success&quot;&gt;
            &lt;th&gt;学号&lt;/th&gt;
            &lt;th&gt;姓名&lt;/th&gt;
            &lt;th&gt;年龄&lt;/th&gt;
            &lt;th&gt;性别&lt;/th&gt;
            &lt;th&gt;出生日期&lt;/th&gt;

            &lt;th&gt;编辑&lt;/th&gt;
            &lt;th&gt;删除&lt;/th&gt;
        &lt;/tr&gt;
        &lt;/thead&gt;

        &lt;tbody&gt;
        &lt;c:forEach items=&quot;${students}&quot; var=&quot;s&quot; varStatus=&quot;status&quot;&gt;
            &lt;tr&gt;
                &lt;td&gt;${s.studentID}&lt;/td&gt;
                &lt;td&gt;${s.name}&lt;/td&gt;
                &lt;td&gt;${s.age}&lt;/td&gt;
                &lt;td&gt;${s.sex}&lt;/td&gt;
                &lt;td&gt;${s.birthday}&lt;/td&gt;

                &lt;td&gt;&lt;a href=&quot;/editStudent?id=${s.id}&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-edit&quot;&gt;&lt;/span&gt; &lt;/a&gt;&lt;/td&gt;
                &lt;td&gt;&lt;a href=&quot;/deleteStudent?id=${s.id}&quot;&gt;&lt;span class=&quot;glyphicon glyphicon-trash&quot;&gt;&lt;/span&gt; &lt;/a&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/c:forEach&gt;

        &lt;/tbody&gt;
    &lt;/table&gt;
&lt;/div&gt;

&lt;nav class=&quot;pageDIV&quot;&gt;
    &lt;ul class=&quot;pagination&quot;&gt;
        &lt;li &lt;c:if test=&quot;${!page.hasPreviouse}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=0&quot;&gt;
                &lt;span&gt;«&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;

        &lt;li &lt;c:if test=&quot;${!page.hasPreviouse}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=${page.start-page.count}&quot;&gt;
                &lt;span&gt;‹&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;

        &lt;c:forEach begin=&quot;0&quot; end=&quot;${page.totalPage-1}&quot; varStatus=&quot;status&quot;&gt;

            &lt;c:if test=&quot;${status.count*page.count-page.start&lt;=30 &amp;&amp; status.count*page.count-page.start&gt;=-10}&quot;&gt;
                &lt;li &lt;c:if test=&quot;${status.index*page.count==page.start}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
                    &lt;a
                            href=&quot;?page.start=${status.index*page.count}&quot;
                            &lt;c:if test=&quot;${status.index*page.count==page.start}&quot;&gt;class=&quot;current&quot;&lt;/c:if&gt;
                    &gt;${status.count}&lt;/a&gt;
                &lt;/li&gt;
            &lt;/c:if&gt;
        &lt;/c:forEach&gt;

        &lt;li &lt;c:if test=&quot;${!page.hasNext}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=${page.start+page.count}&quot;&gt;
                &lt;span&gt;›&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;
        &lt;li &lt;c:if test=&quot;${!page.hasNext}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=${page.last}&quot;&gt;
                &lt;span&gt;»&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;
    &lt;/ul&gt;
&lt;/nav&gt;

&lt;div class=&quot;addDIV&quot;&gt;

    &lt;div class=&quot;panel panel-success&quot;&gt;
        &lt;div class=&quot;panel-heading&quot;&gt;
            &lt;h3 class=&quot;panel-title&quot;&gt;增加学生&lt;/h3&gt;
        &lt;/div&gt;
        &lt;div class=&quot;panel-body&quot;&gt;

            &lt;form method=&quot;post&quot; action=&quot;/addStudent&quot; role=&quot;form&quot;&gt;
                &lt;table class=&quot;addTable&quot;&gt;
                    &lt;tr&gt;
                        &lt;td&gt;学号：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;studentID&quot; id=&quot;studentID&quot; placeholder=&quot;请在这里输入学号&quot;&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;姓名：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;name&quot; placeholder=&quot;请在这里输入名字&quot;&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;年龄：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;age&quot; id=&quot;age&quot; placeholder=&quot;请在这里输入年龄&quot;&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;性别：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;radio&quot; class=&quot;radio radio-inline&quot; name=&quot;radio&quot; value=&quot;男&quot;&gt; 男
                            &lt;input type=&quot;radio&quot; class=&quot;radio radio-inline&quot; name=&quot;radio&quot; value=&quot;女&quot;&gt; 女
                        &lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;出生日期：&lt;/td&gt;
                        &lt;td&gt;&lt;input type=&quot;date&quot; name=&quot;birthday&quot; id=&quot;birthday&quot; placeholder=&quot;请在这里输入出生日期&quot;&gt;&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr class=&quot;submitTR&quot;&gt;
                        &lt;td colspan=&quot;2&quot; align=&quot;center&quot;&gt;
                            &lt;button type=&quot;submit&quot; class=&quot;btn btn-success&quot;&gt;提 交&lt;/button&gt;
                        &lt;/td&gt;

                    &lt;/tr&gt;

                &lt;/table&gt;
            &lt;/form&gt;
        &lt;/div&gt;
    &lt;/div&gt;

&lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre><ul>
<li>eidtStudent.jsp<br>编辑表单对照着首页的增加表单稍微改一改参数就好了<pre><code>&lt;!DOCTYPE html&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot;
       pageEncoding=&quot;UTF-8&quot; %&gt;
&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;
</code></pre></li>
</ul>
<html>
<head>

<pre><code>&lt;%-- 引入JQ和Bootstrap --%&gt;
&lt;script src=&quot;js/jquery/2.0.0/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;link href=&quot;css/bootstrap/3.3.6/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;script src=&quot;js/bootstrap/3.3.6/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;link href=&quot;css/style.css&quot; rel=&quot;stylesheet&quot;&gt;

&lt;title&gt;学生管理页面 - 编辑页面&lt;/title&gt;</code></pre><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body>

<div class="editDIV">

<pre><code>&lt;div class=&quot;panel panel-success&quot;&gt;
    &lt;div class=&quot;panel-heading&quot;&gt;
        &lt;h3 class=&quot;panel-title&quot;&gt;编辑学生&lt;/h3&gt;
    &lt;/div&gt;
    &lt;div class=&quot;panel-body&quot;&gt;

        &lt;form method=&quot;post&quot; action=&quot;/updateStudent&quot; role=&quot;form&quot;&gt;
            &lt;table class=&quot;editTable&quot;&gt;
                &lt;tr&gt;
                    &lt;td&gt;学号：&lt;/td&gt;
                    &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;studentID&quot; id=&quot;studentID&quot; value=&quot;${student.studentID}&quot;
                               placeholder=&quot;请在这里输入学号&quot;&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;姓名：&lt;/td&gt;
                    &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;name&quot; value=&quot;${student.name}&quot; placeholder=&quot;请在这里输入名字&quot;&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;年龄：&lt;/td&gt;
                    &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;age&quot; id=&quot;age&quot; value=&quot;${student.age}&quot; placeholder=&quot;请在这里输入年龄&quot;&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;性别：&lt;/td&gt;
                    &lt;td&gt;&lt;input type=&quot;radio&quot; class=&quot;radio radio-inline&quot; name=&quot;radio&quot; value=&quot;男&quot;&gt; 男
                        &lt;input type=&quot;radio&quot; class=&quot;radio radio-inline&quot; name=&quot;radio&quot; value=&quot;女&quot;&gt; 女
                    &lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;
                    &lt;td&gt;出生日期：&lt;/td&gt;
                    &lt;td&gt;&lt;input type=&quot;date&quot; name=&quot;birthday&quot; id=&quot;birthday&quot; value=&quot;${student.birthday}&quot;
                               placeholder=&quot;请在这里输入出生日期&quot;&gt;&lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr class=&quot;submitTR&quot;&gt;
                    &lt;td colspan=&quot;2&quot; align=&quot;center&quot;&gt;
                        &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;${student.id}&quot;&gt;
                        &lt;button type=&quot;submit&quot; class=&quot;btn btn-success&quot;&gt;提 交&lt;/button&gt;
                    &lt;/td&gt;

                &lt;/tr&gt;

            &lt;/table&gt;
        &lt;/form&gt;
    &lt;/div&gt;
&lt;/div&gt;</code></pre></div>

</body>
</html>
```

<ul>
<li>style.css 文件：<pre><code>body {
  padding-top: 60px;
}
</code></pre></li>
</ul>
<p>div.listDIV {<br>    width: 600px;<br>    margin: 0 auto;<br>}</p>
<p>div.editDIV {<br>    width: 400px;<br>    margin: 0 auto;<br>}</p>
<p>nav.pageDIV {<br>    text-align: center;<br>}</p>
<p>div.addDIV {<br>    width: 300px;<br>    margin: 0 auto;<br>}</p>
<p>table.addTable {<br>    width: 100%;<br>    padding: 5px;<br>}</p>
<p>table.addTable td {<br>    padding: 5px;<br>}</p>
<p>table.editTable {<br>    width: 100%;<br>    padding: 5px;<br>}</p>
<p>table.editTable td {<br>    padding: 5px;<br>}</p>
<pre><code>
#### ——【4. 项目细节】——
- 项目的整理结构：
![](https://cdn.jsdelivr.net/gh/wmyskxz/img/img/初学Java-Web(9)——学生管理系统（简易版）总结/7896890-e95ffeefc9bfbeca.png)


#### 分页功能
- 首页在 Packge[util] 下创建一个 Page 工具类：
```java
package util;

public class Page {

    int start;        // 开始数据
    int count;        // 每一页的数量
    int total;        // 总共的数据量

    public Page(int start, int count) {
        super();
        this.start = start;
        this.count = count;
    }

    public boolean isHasPreviouse(){
        if(start==0)
            return false;
        return true;

    }
    public boolean isHasNext(){
        if(start==getLast())
            return false;
        return true;
    }

    public int getTotalPage(){
        int totalPage;
        // 假设总数是50，是能够被5整除的，那么就有10页
        if (0 == total % count)
            totalPage = total /count;
            // 假设总数是51，不能够被5整除的，那么就有11页
        else
            totalPage = total / count + 1;

        if(0==totalPage)
            totalPage = 1;
        return totalPage;

    }

    public int getLast(){
        int last;
        // 假设总数是50，是能够被5整除的，那么最后一页的开始就是40
        if (0 == total % count)
            last = total - count;
            // 假设总数是51，不能够被5整除的，那么最后一页的开始就是50
        else
            last = total - total % count;

        last = last&lt;0?0:last;
        return last;
    }

    // 各种 setter 和 getter
}</code></pre><ul>
<li>totalPage 是计算得来的数，用来表示页码一共的数量</li>
</ul>
<p>在首页显示的 StudentList 用 page 的参数来获取：</p>
<pre><code>List&lt;Student&gt; students = studentDAO.list(page.getStart(), page.getCount());</code></pre><p>并且在 DAO 类中用 <strong>LIMIT</strong> 关键字：</p>
<pre><code>String sql = &quot;SELECT * FROM student ORDER BY student_id desc limit ?,?&quot;;</code></pre><ul>
<li><p>第一个参数为 start，第二个参数为 count<br>这样就能根据分页的信息来获取到响应的数据</p>
</li>
<li><p><strong>编写分页栏：</strong></p>
</li>
</ul>
<p>1.写好头和尾</p>
<pre><code>&lt;nav class=&quot;pageDIV&quot;&gt;
    &lt;ul class=&quot;pagination&quot;&gt;
    .....
    &lt;/ul&gt;
&lt;/nav&gt;</code></pre><p>2.写好<code>«</code> <code>‹</code>这两个功能按钮<br>使用 <code>&lt;c:if&gt;</code>标签来增加边界判断，如果没有前面的页码了则设置为disable状态</p>
<pre><code>        &lt;li &lt;c:if test=&quot;${!page.hasPreviouse}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=0&quot;&gt;
                &lt;span&gt;«&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;

        &lt;li &lt;c:if test=&quot;${!page.hasPreviouse}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
            &lt;a href=&quot;?page.start=${page.start-page.count}&quot;&gt;
                &lt;span&gt;‹&lt;/span&gt;
            &lt;/a&gt;
        &lt;/li&gt;</code></pre><p>再通过 JavaScrip 代码来完成禁用功能：</p>
<pre><code>&lt;script&gt;
    $(function () {
        $(&quot;ul.pagination li.disabled a&quot;).click(function () {
            return false;
        });
    });
&lt;/script&gt;</code></pre><p>3.完成中间页码的编写<br>从 <code>0</code> 循环到 <code>page.totalPage - 1</code> ，<code>varStatus</code> 相当于是循环变量</p>
<ul>
<li><p>status.count 是从1开始遍历</p>
</li>
<li><p>status.index 是从0开始遍历</p>
</li>
<li><p><strong>要求：</strong>显示当前页码的前两个和后两个就可，例如当前页码为3的时候，就显示 1 2 3(当前页) 4 5 的页码</p>
</li>
<li><p><strong>理解测试条件：</strong></p>
</li>
<li><p>10 &lt;= 当前页*每一页显示的数目 - 当前页开始的数据编号 &lt;= 30<br><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%88%9D%E5%AD%A6Java-Web(9)%E2%80%94%E2%80%94%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-1f82d91e47a31c7f.png" alt=""></p>
</li>
<li><p>只要理解了这个判断条件，其他的就都好理解了</p>
<pre><code>&lt;c:forEach begin=&quot;0&quot; end=&quot;${page.totalPage-1}&quot; varStatus=&quot;status&quot;&gt;

  &lt;c:if test=&quot;${status.count*page.count-page.start&lt;=30 &amp;&amp; status.count*page.count-page.start&gt;=-10}&quot;&gt;
      &lt;li &lt;c:if test=&quot;${status.index*page.count==page.start}&quot;&gt;class=&quot;disabled&quot;&lt;/c:if&gt;&gt;
          &lt;a
                  href=&quot;?page.start=${status.index*page.count}&quot;
                  &lt;c:if test=&quot;${status.index*page.count==page.start}&quot;&gt;class=&quot;current&quot;&lt;/c:if&gt;
          &gt;${status.count}&lt;/a&gt;
      &lt;/li&gt;
  &lt;/c:if&gt;
&lt;/c:forEach&gt;</code></pre></li>
</ul>
<p>4.在 Servlet 中获取参数</p>
<pre><code>// 获取分页参数
int start = 0;
int count = 10;

try {
    start = Integer.parseInt(req.getParameter(&quot;page.start&quot;));
    count = Integer.parseInt(req.getParameter(&quot;page.count&quot;));
} catch (Exception e) {
}

....

// 共享 page 数据
req.setAttribute(&quot;page&quot;, page);</code></pre><h4 id="Date-转换的问题"><a href="#Date-转换的问题" class="headerlink" title="Date 转换的问题"></a>Date 转换的问题</h4><pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * Date类型转为指定格式的String类型
     * 
     * @param source
     * @param pattern
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">DateToString</span><span class="token punctuation">(</span>Date source<span class="token punctuation">,</span> String pattern<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        simpleDateFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> simpleDateFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * 
     * 字符串转换为对应日期
     * 
     * @param source
     * @param pattern
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> Date <span class="token function">stringToDate</span><span class="token punctuation">(</span>String source<span class="token punctuation">,</span> String pattern<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        simpleDateFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Date date <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            date <span class="token operator">=</span> simpleDateFormat<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> date<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<h2 id="项目总结"><a href="#项目总结" class="headerlink" title="项目总结"></a>项目总结</h2><p>这一个项目实在有些太简单了，可能最需要理解的一个功能就属于<strong>【分页功能】</strong>了吧</p>
<p>不过还是借助这个项目，进一步巩固了 J2EE 开发的相关知识，也对开发的流程愈发熟悉，整个项目编写时间不超过 8 个小时，对于我自己来说，不算快，但还算比较顺畅的</p>
<h4 id="需要改进的地方："><a href="#需要改进的地方：" class="headerlink" title="需要改进的地方："></a>需要改进的地方：</h4><ol>
<li><p>登录验证<br>本项目没有增加登录验证，可以增加一个登录页面并结合 session 来完成验证</p>
</li>
<li><p>代码重构<br>本项目仅仅完成的是一个学生表的增删改查，却有以下的五个 Servlet ：</p>
</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E5%88%9D%E5%AD%A6Java-Web(9)%E2%80%94%E2%80%94%E5%AD%A6%E7%94%9F%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%88%E7%AE%80%E6%98%93%E7%89%88%EF%BC%89%E6%80%BB%E7%BB%93/7896890-83b087dbf84970dd.png" alt=""></p>
<p>如果项目大起来，那可想而知，Servlet 有多臃肿，维护成本有多高</p>
<ul>
<li><strong>改进方法：</strong>用一个 StudentServlet 代替</li>
<li><strong>具体做法：</strong>使用 <strong>Filter + Servlet</strong> 完成<blockquote>
<p>① 首先编写一个<strong>过滤所有地址的 Filter</strong>，并<strong>解析地址栏的地址</strong>，<strong>提取出其中的方法</strong>传递给 <strong>StudentServlet</strong> <em>（这个时候需要统一的地址，如：<code>student_list</code>、<code>student_edit</code>、<code>student_delete</code>、<code>student_update</code>）</em></p>
</blockquote>
<pre><code>request.setAttribute(&quot;method&quot;, method);</code></pre><blockquote>
<p>② 在 Servlet 中获取 method 方法，并调用</p>
</blockquote>
<pre><code>// 获取到对应的方法
String method = (String) request.getAttribute(&quot;method&quot;);
// 对 method 作判断，调用对应的方法</code></pre></li>
</ul>
<ol start="3">
<li>没有对输入的数据的正确性进行验证<br>这显然会导致许多问题，可以通过 js 代码来完成验证</li>
</ol>
<hr>
<blockquote>
<p>欢迎转载，转载请注明出处！<br>简书ID：<a href="https://www.jianshu.com/u/a40d61a49221" target="_blank" rel="noopener">@我没有三颗心脏</a><br>github：<a href="https://github.com/wmyskxz/" target="_blank" rel="noopener">wmyskxz</a><br>欢迎关注公众微信号：wmyskxz<br>分享自己的学习 &amp; 学习资料 &amp; 生活<br>想要交流的朋友也可以加qq群：3382693</p>
</blockquote>

      
    </div>
    
      
    
  </section>
</article>

          </div>
        
      
    
  </section>
  
    
      <br>
      <div class="prev-next">
        
          <a class="prev" rel="prev" href="/tags/%E9%A1%B9%E7%9B%AE/">
            <section class="post prev white-box shadow" >
              <i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一页&nbsp;
            </section>
          </a>
        
        <p class="current">
          2 / 2
        </p>
        
      </div>
    
    <!-- 根据主题中的设置决定是否在archive中针对摘要部分的MathJax公式加载mathjax.js文件 -->
    
    

  


    
  
</div>
<aside class='l_side'>
  
  
    
    

<section class="widget blogger shadow desktop mobile">
  <div class='content'>
    
      
        <a class='avatar flat-box rectangle' href='/about/'>
          <img no-lazy src='https://cdn.jsdelivr.net/gh/wmyskxz/img/img/common/avatar.png'/>
        </a>
      
    
    
      <div class='text'>
        
        
          <p>想做一个自由且自律的人，靠势必实现的决心认真地或者</p>

        
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="/atom.xml"
              class="social fas fa-rss flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="mailto:me@xxx.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://github.com/volantis-x/"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=260045301"
              class="social fas fa-headphones-alt flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

  

  
    
    
  

  <section class="widget category shadow desktop">
    
  <header>
    
      <a href='/blog/categories/'><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i><span class='name'>文章分类</span></a>
    
  </header>


    <div class='content'>
      <ul class="entry navigation">
        
          <li><a class="flat-box"
            title="/categories/Java-Web/" href="/categories/Java-Web/"
            id="categoriesJava-Web"
            ><div class='name'>Java Web</div><div class='badge'>(6)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Java-Web/Spring/" href="/categories/Java-Web/Spring/"
            id="categoriesJava-WebSpring"
            ><div class='name'>Spring</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Java-Web/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" href="/categories/Java-Web/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
            id="categoriesJava-WebE5ADA6E4B9A0E7AC94E8AEB0"
            ><div class='name'>学习笔记</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/"
            id="categoriesJavaWebE59FBAE7A180"
            ><div class='name'>JavaWeb基础</div><div class='badge'>(23)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SSM/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SSM/"
            id="categoriesJavaWebE59FBAE7A180SSM"
            ><div class='name'>SSM</div><div class='badge'>(5)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SSM/%E9%A1%B9%E7%9B%AE/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SSM/%E9%A1%B9%E7%9B%AE/"
            id="categoriesJavaWebE59FBAE7A180SSME9A1B9E79BAE"
            ><div class='name'>项目</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/Spring-MVC/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/Spring-MVC/"
            id="categoriesJavaWebE59FBAE7A180Spring-MVC"
            ><div class='name'>Spring MVC</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/Spring/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/Spring/"
            id="categoriesJavaWebE59FBAE7A180Spring"
            ><div class='name'>Spring</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SpringBoot/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SpringBoot/"
            id="categoriesJavaWebE59FBAE7A180SpringBoot"
            ><div class='name'>SpringBoot</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/%E9%A1%B9%E7%9B%AE/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/%E9%A1%B9%E7%9B%AE/"
            id="categoriesJavaWebE59FBAE7A180E9A1B9E79BAE"
            ><div class='name'>项目</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/"
            id="categoriesJavaWebE8BF9BE998B6"
            ><div class='name'>JavaWeb进阶</div><div class='badge'>(14)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/Spring-Boot/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/Spring-Boot/"
            id="categoriesJavaWebE8BF9BE998B6Spring-Boot"
            ><div class='name'>Spring Boot</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/Spring-Boot/%E9%A1%B9%E7%9B%AE/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/Spring-Boot/%E9%A1%B9%E7%9B%AE/"
            id="categoriesJavaWebE8BF9BE998B6Spring-BootE9A1B9E79BAE"
            ><div class='name'>项目</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E4%B8%AD%E9%97%B4%E4%BB%B6/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E4%B8%AD%E9%97%B4%E4%BB%B6/"
            id="categoriesJavaWebE8BF9BE998B6E4B8ADE997B4E4BBB6"
            ><div class='name'>中间件</div><div class='badge'>(5)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF/"
            id="categoriesJavaWebE8BF9BE998B6E5898DE7ABAF"
            ><div class='name'>前端</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF/Spring-Boot/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF/Spring-Boot/"
            id="categoriesJavaWebE8BF9BE998B6E5898DE7ABAFSpring-Boot"
            ><div class='name'>Spring Boot</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"
            id="categoriesJavaWebE8BF9BE998B6E5BEAEE69C8DE58AA1"
            ><div class='name'>微服务</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF/"
            id="categoriesJavaWebE8BF9BE998B6E69EB6E69E84E4B98BE8B7AF"
            ><div class='name'>架构之路</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E9%A1%B9%E7%9B%AE/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E9%A1%B9%E7%9B%AE/"
            id="categoriesJavaWebE8BF9BE998B6E9A1B9E79BAE"
            ><div class='name'>项目</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E9%A1%B9%E7%9B%AE/Spring-Boot/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E9%A1%B9%E7%9B%AE/Spring-Boot/"
            id="categoriesJavaWebE8BF9BE998B6E9A1B9E79BAESpring-Boot"
            ><div class='name'>Spring Boot</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/Java%E5%9F%BA%E7%A1%80/" href="/categories/Java%E5%9F%BA%E7%A1%80/"
            id="categoriesJavaE59FBAE7A180"
            ><div class='name'>Java基础</div><div class='badge'>(15)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Java%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" href="/categories/Java%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"
            id="categoriesJavaE59FBAE7A180E5B9B6E58F91E7BC96E7A88B"
            ><div class='name'>并发编程</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Java%E5%9F%BA%E7%A1%80/%E9%9D%A2%E8%AF%95/" href="/categories/Java%E5%9F%BA%E7%A1%80/%E9%9D%A2%E8%AF%95/"
            id="categoriesJavaE59FBAE7A180E99DA2E8AF95"
            ><div class='name'>面试</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/MoreThanJava/" href="/categories/MoreThanJava/"
            id="categoriesMoreThanJava"
            ><div class='name'>MoreThanJava</div><div class='badge'>(14)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/MoreThanJava/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" href="/categories/MoreThanJava/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"
            id="categoriesMoreThanJavaE5A49AE7BABFE7A88B"
            ><div class='name'>多线程</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/MoreThanJava/%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98/" href="/categories/MoreThanJava/%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98/"
            id="categoriesMoreThanJavaE79FA5E4B98EE997AEE9A298"
            ><div class='name'>知乎问题</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/Python/" href="/categories/Python/"
            id="categoriesPython"
            ><div class='name'>Python</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Python/%E6%87%82%E4%B8%80%E7%82%B9%E7%B3%BB%E5%88%97/" href="/categories/Python/%E6%87%82%E4%B8%80%E7%82%B9%E7%B3%BB%E5%88%97/"
            id="categoriesPythonE68782E4B880E782B9E7B3BBE58897"
            ><div class='name'>懂一点系列</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/Redis/" href="/categories/Redis/"
            id="categoriesRedis"
            ><div class='name'>Redis</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Redis/%E4%B8%AD%E9%97%B4%E4%BB%B6/" href="/categories/Redis/%E4%B8%AD%E9%97%B4%E4%BB%B6/"
            id="categoriesRedisE4B8ADE997B4E4BBB6"
            ><div class='name'>中间件</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/Ruby/" href="/categories/Ruby/"
            id="categoriesRuby"
            ><div class='name'>Ruby</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/Spring-Cloud/" href="/categories/Spring-Cloud/"
            id="categoriesSpring-Cloud"
            ><div class='name'>Spring Cloud</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"
            id="categoriesE4B8ADE997B4E4BBB6"
            ><div class='name'>中间件</div><div class='badge'>(7)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/JavaWeb%E8%BF%9B%E9%98%B6/" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/JavaWeb%E8%BF%9B%E9%98%B6/"
            id="categoriesE4B8ADE997B4E4BBB6JavaWebE8BF9BE998B6"
            ><div class='name'>JavaWeb进阶</div><div class='badge'>(7)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%85%AC%E4%BC%97%E5%8F%B7%EF%BC%9Awmyskxz/" href="/categories/%E5%85%AC%E4%BC%97%E5%8F%B7%EF%BC%9Awmyskxz/"
            id="categoriesE585ACE4BC97E58FB7EFBC9Awmyskxz"
            ><div class='name'>公众号：wmyskxz</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%89%8D%E7%AB%AF/" href="/categories/%E5%89%8D%E7%AB%AF/"
            id="categoriesE5898DE7ABAF"
            ><div class='name'>前端</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E5%89%8D%E7%AB%AF/%E6%87%82%E4%B8%80%E7%82%B9%E7%B3%BB%E5%88%97/" href="/categories/%E5%89%8D%E7%AB%AF/%E6%87%82%E4%B8%80%E7%82%B9%E7%B3%BB%E5%88%97/"
            id="categoriesE5898DE7ABAFE68782E4B880E782B9E7B3BBE58897"
            ><div class='name'>懂一点系列</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%96%9C%E6%AC%A2%E7%9A%84%E4%B8%89%E8%A7%82/" href="/categories/%E5%96%9C%E6%AC%A2%E7%9A%84%E4%B8%89%E8%A7%82/"
            id="categoriesE5969CE6ACA2E79A84E4B889E8A782"
            ><div class='name'>喜欢的三观</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" href="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"
            id="categoriesE5A49AE7BABFE7A88B"
            ><div class='name'>多线程</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%A5%BD%E5%A5%87%E6%98%9F%E4%BA%BA/" href="/categories/%E5%A5%BD%E5%A5%87%E6%98%9F%E4%BA%BA/"
            id="categoriesE5A5BDE5A587E6989FE4BABA"
            ><div class='name'>好奇星人</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
            id="categoriesE5ADA6E4B9A0E7AC94E8AEB0"
            ><div class='name'>学习笔记</div><div class='badge'>(6)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Java%E8%BF%9B%E9%98%B6/" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Java%E8%BF%9B%E9%98%B6/"
            id="categoriesE5ADA6E4B9A0E7AC94E8AEB0JavaE8BF9BE998B6"
            ><div class='name'>Java进阶</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"
            id="categoriesE695B0E68DAEE7BB93E69E84E4B88EE7AE97E6B395"
            ><div class='name'>数据结构与算法</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E9%9D%A2%E8%AF%95/" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E9%9D%A2%E8%AF%95/"
            id="categoriesE695B0E68DAEE7BB93E69E84E4B88EE7AE97E6B395E99DA2E8AF95"
            ><div class='name'>面试</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E6%9C%89%E8%B6%A3%E9%9B%86%E4%B8%AD%E8%90%A5/" href="/categories/%E6%9C%89%E8%B6%A3%E9%9B%86%E4%B8%AD%E8%90%A5/"
            id="categoriesE69C89E8B6A3E99B86E4B8ADE890A5"
            ><div class='name'>有趣集中营</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF/" href="/categories/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF/"
            id="categoriesE69EB6E69E84E4B98BE8B7AF"
            ><div class='name'>架构之路</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E7%94%9F%E6%B4%BB/" href="/categories/%E7%94%9F%E6%B4%BB/"
            id="categoriesE7949FE6B4BB"
            ><div class='name'>生活</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E7%BC%96%E7%A8%8B%E4%BA%BA%E7%94%9F/" href="/categories/%E7%BC%96%E7%A8%8B%E4%BA%BA%E7%94%9F/"
            id="categoriesE7BC96E7A88BE4BABAE7949F"
            ><div class='name'>编程人生</div><div class='badge'>(5)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E7%BC%96%E7%A8%8B%E4%BA%BA%E7%94%9F/%E9%9D%A2%E8%AF%95/" href="/categories/%E7%BC%96%E7%A8%8B%E4%BA%BA%E7%94%9F/%E9%9D%A2%E8%AF%95/"
            id="categoriesE7BC96E7A88BE4BABAE7949FE99DA2E8AF95"
            ><div class='name'>面试</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E9%9D%A2%E8%AF%95/" href="/categories/%E9%9D%A2%E8%AF%95/"
            id="categoriesE99DA2E8AF95"
            ><div class='name'>面试</div><div class='badge'>(8)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E9%9D%A2%E8%AF%95/%E4%B8%AD%E9%97%B4%E4%BB%B6/" href="/categories/%E9%9D%A2%E8%AF%95/%E4%B8%AD%E9%97%B4%E4%BB%B6/"
            id="categoriesE99DA2E8AF95E4B8ADE997B4E4BBB6"
            ><div class='name'>中间件</div><div class='badge'>(1)</div></a></li>
        
      </ul>
    </div>
  </section>


  

  
    
    
  

  <section class="widget tagcloud shadow desktop mobile">
    
  <header>
    
      <a href='/blog/tags/'><i class="fas fa-tags fa-fw" aria-hidden="true"></i><span class='name'>热门标签</span></a>
    
  </header>


    <div class='content'>
      <a href="/tags/Docker/" style="font-size: 14px; color: #999">Docker</a> <a href="/tags/Elasticsearch/" style="font-size: 14px; color: #999">Elasticsearch</a> <a href="/tags/Java-Web/" style="font-size: 16.86px; color: #868686">Java Web</a> <a href="/tags/Java8/" style="font-size: 14px; color: #999">Java8</a> <a href="/tags/JavaWeb%E5%9F%BA%E7%A1%80/" style="font-size: 23.29px; color: #5a5a5a">JavaWeb基础</a> <a href="/tags/JavaWeb%E8%BF%9B%E9%98%B6/" style="font-size: 22.57px; color: #5f5f5f">JavaWeb进阶</a> <a href="/tags/Java%E5%9F%BA%E7%A1%80/" style="font-size: 21.86px; color: #646464">Java基础</a> <a href="/tags/Kafka/" style="font-size: 14px; color: #999">Kafka</a> <a href="/tags/MongoDB/" style="font-size: 14px; color: #999">MongoDB</a> <a href="/tags/MoreThanJava/" style="font-size: 20.43px; color: #6d6d6d">MoreThanJava</a> <a href="/tags/MyBatis/" style="font-size: 15.43px; color: #8f8f8f">MyBatis</a> <a href="/tags/Python/" style="font-size: 14px; color: #999">Python</a> <a href="/tags/React/" style="font-size: 14px; color: #999">React</a> <a href="/tags/Redis/" style="font-size: 19.71px; color: #727272">Redis</a> <a href="/tags/Ruby/" style="font-size: 14.71px; color: #949494">Ruby</a> <a href="/tags/SSM/" style="font-size: 16.86px; color: #868686">SSM</a> <a href="/tags/Shiro/" style="font-size: 14px; color: #999">Shiro</a> <a href="/tags/Spring/" style="font-size: 17.57px; color: #818181">Spring</a> <a href="/tags/Spring-Boot/" style="font-size: 17.57px; color: #818181">Spring Boot</a> <a href="/tags/Spring-Cloud/" style="font-size: 14px; color: #999">Spring Cloud</a> <a href="/tags/Spring-MVC/" style="font-size: 14px; color: #999">Spring MVC</a> <a href="/tags/Vue/" style="font-size: 14px; color: #999">Vue</a> <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" style="font-size: 21.14px; color: #686868">中间件</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/" style="font-size: 14.71px; color: #949494">代码规范</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 15.43px; color: #8f8f8f">前端</a> <a href="/tags/%E5%8E%9F%E5%88%9B/" style="font-size: 24px; color: #555">原创</a> <a href="/tags/%E5%96%9C%E6%AC%A2%E7%9A%84%E4%B8%89%E8%A7%82/" style="font-size: 16.14px; color: #8a8a8a">喜欢的三观</a> <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 14.71px; color: #949494">多线程</a> <a href="/tags/%E5%A5%BD%E5%A5%87%E6%98%9F%E4%BA%BA/" style="font-size: 15.43px; color: #8f8f8f">好奇星人</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 17.57px; color: #818181">学习笔记</a> <a href="/tags/%E5%AF%BC%E8%88%AA/" style="font-size: 14px; color: #999">导航</a> <a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size: 14.71px; color: #949494">并发编程</a> <a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 14px; color: #999">微服务</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 18.29px; color: #7c7c7c">总结</a> <a href="/tags/%E6%87%82%E4%B8%80%E7%82%B9%E7%B3%BB%E5%88%97/" style="font-size: 14.71px; color: #949494">懂一点系列</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" style="font-size: 16.14px; color: #8a8a8a">数据结构与算法</a> <a href="/tags/%E6%9C%89%E8%B6%A3%E9%9B%86%E4%B8%AD%E8%90%A5/" style="font-size: 14px; color: #999">有趣集中营</a> <a href="/tags/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF/" style="font-size: 14px; color: #999">架构之路</a> <a href="/tags/%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98/" style="font-size: 14px; color: #999">知乎问题</a> <a href="/tags/%E7%BC%96%E7%A8%8B%E4%BA%BA%E7%94%9F/" style="font-size: 16.86px; color: #868686">编程人生</a> <a href="/tags/%E7%BF%BB%E8%AF%91/" style="font-size: 14px; color: #999">翻译</a> <a href="/tags/%E7%BF%BB%E8%AF%91%E6%96%87/" style="font-size: 14px; color: #999">翻译文</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 21.14px; color: #686868">面试</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 19px; color: #777">项目</a> <a href="/tags/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/" style="font-size: 14px; color: #999">领域驱动设计</a>
    </div>
  </section>


  

  


</aside>


    </div>
    
  
  <footer class="clearfix">
    <br><br>
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/atom.xml"
                class="social fas fa-rss flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="mailto:me@xxx.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/volantis-x/"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://music.163.com/#/user/home?id=260045301"
                class="social fas fa-headphones-alt flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        本站使用
        <a href="https://github.com/volantis-x/hexo-theme-volantis/" target="_blank" class="codename">Volantis</a>
        作为主题，总访问量为
          <span id="busuanzi_value_site_pv"><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden="true"></i></span>
          次
        
      
    
      
        <div class='copyright'>
        <p><a href="/">Copyright © 2017-2020 XXX</a></p>

        </div>
      
    
  </footer>


    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <div>
    
      
  

  <div id="rightmenu-wrapper">
    <ul class="list-v rightmenu" id="rightmenu-content">
      <li class='option'>
        <a class='vlts-menu opt fix-cursor-default' id='menu-copy-text' onclick='document.execCommand("copy")'><i class='fa fa-copy fa-fw'></i>复制文本</a>
        <hr id='hr-text'>
        <a class='vlts-menu opt fix-cursor-default' id='menu-copy-href'><i class='fa fa-link fa-fw'></i>复制链接</a>
        <a class='vlts-menu opt fix-cursor-default' id='menu-open-href'><i class='fa fa-external-link-square-alt fa-fw'></i>在新标签页打开</a>
        <hr id='hr-href'>
        <a class='vlts-menu opt fix-cursor-default' id='menu-copy-src'><i class='fa fa-image fa-fw'></i>复制图片地址</a>
        <hr id='hr-src'>
      </li>
      <li class='navigation'>
        <a class='nav icon-only fix-cursor-default' onclick='history.back()'><i class='fa fa-arrow-left fa-fw'></i></a>
        <a class='nav icon-only fix-cursor-default' onclick='history.forward()'><i class='fa fa-arrow-right fa-fw'></i></a>
        <a class='nav icon-only fix-cursor-default' onclick='window.location.reload()'><i class='fa fa-redo fa-fw'></i></a>
        <a class='nav icon-only fix-cursor-default' href='/'><i class='fa fa-home fa-fw'></i></a>
      </li>
      <hr>
      
        
      
        
      
        
          <hr>
        
      
        
          
    <li>
      <a class='vlts-menu fix-cursor-default' href=https://github.com/volantis-x/volantis-docs/
        
        
        
        
          id="https:githubcomvolantis-xvolantis-docs"
        >
        <i class='fa fa-code-branch fa-fw'></i> 本站源码
      </a>
    </li>
  
        
      
        
          
    <li>
      <a class='vlts-menu fix-cursor-default' href=https://github.com/volantis-x/hexo-theme-volantis/
        
        
        
        
          id="https:githubcomvolantis-xhexo-theme-volantis"
        >
        <i class='fa fa-code-branch fa-fw'></i> 主题源码
      </a>
    </li>
  
        
      
        
          <hr>
        
      
        
          
    <li>
      <a class='vlts-menu fix-cursor-default' 
        
        
        
          onclick="document.execCommand('print')"
        
        >
        <i class='fa fa-print fa-fw'></i> 打印页面
      </a>
    </li>
  
        
      
        
          <hr>
        
      
        
          <li class='music name'>
            <p class='nav music-title fix-cursor-default'></p>
          </li>
          <li class='music ctrl'>
            <a class='nav icon-only backward fix-cursor-default' onclick='aplayerBackward()'><i class='fa fa-step-backward fa-fw'></i></a>
            <a class='nav icon-only toggle fix-cursor-default' onclick='aplayerToggle()'><i class='fa fa-play fa-fw'></i></a>
            <a class='nav icon-only forward fix-cursor-default' onclick='aplayerForward()'><i class='fa fa-step-forward fa-fw'></i></a>
          </li>
          <li class='music volume'>
            <a class='nav volume'>
              <div class="aplayer-volume-bar-wrap">
                <div class="aplayer-volume-bar fix-cursor-pointer">
                  <div class="aplayer-volume"></div>
                  <i class='left fa fa-volume-off fa-fw'></i>
                  <i class='right fa fa-volume-up fa-fw'></i>
                </div>
              </div>
            </a>
          </li>
        
      
    </ul>
  </div>

  <script>
    window.document.oncontextmenu = function (event) {
      if (event.ctrlKey) return true;
      if (/Android|webOS|BlackBerry/i.test(navigator.userAgent)) return true;
      return popMenu(event);
    };
    document.addEventListener("click", function (event) {
      var mymenu = document.getElementById('rightmenu-wrapper');
      mymenu.style.display = "none";
    });
    function popMenu(event) {
      var mymenu = document.getElementById('rightmenu-wrapper');
      var menuContent = document.getElementById('rightmenu-content');
      var screenWidth = document.documentElement.clientWidth || document.body.clientWidth;
      var screenHeight = document.documentElement.clientHeight || document.body.clientHeight;
      mymenu.style.left = event.clientX + "px"; // 获取鼠标位置
      mymenu.style.top = event.clientY + "px";
      mymenu.style.display = 'block';
      if (event.clientX * 2 > screenWidth) {
        menuContent.classList.add('left');
      } else {
        menuContent.classList.remove('left');
      }
      if (event.clientY * 2 > screenHeight) {
        menuContent.classList.add('top');
      } else {
        menuContent.classList.remove('top');
      }

      let hrText = document.getElementById('hr-text');
      let hrSrc = document.getElementById('hr-src');
      let hrHref = document.getElementById('hr-href');

      // 选中图片
      let copySrc = document.getElementById('menu-copy-src');
      if (copySrc != undefined) {
        if (event.target.currentSrc) {
          copySrc.style.display = 'block';
          copySrc.addEventListener("click", function (e) {
            copyString(event.target.currentSrc);
          },{once: true});
          hrSrc.style.display = 'block';
        } else {
          copySrc.style.display = 'none';
          hrSrc.style.display = 'none';
        }
      }

      // 选中按钮
      // 判断是不是按钮
      let href = '';
      if (event.path) {
        for (i = 0; i < event.path.length; i++) {
          if (event.path[i].href != undefined && event.path[i].href.length > 0) {
            href = event.path[i].href;
          }
        }
      }

      let copyText = document.getElementById('menu-copy-text');
      copyText.style.display = 'none';
      hrText.style.display = 'none';
      if (href.length == 0) {
        // 选中文本
        if (window.getSelection().toString()) {
          copyText.style.display = 'block';
          hrText.style.display = 'block';
        }
      }

      // 在新标签页打开
      let openHref = document.getElementById('menu-open-href');
      if (openHref != undefined) {
        if (href.length > 0) {
          openHref.style.display = 'block';
          openHref.addEventListener("click", function (e) {
            window.open(href);
          },{once: true});
          hrHref.style.display = 'block';
        } else {
          openHref.style.display = 'none';
          hrHref.style.display = 'none';
        }
      }
      // 复制链接
      let copyHref = document.getElementById('menu-copy-href');
      if (copyHref != undefined) {
        if (href.length > 0) {
          copyHref.style.display = 'block';
          copyHref.addEventListener("click", function (e) {
            copyString(href);
          },{once: true});
        } else {
          copyHref.style.display = 'none';
        }
      }

      // 有音乐播放器
      if (true == true) {
        // 如果有aplayer，初始化一下
      	try {
      		checkAPlayer();
          updateTitle();
      	} catch (error) {
      		console.log(error);
      	}
      }

      return false; // 该行代码确保系统自带的右键菜单不会被调出
    }
    function hideMenu() {
      document.getElementById('rightmenu-wrapper').style.display = 'none';
    }
    function copyString(str) {
      const input = document.createElement('input');
      input.setAttribute('readonly', 'readonly');
      document.body.appendChild(input);
      input.setAttribute('value', str);
      input.select();
      document.execCommand('copy');
      document.body.removeChild(input);
    }
    document.execCommand('click');
  </script>


    
    
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5/dist/jquery.min.js"></script>



  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>



  <script async src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/001.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/002.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/003.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/004.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/005.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/006.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/012.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/016.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/019.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/033.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/034.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/035.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/038.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/039.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/042.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/046.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/051.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/052.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/054.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/056.jpg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('.cover') {
          $('.cover').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  



  <script>
    let APlayerController = new Object();
    APlayerController.id = '3175833810';  // 设定全局音乐播放ID
    APlayerController.volume = '0.7';
  </script>
  
    
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>

  
    
<script src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js"></script>

  
    
<script src="/js/aplayer.js"></script>

  




  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script type="text/javascript">
  function pjax_gitalk() {
    let pageUrl = $.trim($('#pjax-comment-path').text()) === "none" ? 
      decodeURI(window.location.pathname) : $.trim($('#pjax-comment-path').text());
    
    let ALLPATH = '';
    if(ALLPATH != '') pageUrl = ALLPATH;

    if (document.getElementById('gitalk-container') != null) {
      var gitalk = new Gitalk({
        clientID: "a9f57bed080703426741",
        clientSecret: "03fe7aec06a7794dedfcc123b6475f0231f6a0ce",
        repo: "wmyskxz.github.io",
        owner: "wmyskxz",
        admin: "wmyskxz",
        id: pageUrl,
        distractionFreeMode: false  // Facebook-like distraction free mode
      });
      gitalk.render('gitalk-container');
    }
  }

  $(function () {
    pjax_gitalk();
  });
</script>




<!-- darkmodejs -->


<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
    var clipboard = new ClipboardJS('.btn-copy', {
        target: function (trigger) {
            return trigger.nextElementSibling
        }
    });
    function wait(callback, seconds) {
        var timelag = null;
        timelag = window.setTimeout(callback, seconds)
    }
    function pjax_initCopyCode() {
        var copyHtml = '';
        copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
        copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
        copyHtml += '</button>';
        $(".highlight .code pre").before(copyHtml);
        $(".article pre code").before(copyHtml);
        clipboard.off('success').on('success', function (e) {
            let $btn = $(e.trigger);
            $btn.addClass('copied');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-check-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPIED';
            wait(function () {
                $icon.removeClass('fa-check-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        });
        clipboard.off('error').on('error', function (e) {
            e.clearSelection();
            let $btn = $(e.trigger);
            $btn.addClass('copy-failed');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-times-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPY FAILED';
            wait(function () {
                $icon.removeClass('fa-times-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        })
    }
    $(function () {
        pjax_initCopyCode()
    });
</script>


<!-- scrollreveal -->

  <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    function pjax_scrollrebeal() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '32px',
        duration: '800',
        interval: '20',
        scale: '1',
        easing: 'ease-out'
      });
    }

    $(function () {
      pjax_scrollrebeal();
    });
  </script>

<!-- ******************************** -->

<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  function pjax_fancybox() {
    $(".article-entry").find("img").not('.inline').not('a img').each(function () { //渲染 fancybox
      var element = document.createElement("a"); // a 标签
      $(element).attr("class", "fancybox");
      $(element).attr("pjax-fancybox", "");  // 过滤 pjax
      $(element).attr("href", $(this).attr("src"));
      if ($(this).attr("data-original")) {
        $(element).attr("href", $(this).attr("data-original"));
      }
      $(element).attr("data-fancybox", "images");
      var caption = "";   // 描述信息
      if ($(this).attr('alt')) {  // 判断当前页面是否存在描述信息
        $(element).attr('data-caption', $(this).attr('alt'));
        caption = $(this).attr('alt');
      }
      var div = document.createElement("div");
      $(div).addClass("fancybox");
      $(this).wrap(div); // 最外层套 div ，其实主要作用还是 class 样式
      var span = document.createElement("span");
      $(span).addClass("image-caption");
      $(span).text(caption); // 加描述
      $(this).after(span);  // 再套一层描述
      $(this).wrap(element);  // 最后套 a 标签
    })
    $(".article-entry").find("img").fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
      closeClick: true,
      helpers: {
        overlay: {closeClick: true}
      },
      buttons: [
        "zoom",
        "close"
      ]
    });
  };
  $(function () {
    pjax_fancybox();
  });
</script>

<!-- ******************************** -->


  
<script src="/js/app.js"></script>




  
    
<script src="/js/search.js"></script>

  



  <script defer src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js" data-pjax></script>



  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function () {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>





  
    
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
  




    
      


<script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script>

<!-- 样式位于：source/css/_third-party/pjaxanimate.styl -->

<div class="pjax-animate">
  
    <script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>
    <div id="loading-bar-wrapper"><script>NProgress.configure({parent:"#loading-bar-wrapper",trickleSpeed: 100})</script></div>
    <script>
      window.ShowLoading = function() {
        NProgress.start();
      };
      window.HideLoading = function() {
        NProgress.done();
      }
    </script>
  
</div>

<script>
    var pjax;
    document.addEventListener('DOMContentLoaded', function () {
      pjax = new Pjax({
        elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([pjax-fancybox])',
        selectors: [
          "title",
          "#pjax-container",
          "#pjax-header-nav-list"
        ],
        cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
        timeout: 5000
      });
    });

    document.addEventListener('pjax:send', function (e) {
      window.stop(); // 相当于点击了浏览器的停止按钮

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      window.subData = null; // 移除标题（用于一二级导航栏切换处）
      $.fancybox.close();    // 关闭弹窗
      $('.l_header .switcher .s-search').removeClass('active'); // 关闭移动端激活的搜索框
      $('.l_header').removeClass('z_search-open'); // 关闭移动端激活的搜索框
      $('.wrapper').removeClass('sub'); // 跳转页面时关闭二级导航

      // 解绑事件 避免重复监听
      $('.s-top').unbind('click');
      $('.menu a').unbind('click');
      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');
      window.ShowLoading();
    });

    document.addEventListener('pjax:complete', function () {
      // 关于百度统计对 SPA 页面的处理：
      // 方案一：百度统计>管理>单页应用设置中，打开开启按钮即可对SPA进行统计。 https://tongji.baidu.com/web/help/article?id=324
      // 方案二：取消注释下列代码。 https://tongji.baidu.com/web/help/article?id=235
      // 

      // 关于谷歌统计对 SPA 页面的处理：
      // 当应用以动态方式加载内容并更新地址栏中的网址时，也应该更新通过 gtag.js 存储的网页网址。
      // https://developers.google.cn/analytics/devguides/collection/gtagjs/single-page-applications?hl=zh-cn
      

      $('.nav-main').find('.list-v').not('.menu-phone').removeAttr("style",""); // 移除小尾巴的移除
      $('.menu-phone.list-v').removeAttr("style",""); // 移除小尾巴的移除
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });

      try{
        pjax_fancybox();
        
          
          if ('.cover') {
            $('.cover').backstretch("resize");
          } else {
            $.backstretch("resize");
          }
        
        
        document.querySelectorAll('pre code').forEach((block) => {
          hljs.highlightBlock(block);
        });
        
        
          pjax_scrollrebeal();
        
        
          pjax_initCopyCode();
        
        
        
        
          pjax_gitalk();
        
        
        
      } catch (e) {
        console.log(e);
      }
      window.HideLoading();
    });

    document.addEventListener('pjax:error', function (e) {
      window.HideLoading();
      window.location.href = e.triggerElement.href;
    });
</script>

    
  </div>
</body>
</html>
