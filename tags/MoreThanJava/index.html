<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#3.0.0-rc.1'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
      <meta name="robots" content="noindex,follow">
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
  <title>标签：MoreThanJava - 我没有三颗心脏的博客</title>
  

  

  <!-- feed -->
  

  <!-- import meta -->
  

  <!-- link -->
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  

  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
  

  

  <!-- import link -->
  

  
    
      
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.18.1/styles/solarized-light.css">

    
  
  
    
<link rel="stylesheet" href="/css/style.css">

  

  
  
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body>
  
  
  
  <div class="cover-wrapper">
    <cover class='cover ' style="display: none;">
      <div class='cover-body'>
  <div class='a'>
    
    
      <p class="title">我没有三颗心脏</p>
    
    
      <p class="subtitle">分享知识&技术&成长&思考</p>
    
  </div>
  <div class='b'>
    
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <input type="text" class="input u-search-input" placeholder="search here..." />
          <i class="icon fas fa-search fa-fw"></i>
        </form>
      </div>
    
    <div class='menu navigation search'>
      <div class='list-h'>
        
          
            <a href="/"
              
              
              id="home">
              <i class='fas fa-rss fa-fw'></i><p>博客</p>
            </a>
          
            <a href="/categories/"
              
              
              id="categories">
              <i class='fas fa-folder-open fa-fw'></i><p>分类</p>
            </a>
          
            <a href="/tags/"
              
              
              id="tags">
              <i class='fas fa-tags fa-fw'></i><p>标签</p>
            </a>
          
            <a href="/archives/"
              
              
              id="archives">
              <i class='fas fa-archive fa-fw'></i><p>归档</p>
            </a>
          
            <a href="/about/"
              
              
              id="about">
              <i class='fas fa-info-circle fa-fw'></i><p>关于</p>
            </a>
          
        
      </div>
    </div>
  </div>
</div>

      <div class="scroll-down" style="display: none;"><i class="fa fa-chevron-down scroll-down-effects"></i></div>
    </cover>
    <header class="l_header shadow blur">
  <div class='container'>
  <div class='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h m-phone' id="pjax-header-nav-list">
        <li><a class="s-comment fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
            <img no-lazy class='logo' src='https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/blog/Logo-NavBar@3x.png'/>
          
          
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h m-pc'>
          
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>

			<ul class='switcher nav-list-h m-phone'>
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>博客
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于
                </a>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

  </div>
  


  <div class="l_body nocover">
    <div class='body-wrapper' id="pjax-container">
      
        <!--此文件用来存放一些不方便取值的变量--> 
<!--思路大概是将值藏到重加载的区域内--> 
 
 
 
<div id="pjax-data" style="display: none"> 
  <div id="pjax-ispage">false</div> 
  <div id="pjax-pageTitle"></div> 
  <div id="pjax-enable-cover">true</div> 
  <div id="pjax-comment-path">none</div> 
  <div id="pjax-comment-placeholder">none</div> 
</div> 
 
 
<script> 
  // 处理封面 此时 jquery 还没加载 
  if ("none" == "none") { // 移除封面 
    document.getElementsByClassName('cover')[0].style.display = "none"; 
    document.getElementsByClassName('l_body')[0].classList.add("nocover"); 
    document.getElementsByClassName('l_header', 'cover-wrapper')[0].classList.add("show"); 
  } else { 
    if ("none" == "blog") { // 半屏 
      document.getElementsByClassName('cover')[0].classList.remove("full"); 
      document.getElementsByClassName('cover')[0].classList.add("half"); 
      document.getElementsByClassName('scroll-down')[0].style.display = "none"; 
    } else if ("none" == "docs") { // 全屏 
      document.getElementsByClassName('cover')[0].classList.remove("half"); 
      document.getElementsByClassName('cover')[0].classList.add("full"); 
      document.getElementsByClassName('scroll-down')[0].style.display = ""; 
    } 
    document.getElementsByClassName('cover')[0].style.display = ""; 
    document.getElementsByClassName('l_body', 'show')[0].classList.remove("nocover"); 
    document.getElementsByClassName('l_header', 'cover-wrapper')[0].classList.remove("show"); 
  } 
</script> 

      
      


<div class='l_main'>
  
    
      
  <section class="post-list ">
    
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
    
    
      
        
          <div class='post-wrapper'>
            <article class="post white-box shadow reveal ">
  


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h2 class="title">
    <a href="/2020/08/10/morethanjava-day-6-mian-xiang-dui-xiang-jin-jie-duo-tai/">
      「MoreThanJava」Day 6：面向对象进阶——多态
    </a>
  </h2>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a class='author' href="" rel="nofollow">
    <img no-lazy src="">
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/MoreThanJava/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>MoreThanJava</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2020年8月10日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  


            
          
            
              

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/BlogImage01/%E3%80%8CMoreThanJava%E3%80%8DDay6%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6%E2%80%94%E2%80%94%E5%A4%9A%E6%80%81/image-20200811201534863.png" alt=""></p>
<ul>
<li><strong>「MoreThanJava」</strong> 宣扬的是 <strong>「学习，不止 CODE」</strong>，本系列 Java 基础教程是自己在结合各方面的知识之后，对 Java 基础的一个总回顾，旨在 <strong>「帮助新朋友快速高质量的学习」</strong>。</li>
<li>当然 <strong>不论新老朋友</strong> 我相信您都可以 <strong>从中获益</strong>。如果觉得 <strong>「不错」</strong> 的朋友，欢迎 <strong>「关注 + 留言 + 分享」</strong>，文末有完整的获取链接，您的支持是我前进的最大的动力！</li>
</ul>
<h1 id="Part-1-多态概述"><a href="#Part-1-多态概述" class="headerlink" title="Part 1. 多态概述"></a>Part 1. 多态概述</h1><p>多态，简而言之就是 <strong>同一个行为</strong> 具有 <strong>多个不同表现形式</strong> 或形态的能力。在面向对象的程序设计中，<strong>多态的能力是通过数据抽象和继承之后得来的</strong>。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/ae55c7cc-ea6e-45f6-8014-307eb774bb38.png" alt=""></p>
<p>比如，有一杯水，我不知道它是温的、冰的还是烫的，但是我一摸我就知道了，我摸水杯的这个动作 <em>(方法)</em>，对于不同温度的水 <em>(运行时不同的对象类型)</em>，就会得到不同的结果，这就是多态。</p>
<p><strong>代码演示：</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// 基类定义</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Water</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// 冰水</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IceWater</span> <span class="token keyword">extends</span> <span class="token class-name">Water</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"我的温度是: 0度"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// 温水</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WarmWater</span> <span class="token keyword">extends</span> <span class="token class-name">Water</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"我的温度是: 40度"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// 开水</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HotWater</span> <span class="token keyword">extends</span> <span class="token class-name">Water</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"我的温度是: 100度"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// 测试类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestWater</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Water w <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WarmWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        w<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        w <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IceWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        w<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        w <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HotWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        w<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>结果输出：</strong></p>
<pre class=" language-text"><code class="language-text">我的温度是: 40度
我的温度是: 0度
我的温度是: 100度</code></pre>
<p>这里的方法 <code>showTem()</code> 就相当于你去摸水杯。我们定义的 <code>Water</code> 类型的引用变量 <code>w</code> 就相当于水杯，你在水杯里放了什么温度的水，那么我摸出来的感觉就是什么。就像代码中的那样，放置不同温度的水，得到的温度也就不同，但水杯是同一个。</p>
<h2 id="里氏替换原则（LSP）"><a href="#里氏替换原则（LSP）" class="headerlink" title="里氏替换原则（LSP）"></a>里氏替换原则（LSP）</h2><p>面向对象的设计原则有一条关于多态的原则，它的描述大概是这样子的：<strong>子类对象</strong> <em>(object of subtype/derived class)</em> 能够 <strong>替换</strong> 程序 <em>(program)</em> 中 <strong>父类对象</strong> <em>(object of base/parent class)</em>  出现的 <strong>任何地方</strong>，并且 <strong>保证原来程序的逻辑行为 <em>(behavior)</em> 不变及正确性不被破坏</strong>。</p>
<p>这么说可能有点抽象，简单说就是 <strong>子类和父类的行为应该保持一致</strong>。</p>
<h3 id="哪些代码明显违背了-LSP？"><a href="#哪些代码明显违背了-LSP？" class="headerlink" title="哪些代码明显违背了 LSP？"></a>哪些代码明显违背了 LSP？</h3><p>实际上，里式替换原则还有另外一个更加能落地、更有指导意义的描述，那就是 <strong>“Design By Contract”</strong>，中文翻译就是 <strong>“按照协议来设计”</strong>。定义中父类和子类之间的关系，也可以替换成接口和实现类之间的关系。</p>
<p>为了更好地理解这句话，我举几个违反里式替换原则的例子来解释一下。</p>
<h4 id="1-子类违背父类声明要实现的功能"><a href="#1-子类违背父类声明要实现的功能" class="headerlink" title="1 - 子类违背父类声明要实现的功能"></a>1 - 子类违背父类声明要实现的功能</h4><p>父类中提供的 <code>sortOrdersByAmount()</code> 订单排序函数，是按照金额从小到大来给订单排序的，而子类重写这个 <code>sortOrdersByAmount()</code> 订单排序函数之后，是按照创建日期来给订单排序的。那子类的设计就违背里式替换原则。</p>
<h4 id="2-子类违背父类对输入、输出、异常的约定"><a href="#2-子类违背父类对输入、输出、异常的约定" class="headerlink" title="2 - 子类违背父类对输入、输出、异常的约定"></a>2 - 子类违背父类对输入、输出、异常的约定</h4><p>在父类中，某个函数约定：运行出错的时候返回 <code>null</code>；获取数据为空的时候返回空集合（empty collection）。而子类重载函数之后，实现变了，运行出错返回异常（exception），获取不到数据返回 <code>null</code>。那子类的设计就违背里式替换原则。</p>
<h4 id="3-子类违背父类注释中所罗列的任何特殊说明"><a href="#3-子类违背父类注释中所罗列的任何特殊说明" class="headerlink" title="3 - 子类违背父类注释中所罗列的任何特殊说明"></a>3 - 子类违背父类注释中所罗列的任何特殊说明</h4><p>父类中定义的 <code>withdraw()</code> 提现函数的注释是这么写的：“用户的提现金额不得超过账户余额……”，而子类重写 <code>withdraw()</code> 函数之后，针对 VIP 账号实现了透支提现的功能，也就是提现金额可以大于账户余额，那这个子类的设计也是不符合里式替换原则的。</p>
<blockquote>
<p>当然，当前的大环境下，注释的可信度还是得斟酌斟酌.. <em>(不可尽信..)</em></p>
</blockquote>
<h1 id="Part-2-向上转型-amp-amp-向下转型"><a href="#Part-2-向上转型-amp-amp-向下转型" class="headerlink" title="Part 2. 向上转型 &amp;&amp; 向下转型"></a>Part 2. 向上转型 &amp;&amp; 向下转型</h1><h2 id="再谈向上转型"><a href="#再谈向上转型" class="headerlink" title="再谈向上转型"></a>再谈向上转型</h2><p>在 <a href="https://www.wmyskxz.com/2020/08/07/morethanjava-day-5-mian-xiang-dui-xiang-jin-jie-ji-cheng-xiang-jie/">上一篇文章</a> 里面我们已经谈到 —— <strong>对象既可以作为它本身的类型使用，也可以作为它基类的类型使用</strong>。而这种把对某个对象的引用视为其基类型的引用的做法被称为 <strong>向上转型</strong> <em>(因为在继承树的画法中，基类位于子类上方)</em>。</p>
<p>语句 <code>Water w = new WarmWater();</code> 就是向上转型的典型代码，这会将子类类型 <code>WarmWater</code> 转成父类的 <code>Water</code> 类型。</p>
<h3 id="存在问题"><a href="#存在问题" class="headerlink" title="存在问题"></a>存在问题</h3><p><strong>❶ 向上转型时，子类单独定义的方法会丢失。</strong></p>
<p>例如，我们如果在温水中定义一个喝水的方法 <code>drink()</code>，那么当 <code>w</code> 引用指向 <code>WarmWater</code> 类实例的时候是访问不到 <code>drink()</code> 方法的，<code>w.drink()</code> 会报错。</p>
<p><strong>❷ 子类引用不能指向父类对象。</strong></p>
<p><code>HotWater hotWater  = (HotWater)new Water();</code> 这样是不行的。</p>
<h3 id="向上转型的好处"><a href="#向上转型的好处" class="headerlink" title="向上转型的好处"></a>向上转型的好处</h3><ul>
<li>减少重复代码，提高代码可读性；</li>
<li>提高系统扩展性；</li>
</ul>
<p>举个例子，比如我现在有许多不同温度的水，如果不用向上转型，摸水杯这个动作我需要这样写：</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// Water 类中方法定义</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showTem</span><span class="token punctuation">(</span>IceWater water<span class="token punctuation">)</span> <span class="token punctuation">{</span> water<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showTem</span><span class="token punctuation">(</span>WarmWater water<span class="token punctuation">)</span> <span class="token punctuation">{</span> water<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showTem</span><span class="token punctuation">(</span>HotWater water<span class="token punctuation">)</span> <span class="token punctuation">{</span> water<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// 测试类中调用</span>
water<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IceWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
water<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WarmWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
water<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HotWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>每一种不同温度的水我都需要在 <code>Water</code> 中单独定义一个方法 <em>(因为都是不同的类型)</em>，数量一多，就会变得非常冗余和复杂。</p>
<p>但使用向上转型，一切就轻松多了：</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// Water 类中方法定义</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showTem</span><span class="token punctuation">(</span>Water water<span class="token punctuation">)</span> <span class="token punctuation">{</span> water<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// 测试类中调用</span>
water<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IceWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
water<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WarmWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
water<span class="token punctuation">.</span><span class="token function">showTem</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HotWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>就算新添加一种温度的水，我也只需要继承 <code>Water</code> 实现 <code>showTem()</code> 方法就行了，原有的代码几乎不需要修改。这也体现了软件设计原则中重要的 <strong>开闭原则 —— 对扩展开放，对修改封闭。</strong></p>
<h2 id="向下转型"><a href="#向下转型" class="headerlink" title="向下转型"></a>向下转型</h2><p>与向上转型相对应的就是向下转型了 —— 也就是把父类对象转为子类对象。<em>(这有大坑…)</em></p>
<p>还是用上面的摸水杯的例子来说明，我们先在温水 <code>WarmWater</code> 中加入一个喝水的方法：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WarmWater</span> <span class="token keyword">extends</span> <span class="token class-name">Water</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">showTem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"我的温度是: 40度"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">// 新增加的喝水的方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">drink</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"喝水..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>示例代码：</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Water water <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WarmWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 子类实例赋给父类引用 - 向上转型</span>
        WarmWater warmWater <span class="token operator">=</span> <span class="token punctuation">(</span>WarmWater<span class="token punctuation">)</span> water<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// Water向下转型为WarmWater</span>
        warmWater<span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        IceWater iceWater <span class="token operator">=</span> <span class="token punctuation">(</span>IceWater<span class="token punctuation">)</span> water<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// Water向下转型为IceWater</span>
        iceWater<span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// IDE 提示无法找到 drink() 方法</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>为什么第一段代码不报错呢？因为 <code>water</code> 本身就是 <code>WarmWater</code> 类型的对象，所以它理所当然的可以向下转型为 <code>WarmWater</code> 类型了，也理所当然的不能转型为 <code>IceWater</code>，这就好像你见过 <strong>一条狗突然变成一只猫</strong> 的情况吗？</p>
<p><strong>再来看下列代码：</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Water water <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Water</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        WarmWater warmWater <span class="token operator">=</span> <span class="token punctuation">(</span>WarmWater<span class="token punctuation">)</span> water<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// 下列代码报错：java.lang.ClassCastException: class Water cannot be cast to class WarmWater</span>
        warmWater<span class="token punctuation">.</span><span class="token function">drink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>上面例子想要说明的是，<strong><code>Water</code> 类型的对象 <em>(父类型)</em> 不能向下转型为任何类型的对象</strong>。这就好像你去考古，你发现了一个新生物，你知道它是一种动物，但你不能直接说它是猫或者狗…</p>
<h3 id="向下转型注意事项"><a href="#向下转型注意事项" class="headerlink" title="向下转型注意事项"></a>向下转型注意事项</h3><ul>
<li>向下转型的前提是父类对象指向的是子类对象；<em>(也就是对应上面实例代码中向下转型 <code>WarmWater</code> 的情况.. <code>new WarmWater()</code> 首先得完成向上的转型..)</em></li>
<li>向下转型只能转型为本类对象；<em>(猫是不能变成狗的.. 对应上方 <code>WamWater</code> 类型就不能转成 <code>IceWarm</code> 类型的情况)</em></li>
</ul>
<h3 id="向下转型的意义"><a href="#向下转型的意义" class="headerlink" title="向下转型的意义"></a>向下转型的意义</h3><p>有的小伙伴可能看到这里有点懵了.. 向下转型需要先向上转型，这转来转去好玩儿是吗？</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/BlogImage01/%E3%80%8CMoreThanJava%E3%80%8DDay6%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6%E2%80%94%E2%80%94%E5%A4%9A%E6%80%81/6af89bc8gw1f8q76jxt2xj202a025dfn.png" alt=""></p>
<p>向上转型让我们有了统一处理一类抽象事物的能力，这大大减少了我们的重复代码，并增加了我们代码的可扩展性。可事实上是，尽管我们尽力抽象一类事物，让他们尽可能地保证行为的统一，但总有例外！<em>(就像 <a href="https://www.wmyskxz.com/2020/08/07/morethanjava-day-5-mian-xiang-dui-xiang-jin-jie-ji-cheng-xiang-jie/">上一次</a> 我们讨论继承时提到的鸟类的例子，并不是所有鸟都能飞或者叫！)</em> </p>
<p>所以当例外来临时，我们就可以及时判断并做对应的处理。<em>(这也比较符合现实的情况)</em></p>
<p>最典型的例子就是 JDK 中的某一些集合类，对于集合类来说，并不需要记住存储所有存储对象的类型，而是统一抽象成了 <code>Node</code> 类型，就拿 <code>HashMap</code> 来说吧，存储一个元素 <em>(<code>putVal()</code> 方法)</em> 时就要判定当前节点时属于链表还是红黑树的部分：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/BlogImage01/%E3%80%8CMoreThanJava%E3%80%8DDay6%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6%E2%80%94%E2%80%94%E5%A4%9A%E6%80%81/image-20200811180639052.png" alt="为防止 &quot;新小伙伴&quot; 看着代码头晕，简化处理了一下"></p>
<h1 id="Part-3-多态经典案例分析"><a href="#Part-3-多态经典案例分析" class="headerlink" title="Part 3. 多态经典案例分析"></a>Part 3. 多态经典案例分析</h1><p>我们来看一个经典的例子：</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// A 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> String <span class="token function">show</span><span class="token punctuation">(</span>D object<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">"A and D"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> String <span class="token function">show</span><span class="token punctuation">(</span>A object<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">"A and A"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// B 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token keyword">extends</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> String <span class="token function">show</span><span class="token punctuation">(</span>B object<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">"B and B"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> String <span class="token function">show</span><span class="token punctuation">(</span>A object<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">"B and A"</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// C 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token keyword">extends</span> <span class="token class-name">B</span><span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// D 类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">D</span> <span class="token keyword">extends</span> <span class="token class-name">B</span><span class="token punctuation">{</span> <span class="token punctuation">}</span></code></pre>
<p><strong>测试类：</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        A a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        A aRefB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        B b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        C c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        D d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1-"</span> <span class="token operator">+</span> a<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"2-"</span> <span class="token operator">+</span> a<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"3-"</span> <span class="token operator">+</span> a<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"4-"</span> <span class="token operator">+</span> aRefB<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"5-"</span> <span class="token operator">+</span> aRefB<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"6-"</span> <span class="token operator">+</span> aRefB<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"7-"</span> <span class="token operator">+</span> b<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"8-"</span> <span class="token operator">+</span> b<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"9-"</span> <span class="token operator">+</span> b<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>输出结果：</strong></p>
<pre class=" language-text"><code class="language-text">1-A and A
2-A and A
3-A and D
4-B and A
5-B and A
6-A and D
7-B and B
8-B and B
9-A and D</code></pre>
<p>前三个比较容易，因为 B、C 都本质上是 A 类，所以 <code>1</code> 和 <code>2</code> 都进入了 A 类中签名为 <code>show(A)</code> 的方法。</p>
<p>但是第四个非常奇怪，A 对象类型引用了一个 B 类型的实例，输出是 <code>B and A</code>，而不是想象中的 <code>B and B</code>，为什么呢？</p>
<p>这里有一个新知识点：<strong>决定调用哪个方法的是引用变量类型</strong>。</p>
<p>拿这里的 <code>aRefB.show(b)</code> 来说好了，<code>aRefB</code> 虽然是 A 类型的引用，但首先会查找 B 对象中的方法 <em>(因为它实际的指向是 B)</em>，而引用 <code>b</code> 正好是一个 B 类型 <em>(实质上是 is-a A 类型)</em>，所以符合 B 对象中签名为 <code>show(A)</code> 的方法，就输出了 <code>B and A</code>。如果 B 类型中没有符合签名的方法，那么会从父类中查找，继续这个过程直到找到或者报错。</p>
<p>如果你能理解这个过程，并分析其他的情况，那么说明你真的掌握了。</p>
<p>再来分析 <code>b.show(d)</code> 输出 <code>A and D</code> 的情况，就简单很多了：B 对象中不存在 <code>show(D)</code> 这样的签名，所以从父类 A 中查找，故输出了 <code>A and D</code>。</p>
<h1 id="要点回顾"><a href="#要点回顾" class="headerlink" title="要点回顾"></a>要点回顾</h1><ol>
<li>多态概述 / 里氏替换原则 / 向上向下转型；</li>
<li>典型多态案例分析 / 练习；</li>
</ol>
<h1 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h1><h2 id="练习-1：工资结算系统"><a href="#练习-1：工资结算系统" class="headerlink" title="练习 1：工资结算系统"></a>练习 1：工资结算系统</h2><blockquote>
<p>某公司有三种类型的员工，分别是部门经理、程序员和销售员。需要设计一个工资结算系统，根据提供的员工信息来计算月薪。</p>
<p>部门经理的月薪是每月固定 <code>15000</code> 元；<br>程序员的月薪按每月工作时间计算，每小时 <code>150</code> 元；<br>销售员的月薪是 <code>1200</code> 底薪加上销售额 <code>5%</code> 的提成；</p>
</blockquote>
<p><strong>抽象员工类：</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractEmployee</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">AbstractEmployee</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// 获取工资</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">double</span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> String <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>项目经理类：</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Manager</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractEmployee</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">Manager</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">15000</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>程序员类：</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Programer</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractEmployee</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> Integer workHours<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Programer</span><span class="token punctuation">(</span>String name<span class="token punctuation">,</span> Integer workHours<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>workHours <span class="token operator">=</span> workHours<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// 仅提供单独的 set 方法，工作时间理论上来说是一个私人的消息..</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setWorkHours</span><span class="token punctuation">(</span>Integer workHours<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>workHours <span class="token operator">=</span> workHours<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">150</span> <span class="token operator">*</span> workHours<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>销售员类：</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Salesman</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractEmployee</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> Integer salesAmount<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Salesman</span><span class="token punctuation">(</span>String name<span class="token punctuation">,</span> Integer salesAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>salesAmount <span class="token operator">=</span> salesAmount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// 也仅提供 set 方法，并不是所有人都能访问销售人员的销售金额</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSalesAmount</span><span class="token punctuation">(</span>Integer salesAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>salesAmount <span class="token operator">=</span> salesAmount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">1200</span> <span class="token operator">+</span> <span class="token number">0.05</span> <span class="token operator">*</span> salesAmount<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>测试类：</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 项目经理张三、996程序员李四、月销售过万的明星销售员王五</span>
        List<span class="token operator">&lt;</span>AbstractEmployee<span class="token operator">></span> employees <span class="token operator">=</span> List
            <span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Programer</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">21</span> <span class="token operator">-</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Salesman</span><span class="token punctuation">(</span><span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">// 发工资..</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>AbstractEmployee employee <span class="token operator">:</span> employees<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>employee<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"工资为："</span> <span class="token operator">+</span> employee<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>程序输出：</strong></p>
<pre class=" language-text"><code class="language-text">张三工资为：15000.0
李四工资为：10800.0
王五工资为：1700.0</code></pre>
<p><em>(ps：有感受到来自于现实主义的正义光辉洒在你的身上吗？)</em></p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol>
<li>《Java 核心技术 卷 I》</li>
<li>《Java 编程思想》</li>
<li>Introduction to Computer Science using Java - <a href="http://programmedlessons.org/Java9/index.html" target="_blank" rel="noopener">http://programmedlessons.org/Java9/index.html</a></li>
<li>重新认识java（五） —- 面向对象之多态（向上转型与向下转型） - <a href="https://blog.csdn.net/qq_31655965/article/details/54746235" target="_blank" rel="noopener">https://blog.csdn.net/qq_31655965/article/details/54746235</a></li>
<li>极客时间 | 设计模式之美 - <a href="https://time.geekbang.org/column/article/177110" target="_blank" rel="noopener">https://time.geekbang.org/column/article/177110</a></li>
<li>Python 100 天从新手到大师 - <a href="https://github.com/jackfrued/Python-100-Days" target="_blank" rel="noopener">https://github.com/jackfrued/Python-100-Days</a></li>
</ol>
<blockquote>
<ul>
<li>本文已收录至我的 Github 程序员成长系列 <strong>【More Than Java】，学习，不止 Code，欢迎 star：<a href="https://github.com/wmyskxz/MoreThanJava" target="_blank" rel="noopener">https://github.com/wmyskxz/MoreThanJava</a></strong></li>
<li><strong>个人公众号</strong> ：wmyskxz，<strong>个人独立域名博客</strong>：wmyskxz.com，坚持原创输出，下方扫码关注，2020，与您共同成长！</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/common/qrcode.png" alt=""></p>
<p>非常感谢各位人才能 <strong>看到这里</strong>，如果觉得本篇文章写得不错，觉得 <strong>「我没有三颗心脏」有点东西</strong> 的话，<strong>求点赞，求关注，求分享，求留言！</strong></p>
<p>创作不易，各位的支持和认可，就是我创作的最大动力，我们下篇文章见！</p>

      
    </div>
    
      
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post white-box shadow reveal ">
  


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h2 class="title">
    <a href="/2020/08/07/morethanjava-day-5-mian-xiang-dui-xiang-jin-jie-ji-cheng-xiang-jie/">
      「MoreThanJava」Day 5：面向对象进阶——继承详解
    </a>
  </h2>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a class='author' href="" rel="nofollow">
    <img no-lazy src="">
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/MoreThanJava/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>MoreThanJava</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2020年8月7日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  


            
          
            
              

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/e973d387-618a-46bd-abe5-bce322f54a72.png" alt=""></p>
<ul>
<li><strong>「MoreThanJava」</strong> 宣扬的是 <strong>「学习，不止 CODE」</strong>，本系列 Java 基础教程是自己在结合各方面的知识之后，对 Java 基础的一个总回顾，旨在 <strong>「帮助新朋友快速高质量的学习」</strong>。</li>
<li>当然 <strong>不论新老朋友</strong> 我相信您都可以 <strong>从中获益</strong>。如果觉得 <strong>「不错」</strong> 的朋友，欢迎 <strong>「关注 + 留言 + 分享」</strong>，文末有完整的获取链接，您的支持是我前进的最大的动力！</li>
</ul>
<h1 id="Part-1-继承概述"><a href="#Part-1-继承概述" class="headerlink" title="Part 1. 继承概述"></a>Part 1. 继承概述</h1><p><a href="https://www.wmyskxz.com/2020/08/04/morethanjava-day-4-mian-xiang-dui-xiang-ji-chu/">上一篇文章</a> 中我们简单介绍了继承的作用，它允许创建 <strong>具有逻辑等级结构的类体系</strong>，形成一个继承树。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/35b85013-1566-4442-a093-67dc71ec7774.png" alt="Animal 继承树"></p>
<p>继承使您可以基于现有类定义新类。 新类与现有类相似，但是可能具有其他实例变量和方法。这使编程更加容易，因为您可以 <strong>在现有的类上构建</strong>，而不必从头开始。</p>
<p>继承是现代软件取得巨大成功的部分原因。 程序员能够在先前的工作基础上继续发展并不断改进和升级现有软件。</p>
<h2 id="面向对象之前，写代码的一些问题"><a href="#面向对象之前，写代码的一些问题" class="headerlink" title="面向对象之前，写代码的一些问题"></a>面向对象之前，写代码的一些问题</h2><p>如果你有一个类的源代码，你可以复制代码并改变它变成你想要的样子。在面向对象编程之前，就是这样子做的。但至少有两个问题：</p>
<p><strong>❶ 很难保持仅仅有条。</strong></p>
<p>假设您已经有了几十个需要的类，并且需要基于原始类创造新的一些类，再基于新的类创造出更新的类，最终您将获得数十个源文件，这些源文件都是通过其他已更改的源文件的另外版本。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/a7feeb86-9d37-406f-8aba-b9f395b437f7.png" alt=""></p>
<p>假设现在在一个源文件中发现了错误，一些基于它的源文件需要进行修复，但是对于其他源文件来说，并不需要！没有细致的写代码的计划，您最终会陷入混乱….</p>
<p><strong>❷ 需要学习原始代码。</strong></p>
<p>假设您有一个复杂的类，基本上可以完成所需的工作，但是您需要进行一些小的修改。如果您修改了源代码，即使是进行了很小的更改，也可能会破坏某些内容。因此，您必须研究原始代码以确保所做的更改正确，这可能并不容易。</p>
<p><strong>Java 的自动继承机制极大地缓解了这两个问题。</strong></p>
<h2 id="单继承"><a href="#单继承" class="headerlink" title="单继承"></a>单继承</h2><p>用于作为新类模板的类称为 <strong>父类</strong> <em>(或超类或基类)</em>，基于父类创建的类称为 <strong>子类</strong> <em>(或派生类)</em>。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/1744fdbf-cae1-4460-b4d9-0e48f00034eb.png" alt=""></p>
<p>就像上图中演示的那样，箭头从子类指向父类。<em>(在上图中，云表示类，而矩形表示对象，这样的表示的方法来自于 Grady Booch 写的《面向对象的分析和设计》一书。而在官方的 UML-统一建模语言 中，类和对象都用矩形表示，请注意这一点)</em></p>
<p>在 Java 中，<strong>子类仅从一个父类继承特征</strong>，这被称为 <strong>单继承</strong> <em>(与人类不同)</em>。</p>
<p>有些语言允许”孩子”从多个”父母”那里继承，这被称为 <strong>多继承</strong>。但由于具有多重继承，有时很难说出哪个父母为孩子贡献了哪些特征 <em>(跟人类一样..)</em>。</p>
<p>Java 通过使用单继承避免了这些问题。<em>(意思 Java 只允许单继承)</em></p>
<h2 id="is-a-关系"><a href="#is-a-关系" class="headerlink" title="is-a 关系"></a>is-a 关系</h2><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/2fed3fa5-88ee-460c-b839-e6bc9be6c551.png" alt=""></p>
<p>上图显示了一个父类 <em>(Video 视频类)</em>，一个子类 <em>(Movie 电影类)</em>。它们之间的实线表示 <strong>“is-a”</strong> 的关系：电影是视频。 </p>
<p><strong>注意，继承是在类之间，而不是在对象之间。</strong> <em>(上图两朵云都代表类)</em></p>
<p>父类是构造对象时使用的蓝图，子类用于构造看起来像父对象的对象，但具有附加功能的对象。</p>
<h3 id="类之间的关系简述"><a href="#类之间的关系简述" class="headerlink" title="类之间的关系简述"></a>类之间的关系简述</h3><p>简单地说，类和类之间的关系有三种：<code>is-a</code>、<code>has-a</code> 和 <code>use-a</code>。</p>
<ul>
<li><strong><code>is-a</code> 关系也叫继承或泛化</strong>，比如学生和人的关系、手机和电子产品的关系都属于继承关系；</li>
<li><strong><code>has-a</code> 关系通常称之为关联</strong>，比如部门和员工的关系、汽车和引擎的关系都属于关联关系；关联关系如果是整体和部分的关联，那么我们称之为 <strong>聚合关系</strong>；如果整体进一步负责了部分的生命周期 <em>(整体和部分是不可分割的，同时同在也同时消亡)</em>，那么这种就是最强的关联关系，我们称之为 <strong>合成</strong> 关系。</li>
<li><strong><code>use-a</code> 关系通常称之为依赖</strong>，比如司机有一个驾驶的行为 <em>(方法)*，其中 *(的参数)</em> 使用到了汽车，那么司机和汽车的关系就是依赖关系。</li>
</ul>
<p>利用类之间的这些关系，我们可以在已有类的基础上来完成某些操作，也可以在已有类的基础上创建新的类，这些都是实现代码复用的重要手段。复用现有的代码不仅可以减少开发的工作量，也有利于代码的管理和维护，这是我们在日常工作中都会使用到的技术手段。</p>
<h2 id="层级结构"><a href="#层级结构" class="headerlink" title="层级结构"></a>层级结构</h2><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/5f02652b-1840-4faf-a18b-ba3b5455663d.png" alt=""></p>
<p>上图显示了一个父类和一个子类的 <strong>层次结构</strong>，以及从每个类构造的一些对象。这些对象用矩形表示，以表达它们比设计的类更真实。</p>
<p>在层次结构中，每个类最多有一个父类，但可能有几个子类。 层次结构顶部的类没有父级。此类称为层次结构的 <strong>根</strong>。</p>
<p>另外，一个类可以是另一个子类的父类，也可以是父类的子类。就像人类一样，一个人是某些人类的孩子，也是其他人类的父母。<em>(但在 Java 中，一个孩子只有一个父母)</em></p>
<h1 id="Part-2-继承的实现"><a href="#Part-2-继承的实现" class="headerlink" title="Part 2. 继承的实现"></a>Part 2. 继承的实现</h1><p>从父类派生子类的语法是使用 <code>extend</code> 关键字：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">ChildClass</span> extend ParentClass <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 子类的新成员和构造函数....</span>
<span class="token punctuation">}</span></code></pre>
<p>父类的成员 <em>(变量和方法</em>) 通过继承包含在子类中。其他成员将在其类定义中添加到子类。</p>
<h2 id="视频观影-App-示例"><a href="#视频观影-App-示例" class="headerlink" title="视频观影 App 示例"></a>视频观影 App 示例</h2><p>Java 编程是通过创建类层次结构并从中实例化对象来完成的。您可以扩展自己的类或扩展已经存在的类。Java 开发工具包 <em>(JDK)</em> 为您提供了丰富的基类集合，您可以根据需要扩展这些基类。</p>
<p><em>(如果某些类已经使用 <code>final</code> 修饰，则无法继承)</em></p>
<p>下面演示了一个使用 <code>Video</code> 类作为基类的视频观影 App 的程序设计：</p>
<p><strong>Video 基类：</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Video</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> String title<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// name of video</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> length<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// number of minutes</span>

    <span class="token comment" spellcheck="true">// constructor</span>
    <span class="token keyword">public</span> <span class="token function">Video</span><span class="token punctuation">(</span>String title<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> length<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"title="</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">", length="</span> <span class="token operator">+</span> length<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> title<span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTitle</span><span class="token punctuation">(</span>String title<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> length<span class="token punctuation">;</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLength</span><span class="token punctuation">(</span><span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> length<span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>Movie 电影类继承 Video：</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Movie</span> <span class="token keyword">extends</span> <span class="token class-name">Video</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> String director<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// name of the director</span>
    <span class="token keyword">private</span> String rating<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// num of rating</span>

    <span class="token comment" spellcheck="true">// constructor</span>
    <span class="token keyword">public</span> <span class="token function">Movie</span><span class="token punctuation">(</span>String title<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">,</span> String director<span class="token punctuation">,</span> String rating<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>director <span class="token operator">=</span> director<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>rating <span class="token operator">=</span> rating<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getDirector</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> director<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> String <span class="token function">getRating</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> rating<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>这两个类均已定义：Video 类可用于构造视频类型的对象，现在 Movie 类可用于构造电影类型的对象。</p>
<p>Movie 类具有在 Video 中定义的成员变量和公共方法。</p>
<h2 id="使用父类的构造函数"><a href="#使用父类的构造函数" class="headerlink" title="使用父类的构造函数"></a>使用父类的构造函数</h2><p>查看上方的示例，在 Movie 类的初始化构造函数中有一条 <code>super(title, length);</code> 的语句，是 <strong>“调用父类 Video 中带有 title、length 参数的构造器”</strong> 的简写形式。</p>
<p>由于 Movie 类的构造器不能访问 Video 类的私有字段，所以必须通过一个构造器来初始化这些私有字段。可以利用特殊的 <code>super</code> 语法调用这个构造器。</p>
<p><strong>重要说明：<code>super()</code> 必须是子类构造函数中的第一条语句。</strong> <em>(这意味子类构造器总是会先调用父类的构造器)</em> 这件事经常被忽略，导致的结果就是一些神秘的编译器错误消息。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/f19c167d-a96e-43b4-abc1-15106fe6cdf2.png" alt=""></p>
<p>如果子类的构造器没有显式地调用父类的构造器，将自动地调用父类的无参构造器。如果父类没有无参数的构造器，并且在子类的构造器中又没有显式地调用父类的其他构造器，Java 编译器就会报告一个错误。<em>(在我们的例子中 Video 缺少无参数的构造函数，故👆上面图片代码会报错)</em></p>
<h2 id="创建一个无参构造函数"><a href="#创建一个无参构造函数" class="headerlink" title="创建一个无参构造函数"></a>创建一个无参构造函数</h2><p>关于构造函数的一些细节：</p>
<ol>
<li>您可以显式为类编写无参数的构造函数。</li>
<li>如果您没有为类编写任何构造函数，那么将自动提供无参数构造函数 <em>（称为默认构造函数）</em>。</li>
<li>如果为一个类编写了一个构造函数，则不会自动提供默认的构造函数。</li>
<li>因此：如果您为类编写了额外的构造函数，那么，则还必须编写一个无参数构造函数 <em>(供子类调用)</em>。</li>
</ol>
<p>在示例程序中，类 Video 包含构造函数，因此不会自动提供默认构造函数。 所以，Movie 类 <code>super()</code> 函数建议默认使用的构造函数 <em>(会自动调用无参数构造函数)</em> 会导致语法错误。</p>
<p>解决方法是将无参数构造函数显式放在类中 Video ，如下所示：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Video</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> String title<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// name of video</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> length<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// number of minutes</span>

    <span class="token comment" spellcheck="true">// no-argument constructor</span>
    <span class="token keyword">public</span> <span class="token function">Video</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"unknown"</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// constructor</span>
    <span class="token keyword">public</span> <span class="token function">Video</span><span class="token punctuation">(</span>String title<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> length<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="覆盖方法"><a href="#覆盖方法" class="headerlink" title="覆盖方法"></a>覆盖方法</h2><p>让我们来实例化 Movie 对象：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Video video <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Video</span><span class="token punctuation">(</span><span class="token string">"视频1"</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Movie movie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token string">"悟空传"</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token string">"郭子健"</span><span class="token punctuation">,</span> <span class="token string">"5.9"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>video<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>movie<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>程序输出：</strong></p>
<pre class=" language-text"><code class="language-text">title=视频1, length=90
title=悟空传, length=139</code></pre>
<p><code>movie.toString()</code> 是 Movie 类直接继承自 Video 类，它并没有使用 Movie 对象具有的新变量，因此并不会打印导演和评分。</p>
<p>我们需要给 Movie 类添加新的 <code>toString()</code> 的使用方法：</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// 添加到 Movie 类中</span>
<span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"title:"</span> <span class="token operator">+</span> <span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", length:"</span> <span class="token operator">+</span> <span class="token function">getLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">", director:"</span> <span class="token operator">+</span> <span class="token function">getDirector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">+</span> <span class="token string">", rating:"</span> <span class="token operator">+</span> <span class="token function">getRating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>现在，Movie 拥有了自己的 <code>toString()</code> 方法，该方法使用了继承自 Video 的变量和自己定义的变量。</p>
<p>即使父类有一个 <code>toString()</code> 方法，子类中新定义的 <code>toString()</code> 也会 <strong>覆盖</strong> 父类的版本。当子类方法的 <strong>签名</strong> <em>(就是返回值 + 方法名称 + 参数列表)</em> 与父类相同时，子类的方法就会 <strong>覆盖</strong> 父类的方法。</p>
<p>现在运行程序，Movie 打印出了我们期望的完整信息：</p>
<pre class=" language-text"><code class="language-text">title=视频1, length=90
title:悟空传, length:139, director:郭子健, rating:5.9</code></pre>
<blockquote>
<p>有些人认为 <code>super</code> 与 <code>this</code> 引用是类似的概念，实际上，这样比较并不太恰当。这是因为 <code>super</code> 不是一个对象的引用，例如，不能将值 <code>super</code> 赋给另一个对象变量，它只是一个指示编译器调用父类方法的特殊关键字。</p>
</blockquote>
<p>正像前面所看到的那样，在子类中可以增加字段、增加方法或覆盖父类的方法，不过，继承绝对不会删除任何字段或方法。</p>
<h1 id="Part-3-更多细节"><a href="#Part-3-更多细节" class="headerlink" title="Part 3. 更多细节"></a>Part 3. 更多细节</h1><h2 id="protected-关键字"><a href="#protected-关键字" class="headerlink" title="protected 关键字"></a>protected 关键字</h2><p>如果类中创建的变量或者方法使用 <code>protected</code> 描述，则指明了 “就类用户而言，这是 <code>private</code> 的，但对于任何继承于此类的导出类或者任何位于同一个 <strong>包</strong> 内的类来说，它是可以访问的”。下面我们就上面的例子来演示：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Video</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> String title<span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// name of video</span>
    <span class="token keyword">protected</span> <span class="token keyword">int</span> length<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">// number of minutes</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Movie</span> <span class="token keyword">extends</span> <span class="token class-name">Video</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"title:"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">", length:"</span> <span class="token operator">+</span> length <span class="token operator">+</span> <span class="token string">", director:"</span> <span class="token operator">+</span> director
            <span class="token operator">+</span> <span class="token string">", rating:"</span> <span class="token operator">+</span> rating<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span></code></pre>
<p>在 <code>protected</code> 修饰之前，如果子类 Movie 要访问父类 Video 的 <code>title</code> 私有变量只能通过父类暴露出来的 <code>getTitle()</code> 公共方法，现在则可以直接使用。</p>
<h2 id="向上转型"><a href="#向上转型" class="headerlink" title="向上转型"></a>向上转型</h2><p>“为新的类提供方法” 并不是继承技术中最重要的方面，<strong>其最重要的方面是用来表现新类和基类之间的关系</strong>。这种关系可以用 <strong>“新类是现有类的一种类型”</strong> 这句话加以概括。</p>
<p>由于继承可以确保基类中所有的方法在子类中也同样有效，所以能够向基类发送的所有信息也同样可以向子类发送。例如，如果 Video 类具有一个 <code>play()</code> 方法， 那么 Movie 类也将同样具备。这意味着我们可以准确地说 <strong>Movie 对象也是一种类型的 Video</strong>。<em>(体现 <code>is-a</code> 关系)</em></p>
<p>这一概念的体现用下面的例子来说明：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Video</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span>Video video<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// ...</span>
        video<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// 测试类</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Movie movie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token string">"悟空传"</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token string">"郭子健"</span><span class="token punctuation">,</span> <span class="token string">"5.9"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Video<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span>movie<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>在示例中，<code>start()</code> 方法可以接受 Video 类型的引用，这是在太有趣了！</p>
<p>在测试类中，传递给 <code>start()</code> 方法的是一个 Movie 引用。鉴于 Java 是一个对类型检查十分严格的语言，接受某种类型 <em>(上例是 <code>Video</code> 类型)</em> 的方法同样可以接受另外一种类型 <em>(上例是 <code>Movie</code> 类型)</em> 就会显得很奇怪！</p>
<p><strong>除非你认识到 Movei 对象也是一种 Video 对象</strong>。</p>
<p>在 <code>start()</code> 方法中，程序代码可以对 Video 和它所有子类起作用，<strong>这种将 Movie 引用转换为 Video 引用的动作</strong>，我们称之为 <strong>向上转型</strong> <em>(这样称呼是因为在继承树的画法上，基类在子类的上方…)</em>。</p>
<h2 id="Object-类"><a href="#Object-类" class="headerlink" title="Object 类"></a>Object 类</h2><p>所有的类均具有父类，除了 <code>Object</code> 类。Java 类层次结构的最顶部就是 <code>Object</code> 类。</p>
<p>如果类没有显式地指明继承哪一个父类，那么它会自动地继承自 <code>Object</code> 类。如果一个子类继承了一个父类，那么父类要么继承它的父类，要么自动继承 <code>Object</code>。<strong>最终，所有的类都将 <code>Object</code> 作为祖先。</strong></p>
<p>这意味着 Java 中的所有类都具有一些共同的特征。这些特征在被定义在 <code>Object</code> 中：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/925a4b38-d2b2-4508-9011-988e2f5cfb49.png" alt="Object 类拥有的方法"></p>
<p><em>(其中 <code>finalize()</code> 方法在 Java 9 之后弃用了，原因是因为它本身存在一些问题，可能导致性能问题：死锁、挂起和其他问题…)</em></p>
<p><em>(想看源码可以打一个 <code>Object</code>，然后按住 <code>Ctrl</code> 不放，然后点击 <code>Object</code> 就可以进入 JDK 源码查看了，源码有十分规范的注释和结构，你有时甚至会发现一些有趣的东西…)</em></p>
<p>Java 之父 Gosling 设计的 Object 类，是对万事万物的抽象，是在哲学方向上进行的延伸思考，高度概括了事物的自然行为和社会行为。我们都知道哲学的三大经典问题：我是谁？我从哪里来？我到哪里去？在 Object 类中，这些问题都可以得到隐约的解答：</p>
<ol>
<li><strong>我是谁？</strong> <code>getClass()</code> 说明本质上是谁，而 <code>toString()</code> 是当前的名片；</li>
<li><strong>我从哪里来？</strong> <code>Object()</code> 构造方法是生产对象的基本方式，<code>clone()</code> 是繁殖对象的另一种方式；</li>
<li><strong>我到哪里去？</strong> <code>finalize()</code> 是在对象销毁时触发的方法；<em>(Java 9 之后已移除)</em></li>
</ol>
<p>另外，Object 还映射了社会科学领域的一些问题：</p>
<ol>
<li><strong>世界是否因你而不同？</strong> <code>hashCode()</code> 和 <code>equals()</code> 就是判断与其他元素是否相同的一组方法；</li>
<li><strong>与他人如何协调？</strong> <code>wait()</code> 和 <code>notify()</code> 就是对象间通信与协作的一组方法；</li>
</ol>
<h2 id="理解方法调用"><a href="#理解方法调用" class="headerlink" title="理解方法调用"></a>理解方法调用</h2><p>准确地理解如何在对象上应用方法调用非常重要。下面假设我们要调用 <code>x.f(args)</code>，<code>x</code> 是声明为 <code>C</code> 的一个对象。下面是调用过程的详细描述：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/59297eb2-70b4-455b-adff-bb104e2bac70.png" alt=""></p>
<ol>
<li>编译器查看对象的声明类型和方法名。需要注意的是：有可能存在多个名字为 <code>f</code> 但参数类型不一样的方法。例如，可能存在 <code>f(int)</code> 和 <code>f(String)</code>。编译器将会一一列举 <code>C</code> 类中所有名为 <code>f</code> 的方法和其父类中所有名为 <code>f</code> 而且可以访问的方法 <em>(父类中的私有方法不可访问)</em>。<strong>至此，编译器一直到所有可能被调用的候选方法。</strong></li>
<li>接下来，编译器要确定方法调用中提供的参数类型。如果在所有名为 <code>f</code> 的方法中存在一个与所提供参数类型完全匹配的方法，就选择这个方法。这个过程称为 <strong>重载解析</strong> <em>(overloading resolution)</em>。例如，对于调用 <code>x.f(&quot;Hello&quot;)</code>，编译期将会挑选 <code>f(String)</code>，而不是 <code>f(int)</code>。由于允许类型转换 <em>(例如，<code>int</code> 可以转换成 <code>double</code>)</em>，所以情况可能会变得很复杂。如果编译器没有找到与参数类型匹配的方法，或者发现经过类型转换后有多个方法与之匹配，编译器就会报错。<strong>至此，编译器已经知道需要调用的方法的名字和参数类型。</strong></li>
<li>如果是 <code>private</code> 方法、<code>static</code> 方法、<code>final</code> 方法 <em>(有关 <code>final</code> 修饰符会在下面讲到)</em> 或者构造器，那么编译器将可以明确地知道应该调用哪个方法。这称为 <strong>静态绑定</strong> <em>(static binding)</em>。与此对应的是，如果要调用的方法依赖于隐式参数的实际类型，那么必须在运行时 <strong>动态绑定</strong>。在我们的实例中，编译器会利用动态绑定生成一个调用 <code>f(String)</code> 的指令。</li>
<li>程序运行并且采用动态绑定调用方法时，虚拟机必须调用与 <code>x</code> 所引用对象的实际类型对应的那个方法。假设 <code>x</code> 的实际类型是 <code>D</code>，它是 <code>C</code> 类的子类。如果 <code>D</code> 类定义了方法 <code>f(String)</code>，就会调用这个方法；否则，将在 <code>D</code> 类的父类中寻找 <code>f(String)</code>，以此类推。</li>
</ol>
<p><strong>每次调用方法都要完成这样的搜索，时间开销相当大</strong>。因此，虚拟机预先为每个类计算了一个 <strong>方法表</strong> <em>(method table)<em>， 其中列出了所有方法的签名和要调用的实际方法 *(存着各个方法的实际入口地址)</em>。这样一来，在真正调用方法的时候，虚拟机仅查找这个表就行了。</em>(以下是 Video-父类 和 Movie-子类 的方法表结构演示图)*</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/b969be72-d055-4cb6-b680-12e8f57c4254.png" alt=""></p>
<p>例如我们调用上述例子 Movie 类的 <code>play()</code> 方法。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>由于 <code>play()</code> 方法没有参数，因此不必担心 <strong>重载解析</strong> 的问题。又不是 <code>private/ static/ final</code> 方法，所以将采用 <strong>动态绑定</strong> 的方式。</p>
<p>在运行时，调用 <code>object.play()</code> 的解析过程为：</p>
<ol>
<li>首先，虚拟机获取 <code>object</code> 的实际类型的方法表。这可能是 Video、Movie 的方法表，也可能是 Video 类的其他子类的方法表；</li>
<li>接下来，虚拟机查找定义了 <code>play()</code> 签名的类。此时，虚拟机已经知道应该调用哪个方法了；<em>(这里如果 <code>object</code> 实际类型为 Movie 则调用 Movie.play()，为 Video 则调用 Video.play()，如果没找到才往父类去找..)</em></li>
<li>最后，虚拟机调用这个方法。</li>
</ol>
<p><strong>动态绑定有一个非常重要的特性：无须对现有的代码进行修改就可以对程序进行扩展。</strong></p>
<p>假设现在新增一个类 <code>ShortVideo</code>，并且变量 <code>object</code> 有可能引用这个类的对象，我们不需要对包含调用 <code>object.play()</code> 的代码重新进行编译。如果 <code>object</code> 恰好引用一个 <code>ShortVideo</code> 类的对象，就会自动地调用 <code>object.play()</code> 方法。</p>
<blockquote>
<p><strong>警告</strong>：在覆盖一个方法时，子类的方法 <strong>不能低于</strong> 父类方法的 <strong>可见性</strong> <em>(public &gt; protected &gt; private)</em>。特别是，如果父类方法是 <code>public</code>，子类方法必须也要声明为 <code>public</code>。</p>
</blockquote>
<h2 id="final-关键字"><a href="#final-关键字" class="headerlink" title="final 关键字"></a>final 关键字</h2><p>有时候，我们可能希望组织人们利用某个类定义子类。<strong>不允许扩展</strong> <em>(被继承)</em> 的类被称为 <strong>final 类</strong>。如果在定义类的时候使用了 <code>final</code> 修饰符就表明这个类是 <code>final</code> 类了：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">ShortVideo</span> <span class="token keyword">extends</span> <span class="token class-name">Video</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span></code></pre>
<p>类中的某个特定方法也可以被声明为 <code>final</code>。如果这样做，子类就不能覆盖这个方法 <em>(<code>final</code> 类中的所有方法自动地称为 <code>final</code> 方法)</em>。例如：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Video</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span></code></pre>
<p>如果一个 <strong>字段</strong> 被声明为了 <code>final</code> 类型，那么对于 <code>final</code> 字段来说，<strong>构造对象之后就不允许改变它们的值了</strong>。不过，如果将一个类声明为 <code>final</code>，只有其中的方法自动地称为 <code>final</code>，而不包括字段，这一点需要注意。</p>
<p><strong>将方法或类声明为 <code>final</code> 的主要原因是：确保它们不会在子类中改变语义。</strong></p>
<h3 id="JDK-中的例子"><a href="#JDK-中的例子" class="headerlink" title="JDK 中的例子"></a>JDK 中的例子</h3><ul>
<li><strong>Calendar</strong> 类 <em>(JDK 实现的日历类)</em> 中的 <code>getTime</code> 和 <code>setTime</code> 方法都声明为了 <code>final</code>，这就表明 <strong>Calendar</strong> 类的设计者负责实现 <strong>Data</strong> 类与日历状态之间的转换，而不允许子类来添乱。</li>
<li>同样的，<strong>String</strong> 类也是 <code>final</code> 类 <em>(甚至面试中也经常出现)</em>，这意味着不允许任何人定义 <strong>String</strong> 的子类，换而言之，如果有一个 <strong>String</strong> 引用，它引用的一定是一个 <strong>String</strong> 对象，而不可能是其他类的对象。</li>
</ul>
<h3 id="内联"><a href="#内联" class="headerlink" title="内联"></a>内联</h3><p>在早起的 Java 中，有些程序员为了避免动态绑定带来的系统开销而使用 <code>final</code> 关键字。如果一个方法没有被覆盖并且很短，编译器就能够对它进行优化处理，这个过程为 <strong>内联</strong> <em>(inlining)</em>。</p>
<p>例如，内联调用 <code>e.getName()</code> 会被替换为访问字段 <code>e.name</code>。</p>
<p>这是一项很有意义的改进，CPU 在处理当前指令时，<strong>分支会扰乱预取指令的策略</strong>，所以，CPU 不喜欢分支。然而，如果 <code>getName</code> 在另外一个类中 <strong>被覆盖</strong>，那么编译器就无法知道覆盖的代码将会做什么操作，因此也就不能对它进行内联处理了。</p>
<p>幸运的是，虚拟机中的 <strong>即时编译器</strong> <em>(JIT)</em> 比传统编译器的处理能力强得多。这种编译器可以准确地知道类之间的继承关系，并能够检测出是否有类确实覆盖了给定的方法。</p>
<p>如果方法很短、被频繁调用而且确实没有被覆盖，那么即时编译器就会将这个方法进行内联处理。如果虚拟机加载了另外一个子类，而这个子类覆盖了一个内联方法，那么优化器将取消对这个方法的内联。这个过程很慢，不过很少会发生这种情况。</p>
<h2 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h2><p>在类的自下而上的继承层次结构中，位于上层的类更具有一般性，也更加抽象。从某种角度看，祖先类更具有一般性，人们通常只是将它作为派生其他类的基类，而不是用来构造你想使用的特定的实例。</p>
<p>考虑一个 Person 类的继承结构：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/00ddd596-2c2c-4f94-a08b-37765be0ddfe.png" alt=""></p>
<p>每个人都有一些属性，如名字。学生与员工都有名字。</p>
<p>现在，假设需要增加一个 <code>getDescription()</code> 的方法，它返回对一个人简短的描述，学生类可以返回：<code>一个计算机在读的学生</code>，员工可以返回 <code>一个在阿里就职的后端工程师</code> 之类的。这在 Student 和 Employee 类中实现很容易，但是在 Person 类中应该提供什么内容呢？ 除了姓名，Person 类对这个人一无所知。</p>
<p>有一个更好的方法，就是使用 <code>abstract</code> 关键字，把该方法定义为一个 <strong>抽象方法</strong>，这意味着你并不需要实现这个方法，只需要定义出来就好了：<em>(以下代码为 Person 类中的抽象定义)</em></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> String <span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre>
<p>为了提高程序的清晰度，包含一个或多个抽象方法的类本身必须被声明为抽象的：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> String <span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span></code></pre>
<blockquote>
<p>《阿里Java开发规范》<strong>强制规定抽象类命名</strong> 使用 <code>Abstract</code> 或 <code>Base</code> 开头，这里只是做演示所以就简单用 <code>Person</code> 代替啦~</p>
</blockquote>
<p>抽象方法充当着占位方法的角色，它们在子类中被继承并实现。</p>
<p>扩展抽象类可以由两种选择。一种是在子类中保留抽象类中的部分或所有抽象方法仍未实现，这样就必须将子类标记为抽象类 <em>(因为还有抽象方法)</em>；另一种做法就是实现全部方法，这样一来，子类就不是抽象的了。</p>
<p><em>(即使不包含抽象方法，也可以将类声明为抽象类)</em></p>
<p>抽象类不能实例化，也就是说，如果将一个类声明为 <code>abstract</code>，就不能创建这个类的实例，例如：<code>new Person();</code> 就是错误的，但可以创建具体子类的对象：<code>Person p = new Student(args);</code>，这里的 <code>p</code> 是一个抽象类型 <code>Person</code> 的变量，它引用了一个非抽象子类 <code>Student</code> 的实例。</p>
<h1 id="Part-4-为什么不推荐使用继承？"><a href="#Part-4-为什么不推荐使用继承？" class="headerlink" title="Part 4. 为什么不推荐使用继承？"></a>Part 4. 为什么不推荐使用继承？</h1><p>先别急着奇怪和愤懑，刚学习完继承之后，就告诉说不推荐使用，这是 <strong>有原因的！</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/e29e8ed5-7853-4e7b-a89f-7ce7ab7b3fa2.png" alt=""></p>
<p>在面向对象编程中，有一条非常经典的设计原则：<strong>组合优于继承</strong>。使用继承有什么问题？组合相比继承有哪些优势？如何判断该用组合还是继承？下面我们就围绕这三个问题，来详细讲解一下。</p>
<blockquote>
<p>以下内容大部分引用自：<a href="https://time.geekbang.org/column/article/169593" target="_blank" rel="noopener">https://time.geekbang.org/column/article/169593</a></p>
</blockquote>
<h2 id="使用继承有什么问题？"><a href="#使用继承有什么问题？" class="headerlink" title="使用继承有什么问题？"></a>使用继承有什么问题？</h2><p>上面说到，继承是面向对象的四大特性之一，用来表示类之间的 <code>is-a</code> 关系，可以解决代码复用的问题。虽然继承有诸多作用，但继承层次过深、过复杂，也会影响到代码的可维护性。我们通过一个例子来说明一下。</p>
<p>假设我们要设计一个关于鸟的类，我们将 “鸟类” 这样一个抽象的事物概念，定义为一个抽象类 <code>AbstractBird</code>。所有更细分的鸟，比如麻雀、鸽子、乌鸦等，都继承这个抽象类。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/8afe27e4-35d6-4fa8-b90b-be2e05644eeb.png" alt=""></p>
<p>我们知道，大部分鸟都会飞，那我们可不可以在 <code>AbstractBird</code> 抽象类中，定义一个 <code>fly()</code> 方法呢？答案是否定的。尽管大部分鸟都会飞，但也有特例，比如鸵鸟就不会飞。鸵鸟继承具有 <code>fly()</code> 方法的父类，那鸵鸟就具有“飞”这样的行为，这显然不符合我们对现实世界中事物的认识。当然，你可能会说，我在鸵鸟这个子类中重写 <em>(override)</em> <code>fly()</code> 方法，让它抛出 <code>UnSupportedMethodException</code> 异常不就可以了吗？具体的代码实现如下所示：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AbstractBird</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">//...省略其他属性和方法...</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//... }</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Ostrich</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractBird</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//鸵鸟</span>
  <span class="token comment" spellcheck="true">//...省略其他属性和方法...</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnSupportedMethodException</span><span class="token punctuation">(</span><span class="token string">"I can't fly.'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>这种设计思路虽然可以解决问题，但不够优美。因为除了鸵鸟之外，不会飞的鸟还有很多，比如企鹅。对于这些不会飞的鸟来说，我们都需要重写 <code>fly()</code> 方法，抛出异常。</p>
<p>这样的设计，一方面，徒增了编码的工作量；另一方面，也违背了我们之后要讲的最小知识原则 <em>(Least Knowledge Principle，也叫最少知识原则或者迪米特法则)</em>，暴露不该暴露的接口给外部，增加了类使用过程中被误用的概率。</p>
<p>你可能又会说，那我们再通过 <code>AbstractBird</code> 类派生出两个更加细分的抽象类：会飞的鸟类 <code>AbstractFlyableBird</code> 和不会飞的鸟类 <code>AbstractUnFlyableBird</code>，让麻雀、乌鸦这些会飞的鸟都继承 <code>AbstractFlyableBird</code>，让鸵鸟、企鹅这些不会飞的鸟，都继承 <code>AbstractUnFlyableBird</code> 类，不就可以了吗？具体的继承关系如下图所示：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay5%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6-%E7%BB%A7%E6%89%BF%E8%AF%A6%E8%A7%A3/f77b3726-9183-42a2-bf29-6cc701d228f8.png" alt=""></p>
<p>从图中我们可以看出，继承关系变成了三层。不过，整体上来讲，目前的继承关系还比较简单，层次比较浅，也算是一种可以接受的设计思路。我们再继续加点难度。在刚刚这个场景中，我们只关注“鸟会不会飞”，但如果我们关注更多的问题，例如 “鸟会不会叫”、”鸟会不会下单“ 等… 那这个时候，我们又该如何设计类之间的继承关系呢？</p>
<p>总之，继承最大的问题就在于：<strong>继承层次过深、继承关系过于复杂会影响到代码的可读性和可维护性</strong>。这也是为什么我们不推荐使用继承。那刚刚例子中继承存在的问题，我们又该如何来解决呢？</p>
<h2 id="组合相比继承有哪些优势？"><a href="#组合相比继承有哪些优势？" class="headerlink" title="组合相比继承有哪些优势？"></a>组合相比继承有哪些优势？</h2><p>实际上，我们可以利用组合 <em>(composition)*、接口、委托 *(delegation)</em> 三个技术手段，一块儿来解决刚刚继承存在的问题。</p>
<p>我们前面讲到接口的时候说过，接口表示具有某种行为特性。针对“会飞”这样一个行为特性，我们可以定义一个 <code>Flyable</code> 接口 <em>(相当于定义某一种行为，下方会有代码说明)</em>，只让会飞的鸟去实现这个接口。对于会叫、会下蛋这些行为特性，我们可以类似地定义 <code>Tweetable</code> 接口、<code>EggLayable</code> 接口。我们将这个设计思路翻译成 Java 代码的话，就是下面这个样子：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Flyable</span> <span class="token punctuation">{</span>
  <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Tweetable</span> <span class="token punctuation">{</span>
  <span class="token keyword">void</span> <span class="token function">tweet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">EggLayable</span> <span class="token punctuation">{</span>
  <span class="token keyword">void</span> <span class="token function">layEgg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Ostrich</span> <span class="token keyword">implements</span> <span class="token class-name">Tweetable</span><span class="token punctuation">,</span> EggLayable <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//鸵鸟</span>
  <span class="token comment" spellcheck="true">//... 省略其他属性和方法...</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">tweet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//... }</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">layEgg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//... }</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Sparrow</span> impelents Flayable<span class="token punctuation">,</span> Tweetable<span class="token punctuation">,</span> EggLayable <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//麻雀</span>
  <span class="token comment" spellcheck="true">//... 省略其他属性和方法...</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//... }</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">tweet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//... }</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">layEgg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//... }</span>
<span class="token punctuation">}</span></code></pre>
<p>不过，我们知道，接口只声明方法，不定义实现。也就是说，每个会下蛋的鸟都要实现一遍 <code>layEgg()</code> 方法，并且实现逻辑是一样的，这就会导致代码重复的问题。那这个问题又该如何解决呢？</p>
<p>我们可以针对三个接口再定义三个实现类，它们分别是：实现了 <code>fly()</code> 方法的 <code>FlyAbility</code> 类、实现了 <code>tweet()</code> 方法的 <code>TweetAbility</code> 类、实现了 <code>layEgg()</code> 方法的 <code>EggLayAbility</code> 类。然后，通过 <strong>组合和委托</strong> 技术来消除代码重复。具体的代码实现如下所示：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Flyable</span> <span class="token punctuation">{</span>
  <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span>；
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlyAbility</span> <span class="token keyword">implements</span> <span class="token class-name">Flyable</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//... }</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//省略Tweetable/TweetAbility/EggLayable/EggLayAbility</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Ostrich</span> <span class="token keyword">implements</span> <span class="token class-name">Tweetable</span><span class="token punctuation">,</span> EggLayable <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//鸵鸟</span>
  <span class="token keyword">private</span> TweetAbility tweetAbility <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TweetAbility</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//组合</span>
  <span class="token keyword">private</span> EggLayAbility eggLayAbility <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EggLayAbility</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//组合</span>
  <span class="token comment" spellcheck="true">//... 省略其他属性和方法...</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">tweet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    tweetAbility<span class="token punctuation">.</span><span class="token function">tweet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 委托</span>
  <span class="token punctuation">}</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">layEgg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    eggLayAbility<span class="token punctuation">.</span><span class="token function">layEgg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 委托</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>当然啦，也可以使用 <code>JDK 1.8</code> 之后支持的接口默认方法：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Flyable</span> <span class="token punctuation">{</span>
    <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// fly的 的默认实现</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>我们知道继承主要有三个作用：表示 <code>is-a</code> 关系，支持多态特性，代码复用。而这三个作用都可以通过其他技术手段来达成。比如：</p>
<ul>
<li><code>is-a</code> 关系，我们可以通过组合和接口的 <code>has-a</code> 关系来替代；</li>
<li>多态特性我们可以利用接口来实现；</li>
<li>代码复用我们可以通过组合和委托来实现；</li>
</ul>
<p>所以，从理论上讲，通过组合、接口、委托三个技术手段，我们完全可以替换掉继承，在项目中不用或者少用继承关系，特别是一些复杂的继承关系。</p>
<h2 id="如何判断该用组合还是继承？"><a href="#如何判断该用组合还是继承？" class="headerlink" title="如何判断该用组合还是继承？"></a>如何判断该用组合还是继承？</h2><p>尽管我们鼓励多用组合少用继承，但组合也并不是完美的，继承也并非一无是处。从上面的例子来看，继承改写成组合意味着要做更细粒度的类的拆分。这也就意味着，我们要定义更多的类和接口。类和接口的增多也就或多或少地增加代码的复杂程度和维护成本。所以，在实际的项目开发中，我们还是要根据具体的情况，来具体选择该用继承还是组合。</p>
<p>如果类之间的继承结构稳定 <em>(不会轻易改变)</em>，继承层次比较浅 *(比如，最多有两层继承关系)，继承关系不复杂，我们就可以大胆地使用继承。反之，系统越不稳定，继承层次很深，继承关系复杂，我们就尽量使用组合来替代继承。</p>
<p>除此之外，还有一些 <strong>设计模式</strong> 会固定使用继承或者组合。比如，<strong>装饰者模式</strong>（decorator pattern）、<strong>策略模式</strong>（strategy pattern）、<strong>组合模式</strong>（composite pattern）等都使用了 <strong>组合关系</strong>，而 <strong>模板模式</strong>（template pattern）使用了 <strong>继承关系</strong>。</p>
<p>前面我们讲到继承可以实现代码复用。利用继承特性，我们把相同的属性和方法，抽取出来，定义到父类中。子类复用父类中的属性和方法，达到代码复用的目的。<strong>但是，有的时候，从业务含义上，A 类和 B 类并不一定具有继承关系</strong>。比如，Crawler 类和 PageAnalyzer 类，它们都用到了 URL 拼接和分割的功能，但并不具有继承关系 <em>(既不是父子关系，也不是兄弟关系)</em>。<strong>仅仅为了代码复用，生硬地抽象出一个父类出来，会影响到代码的可读性</strong>。如果不熟悉背后设计思路的同事，发现 Crawler 类和 PageAnalyzer 类继承同一个父类，而父类中定义的却只是 URL 相关的操作，会觉得这个代码写得莫名其妙，理解不了。这个时候，<strong>使用组合就更加合理、更加灵活</strong>。具体的代码实现如下所示：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Url</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">//...省略属性和方法</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Crawler</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> Url url<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 组合</span>
  <span class="token keyword">public</span> <span class="token function">Crawler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment" spellcheck="true">//...</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PageAnalyzer</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> Url url<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 组合</span>
  <span class="token keyword">public</span> <span class="token function">PageAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment" spellcheck="true">//..</span>
<span class="token punctuation">}</span></code></pre>
<p>还有一些特殊的场景要求我们必须使用继承。<strong>如果你不能改变一个函数的入参类型，而入参又非接口，为了支持多态，只能采用继承来实现</strong>。比如下面这样一段代码，其中 FeignClient 是一个外部类，我们没有权限去修改这部分代码，但是我们希望能重写这个类在运行时执行的 <code>encode()</code> 函数。这个时候，我们只能采用继承来实现了。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FeignClient</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// Feign Client框架代码</span>
  <span class="token comment" spellcheck="true">//...省略其他代码...</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">encode</span><span class="token punctuation">(</span>String url<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//... }</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">demofunction</span><span class="token punctuation">(</span>FeignClient feignClient<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">//...</span>
  feignClient<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">//...</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomizedFeignClient</span> <span class="token keyword">extends</span> <span class="token class-name">FeignClient</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">encode</span><span class="token punctuation">(</span>String url<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//...重写encode的实现...}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// 调用</span>
FeignClient client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CustomizedFeignClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">demofunction</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>尽管有些人说，要杜绝继承，<code>100%</code> 用组合代替继承，但是我的观点没那么极端！之所以 “多用组合少用继承” 这个口号喊得这么响，只是因为，长期以来，我们过度使用继承。还是那句话，组合并不完美，继承也不是一无是处。只要我们控制好它们的副作用、发挥它们各自的优势，在不同的场合下，恰当地选择使用继承还是组合，这才是我们所追求的境界。</p>
<h1 id="要点回顾"><a href="#要点回顾" class="headerlink" title="要点回顾"></a>要点回顾</h1><ol>
<li>继承概述 / 单继承 / <code>is-a</code> 关系 / 类之间的关系 / 层级结构；</li>
<li>继承的实现 / 覆盖方法 / <code>protedcted</code> / 向上转型；</li>
<li>Object 类 / 方法调用 / <code>final</code> / 内联 / 为什么不推荐使用继承；</li>
</ol>
<h1 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h1><p>暂无；</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol>
<li>《Java 核心技术 卷 I》</li>
<li>《Java 编程思想》</li>
<li>《码出高效 Java 开发手册》</li>
<li>设计模式之美 - 为何说要多用组合少用继承？如何决定该用组合还是继承？ - <a href="https://time.geekbang.org/column/article/169593" target="_blank" rel="noopener">https://time.geekbang.org/column/article/169593</a></li>
<li>Introduction to Computer Science using Java - <a href="http://programmedlessons.org/Java9/index.html#part02" target="_blank" rel="noopener">http://programmedlessons.org/Java9/index.html#part02</a> </li>
</ol>
<blockquote>
<ul>
<li>本文已收录至我的 Github 程序员成长系列 <strong>【More Than Java】，学习，不止 Code，欢迎 star：<a href="https://github.com/wmyskxz/MoreThanJava" target="_blank" rel="noopener">https://github.com/wmyskxz/MoreThanJava</a></strong></li>
<li><strong>个人公众号</strong> ：wmyskxz，<strong>个人独立域名博客</strong>：wmyskxz.com，坚持原创输出，下方扫码关注，2020，与您共同成长！</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/common/qrcode.png" alt=""></p>
<p>非常感谢各位人才能 <strong>看到这里</strong>，如果觉得本篇文章写得不错，觉得 <strong>「我没有三颗心脏」有点东西</strong> 的话，<strong>求点赞，求关注，求分享，求留言！</strong></p>
<p>创作不易，各位的支持和认可，就是我创作的最大动力，我们下篇文章见！</p>

      
    </div>
    
      
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post white-box shadow reveal ">
  


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h2 class="title">
    <a href="/2020/08/04/morethanjava-day-4-mian-xiang-dui-xiang-ji-chu/">
      「MoreThanJava」Day 4：面向对象基础
    </a>
  </h2>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a class='author' href="" rel="nofollow">
    <img no-lazy src="">
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/MoreThanJava/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>MoreThanJava</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2020年8月4日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  


            
          
            
              

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/7f300125-846f-4440-95f4-3fb397d7478e.png" alt=""></p>
<ul>
<li><strong>「MoreThanJava」</strong> 宣扬的是 <strong>「学习，不止 CODE」</strong>，本系列 Java 基础教程是自己在结合各方面的知识之后，对 Java 基础的一个总回顾，旨在 <strong>「帮助新朋友快速高质量的学习」</strong>。</li>
<li>当然 <strong>不论新老朋友</strong> 我相信您都可以 <strong>从中获益</strong>。如果觉得 <strong>「不错」</strong> 的朋友，欢迎 <strong>「关注 + 留言 + 分享」</strong>，文末有完整的获取链接，您的支持是我前进的最大的动力！</li>
</ul>
<h1 id="Part-1-面向对象设计概述"><a href="#Part-1-面向对象设计概述" class="headerlink" title="Part 1. 面向对象设计概述"></a>Part 1. 面向对象设计概述</h1><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/5b68f16b-c095-4300-8bb4-4180760f9695.png" alt=""></p>
<p>面向对象程序设计 <em>(Object-Oriented Programming, OOP)</em> 是当今主流的程序设计范型，它取代了 <code>20</code> 世纪 <code>70</code> 年代的 “结构化” 或过程式编程技术。由于 Java 是面向对象的，所以必须熟悉 OOP 才能够很好地使用 Java。</p>
<h2 id="了解抽象"><a href="#了解抽象" class="headerlink" title="了解抽象"></a>了解抽象</h2><p><strong>抽象的作用是将复杂的机制隐藏在一个对象中，仅保留我们与之交互所必须的信息</strong>。</p>
<p>为了说明这一点，我们可以想象平时使用 <strong>「电梯」</strong> 的场景。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/bd4d9df6-9894-48cb-8db5-c6193bab8df8.png" alt="熟悉的早晨等电梯！"></p>
<p>如果您在办公楼工作，这可能是您日常工作的一部分。你按下向上或向下按钮，然后等待门滑开。完成操作后，您进入一个 “盒子”，该 “盒子” 的一面墙上有一个按钮面板，然后按下所需的按钮。当电梯到达您要去到的楼层后，您会挤过其他人然后走出去。</p>
<p><strong>要使用电梯，您只需要了解如何按下正确的按钮就可以达到目的。</strong></p>
<p>而隐藏在电梯背后的支持它工作的一系列东西 —— 滑轮系统、机械、电线、减震器、安全系统等等… 您可以完全不知道也完全不必操心…</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/3d83e081-0ad5-4d2a-a569-48c441a78dbc.png" alt="我完全不知道他们在做什么..."></p>
<p>电梯这个 “铁盒子” 以及相应的按钮面板，就是对整个「运输系统」成功的抽象 <em>(事实上电梯背后还包含检修、维护等一系列事情…)</em>，它隐藏了足够多的细节，也极大地方便了我们的生活。</p>
<h2 id="什么是对象"><a href="#什么是对象" class="headerlink" title="什么是对象"></a>什么是对象</h2><p><strong>简单来说，对象是对现实世界的抽象。</strong> <em>(例如上方对整个运输系统抽象之后，就得到了「电梯」这个对象…)</em></p>
<p>什么东西是对象？什么东西不是对象？这是一个困扰哲学家数千年的问题。勒内·笛卡尔 <em>(17世纪的哲学家)</em> 观察到，人类是用面向对象的方式看待世界的 <em>(例如与电梯的交互)</em>。人类的大脑会从对象的角度认识世界 <em>(例如鸟类、鱼类)</em>，我们的思想和记忆也被组织成物体和它们之间的关系 <em>(例如，鸟吃虫)</em>。</p>
<h3 id="对象像是一种模板"><a href="#对象像是一种模板" class="headerlink" title="对象像是一种模板"></a>对象像是一种模板</h3><p>亚里士多德大概是第一个深入研究 <strong>类型</strong> <em>(type)</em> 的哲学家，它曾经提出过 <strong>鱼类</strong> 和 <strong>鸟类</strong> 这样的概念。<strong>所有的对象都是唯一的，但同时也是具有相同的特性和行为的对象所归属的类的一部分。</strong></p>
<p>这就好像我们拿着一个模具，我们可以使用该模具制作出各种各样东西，每个东西都有自己的 “个性”，但它们又都遵循一些相同的基本模式：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/e03748fe-fd54-4200-9e79-b81f4b2df0b9.png" alt=""></p>
<h3 id="对象的特征"><a href="#对象的特征" class="headerlink" title="对象的特征"></a>对象的特征</h3><p>我们可以把你的「银行账户」抽象成一个对象，但它不是由物质构成的。<em>(虽然您和银行可以使用纸张和其他材料来记录您的账户，但您的账户独立于这些材料而存在。)</em></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/4dceb90b-0dfc-4548-9d07-8fce72749155.png" alt=""></p>
<p>虽然它不是物质的，但你的账户是有 <strong>属性</strong> 的 <em>(余额、利率、持有者等..)</em>，<strong>你可以对它做一些事情</strong> <em>(存款、取款、查看余额等..,)</em>，<strong>它自己也可以做一些事情</strong> <em>(交易收费、积累利息等…)</em>。</p>
<p>这足够清楚吧。事实上，这些特征它们都有名字：</p>
<ul>
<li>对象具有 <strong>标识 identity</strong>；<em>(每个对象都是独立的个体)</em></li>
<li>对象具有 <strong>状态 state</strong>；<em>(它具有各种可能会改变的属性)</em></li>
<li>对象具有 <strong>行为 behavior</strong>；<em>(它可以做事情，也可以让别人对它做事情)</em></li>
</ul>
<p>这就是对一个物体的一般描述。<em>(上面的列表来自于 <code>1994</code> 年 <code>Grady Booch</code>/<code>Addison-Wesley</code> 出版的《面向对象分析与设计》一书。)</em> 当你开始编写面向对象的软件时，你会发现这个列表将帮助你决定你的对象应该是什么样。</p>
<h2 id="编程语言中的抽象过程"><a href="#编程语言中的抽象过程" class="headerlink" title="编程语言中的抽象过程"></a>编程语言中的抽象过程</h2><p>所有编程语言都提供抽象机制。<strong>可以认为，人们所能够解决的问题的复杂性直接取决于抽象的类型和质量</strong>。</p>
<p>所谓的 “类型” 是指 “所抽象的是什么？”。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/efecfb0e-7614-4233-95e1-dbefa942f05f.png" alt=""></p>
<p>汇编语言是对底层机器语言的轻微抽象，接着出现的许多 “命令式” 语言 <em>(如 FORTRAN、BASIC、C 等..)</em> 都是对汇编语言的进一步抽象。</p>
<p>这些语言在汇编语言基础上有了很大幅度的改进，但是它们所作的主要抽象仍要求在解决问题时要基于计算机的结构，而不是基于所要解决的问题的结构来考虑。</p>
<blockquote>
<p>传统的结构化程序设计通过设计一系列的过程 <em>(即算法)</em> 来求解问题。一旦确定了这些过程，就要开始考虑存储数据的适当方式。</p>
<p>这就是 <code>Pascal</code> 语言的设计者 <code>Niklaus Wirth</code> 将其著作命名为《算法 + 数据结构 = 程序》<em>(Algorithms + Data Structures = Programs, Prentice Hall, <code>1975</code>)</em> 的原因。</p>
<p>需要注意的是，在 <code>Wirth</code> 的这个书名中，算法是第一位的，数据结构是第二位的，这就明确的表述了程序员的工作方式。首先要确定如何操作数据，然后再决定如何组织数据的结构，以便于操作数据。</p>
<p>而 OOP 却调换了这个次序，将数据放在第一位，然后再考虑操作数据的算法。<em>(在 OOP 中，也有说法是：程序 = 对象 + 交互)</em></p>
</blockquote>
<p>这使得程序员必须建立起在 <strong>机器模型</strong> <em>(位于 “解空间” 内，这是你对问题建模的地方，例如计算机)</em> 和 <strong>实际需要解决问题的模型</strong> <em>(位于 “问题空间” 内，这是问题存在的地方，例如一项业务)</em> 之间的 <strong>关联</strong>。</p>
<p>建立这种映射是费力的，而且这不属于编程语言固有的功能，这使得程序难以编写，并且维护代价高昂，同时也产生了作为副产物的整个 “编程方法” 行业。</p>
<h2 id="面向对象思想的突破"><a href="#面向对象思想的突破" class="headerlink" title="面向对象思想的突破"></a>面向对象思想的突破</h2><p>另一种对机器建模的方式就是针对待解问题建模。</p>
<p>早期的编程语言，例如 <code>LISP</code> 和 <code>APL</code>，都是选择一些特定的视角来 “解释世界” <em>(分别敌营 “所有问题最终都是列表” 或者 “所有问题都是算法形式的”)</em>。<code>PROLOG</code> 则将所有问题都转换成决策链。此外还产生了基于约束条件编程的语言和专门通过对图形符号操作来实现编程的语言 <em>(后来被证明限制性过强)</em>。</p>
<p>这些方式对于它们本身所要解决的 <strong>特定类型的问题</strong> 都是不错的解决方案，但是一旦 <strong>超出</strong> 其特定领域，它们就力不从心了。</p>
<p><strong>面向对象的方式通过向程序员提供表示问题空间中的元素的工具而更近了一步。</strong></p>
<p>这种表示方式非常通用，使得程序员不会受限于任何特定类型的问题。我们把问题空间中的一些基本元素进一步抽象成解空间中的 “对象”。<strong>这种思想的实质是：程序可以通过添加新类型的对象使其自身适用于某个特定的问题</strong>。</p>
<p>因此，当你在阅读描述解决方案的代码的同时，也是在阅读问题的表述。相比之前的语言，这是一种更灵活和更强力的语言抽象。所以，OOP 允许根据问题来描述问题，而不是根据运行解决方案的计算机来描述问题。</p>
<p>面向对象软件的最重要的突破之一就是允许我们按照 <strong>自然的面向对象的大脑思维方式相匹配的方式组织软件</strong>。我们希望使用具有属性并能够与其他对象进行交互的对象，而不是直接使用更改主存储器中的 bit 数据的机器指令。当然，在机器层面上什么也没有改变——bit 数据仍是由机器指令操作的，但至少我们不用再考虑机器指令了！</p>
<blockquote>
<p>对于一些规模较小的问题，将其分解为过程的开发方式比较理想。面向对象更加适合解决规模较大的问题。要想实现一个简单的 Web 浏览器可能需要大约 <code>2000</code> 个过程，这些过程可能需要对一组全局数据进行操作。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/26f7288b-2df2-41f1-a410-482a3867c548.png" alt=""></p>
<p>采用面向对象的设计风格，可能只需要大约 <code>100</code> 个类，每个类平均包含 <code>20</code> 个方法。这明显易于程序员掌握，也容易找到 BUG。<em>(假设给定对象的数据出错了，在访问这个数据项的 <code>20</code> 个方法中查找错误要比在 <code>2000</code> 个过程中查找要容易多了)</em></p>
</blockquote>
<h2 id="OOP-的起源"><a href="#OOP-的起源" class="headerlink" title="OOP 的起源"></a>OOP 的起源</h2><p>正如我们上面描述的那样，面向对象的编程是当今不可回避的。让我们来看看它是如何变成现实的。</p>
<p>时间回到上世纪 <code>60</code> 年代，那个时候计算机图形还不存在。当时，美国计算机科学家 <code>Ivan Edward Sutherland</code> 实现了能够绘图的应用程序，名叫：<strong>SketchPad</strong>。</p>
<p>它是专门为设计人员开发的，它允许设计人员使用手写笔通过计算机绘制简单的几何形状，例如三角形、正方形、圆形等。该项目也是 <strong>计算机辅助设计 CAD</strong> 的起点。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/c83e1ee3-dc92-4076-a30f-466d8e689fbb.png" alt="SketchPad"></p>
<p>这成为了面向对象编程的 <strong>奠基典范</strong> 之一。</p>
<p>因为在 Ivan 的程序设计中，使用了我们现在称为 “对象” 的表现形式来描述现实生活中的几何图形，这些图形对于设计人员来说是完全可以理解的！</p>
<p>这其中没有无穷无尽的变量和函数，而是通过具体的几何图形 <em>(对象形式)</em> 来描述 <em>(包括上下文数据，都存储在变量中)</em> 和操作 <em>(函数实现)</em> 进行分组，并以一种关系进行管理这些特定的元素。</p>
<p>这些东西在现在都有确切的名称。<em>(分别对应 “属性” 和 “方法”)</em></p>
<h2 id="OOP-的规范化"><a href="#OOP-的规范化" class="headerlink" title="OOP 的规范化"></a>OOP 的规范化</h2><p>Ivan 的项目和其他一些项目在 <code>1967</code> 年影响了 <strong>Simula</strong> 编程语言。该语言第一次直接将面向对象的思想引入到了 编程语言中 <em>(重大更新之后被称为 <code>Simula-67</code>)</em>。 </p>
<p><code>1970</code> 年代，<strong>Xerox</strong> <em>(负责鼠标和图形界面的发明)</em> 在个人电脑上工作。他们希望通过操纵 GUI 和鼠标来创建任何人都可以轻松使用的计算机。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/ebee7ece-d2db-48fc-bc92-d40ff6620a6a.png" alt="最早的个人计算机之一"></p>
<p>为了表示屏幕上的所有元素并支持其显示和操作的逻辑，由艾伦·凯 <em>(Alan Kay)</em> 领导的团队创建了 <strong>SmallTalk</strong> 语言，该语言的灵感来自 <strong>Simula</strong>。根据许多资料显示，这标志着我们今天使用的面向对象编程概念的正式确立！ </p>
<h2 id="OOP-的普及化"><a href="#OOP-的普及化" class="headerlink" title="OOP 的普及化"></a>OOP 的普及化</h2><p>上述这些方法在 <code>1981</code> 年开始流行，并成为了伟大的面向对象语言的起点，例如：</p>
<ul>
<li><strong>Objective-C</strong> 是 iOS 本机开发的原始语言。从那以后，Apple 对其进行了改进和增强，它仍然是 iOS 开发人员的常见选择。</li>
<li><strong>C ++</strong> 是 C 编程语言的面向对象版本。C 和 C++ 仍被广泛使用，尤其是在非常专业的行业中。 </li>
</ul>
<p>如我们所见，在编程方面取得了令人难以置信的进步，这是对以下问题的解决方案：<strong>简化软件开发！</strong></p>
<blockquote>
<p><strong>面向对象设计的特殊效率从何而来？</strong></p>
<ul>
<li>部分影响来自于更清晰的表达复杂系统的方式；</li>
<li>也许最重要的原因 <em>（也是从操作系统体系结构派生而来的）</em> 是，当您给某人一个结构时，您很少希望他们拥有无限的特权。仅仅进行类型匹配甚至还不能满足需求。保护某些对象而不保护某些对象也不是非常合理有用。</li>
</ul>
<p>正确执行封装不仅是对状态抽象的承诺，而且是消除编程中面向状态的隐喻的一种承诺。</p>
</blockquote>
<h1 id="Part-2-类与对象概述"><a href="#Part-2-类与对象概述" class="headerlink" title="Part 2. 类与对象概述"></a>Part 2. 类与对象概述</h1><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/19a4aac1-863c-4786-adf5-8350b166ed7f.png" alt=""></p>
<ul>
<li>图片来源：<a href="https://javatutorial.net/java-oop" target="_blank" rel="noopener">https://javatutorial.net/java-oop</a></li>
</ul>
<p><strong>简单的说，类是对象的蓝图或模板，而对象是类的实例。</strong></p>
<p>这个解释虽然有点像用概念在解释概念，但是从这句话我们至少可以看出，<strong>类是抽象的概念，而对象是具体的东西</strong>。</p>
<p>在面向对象编程的世界中，一切皆为对象，对象都有属性和行为，每个对象都是独一无二的，而且对象一定属于某个类 <em>(型)*。当我们把一大堆拥有共同特征的对象的静态特征 *(属性)</em> 和动态特征 <em>(行为)</em> 都抽取出来后，就可以定义出一个叫做 <strong>“类”</strong> 的东西。</p>
<h2 id="定义类"><a href="#定义类" class="headerlink" title="定义类"></a>定义类</h2><p>使用类几乎可以模拟任何东西。假设我们要编写一个表示小狗 Dog 的简单类 —— 它表示的不是特定的小狗，而是任何小狗。</p>
<p>对于大多数宠物狗，我们都知道些什么呢？—— 它们都有名字和年龄，还会叫、会吃东西。由于大多数的小狗都具备上述两项信息 <em>(名字和年龄)</em> 和两种行为 <em>(叫和吃东西)</em>，所以我们的 Dog 类将包含它们，这个类看上去会是这样：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/a1b36ab3-0c58-451d-be4a-d280bc338f44.png" alt=""></p>
<p>代码实现起来大概会像这样：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">// 参数</span>
    <span class="token keyword">private</span> String name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> Integer age<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// 构造器</span>
    <span class="token keyword">public</span> <span class="token function">Dog</span><span class="token punctuation">(</span>String name<span class="token punctuation">,</span> Integer age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// 字段访问器</span>
    <span class="token keyword">public</span> String <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// 字段访问器</span>
    <span class="token keyword">public</span> Integer <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// 方法 - 叫</span>
    <span class="token keyword">void</span> <span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"汪汪汪！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// 方法 - 吃东西</span>
    <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"一只"</span> <span class="token operator">+</span> age <span class="token operator">+</span> <span class="token string">"岁大的名叫 "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">" 的狗正在吃东西！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="剖析-Dog-类"><a href="#剖析-Dog-类" class="headerlink" title="剖析 Dog 类"></a>剖析 Dog 类</h3><p>下面各个部分我们将对上面描述的 Dog 类进行剖析。首先从这个类的方法开始吧，上述源码我们看到，这个类包含一个构造器和四个方法：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token function">Dog</span><span class="token punctuation">(</span>String name<span class="token punctuation">,</span> Integer age<span class="token punctuation">)</span>
<span class="token keyword">public</span> String <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Integer <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>这个类的所有方法都被标记为 <code>public</code>。关键字 <code>public</code> 意味着任何类的任何方法都可以调用这些方法 <em>(共有四种访问级别，将在之后介绍到)</em></p>
<p>接下来，还需要注意 Dog 类实例中有 <code>2</code> 个实例字段用来存放将要操作的数据：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> String name<span class="token punctuation">;</span>
<span class="token keyword">private</span> Integer age<span class="token punctuation">;</span></code></pre>
<p>关键字 <code>private</code> 确保只有 Dog 类自身的方法能够访问到这些实例字段，而其他类的方法不能够读写这些字段。<em>(这也是 Private 私有本身的含义)</em></p>
<blockquote>
<p><strong>注意</strong>：虽然可以用 <code>public</code> 标记实例字段，但这是一种很不好的做法。<code>public</code> 修饰数据字段后，程序中的任何方法都可以对其进行读取和修改，这就完全破坏了 <strong>封装</strong>。<em>(这会使程序非常不可控)</em> 强烈建议将实力字段标记为 <code>private</code></p>
</blockquote>
<p>最后，请注意，<strong>这两个实例字段本身也是对象</strong>：<code>name</code> 字段是 <code>String</code> 类型的对象，<code>age</code> 是 <code>Integer</code> 类型的对象。这种情况十分常见：类包含的实例字段通常属于某个类类型。</p>
<h3 id="从构造器开始"><a href="#从构造器开始" class="headerlink" title="从构造器开始"></a>从构造器开始</h3><p>这个与类名相同且权限为 <code>public</code> 的方法 <code>Dog()</code> 我们把它称为 <strong>构造器</strong>，让我们来看看它：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token function">Dog</span><span class="token punctuation">(</span>String name<span class="token punctuation">,</span> Integer age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>在构造 Dog 类对象的时候，构造器会运行，从而将实例字段初始化为所希望的初始状态。</p>
<p>例如，当时用下面这条代码创建 Dog 类时：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">"大黄"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></code></pre>
<p>将会把数据设置为：</p>
<pre class=" language-text"><code class="language-text">name = "大黄"
age = 1</code></pre>
<p>构造器与其他方法有一个重要的不同。构造器总是结合 <code>new</code> 关键字来调用。不能对一个已经存在的对象调用构造器来达到重新设置属性的目的。例如 <em>(下方代码将产生编译错误)</em>：</p>
<pre class=" language-java"><code class="language-java">dogInstance<span class="token punctuation">.</span><span class="token function">Dog</span><span class="token punctuation">(</span><span class="token string">"小黄"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ERROR</span></code></pre>
<p>有关构造器还有很多可以说的地方，现在只需要记住：</p>
<ul>
<li>构造器与类同名；</li>
<li>每个类可以有一个以上的构造器；</li>
<li>构造器可以有 <code>0</code> 个、<code>1</code> 个或多个参数；</li>
<li>构造器没有返回值；</li>
<li>构造器总是伴随着 <code>new</code> 操作符一起调用。</li>
</ul>
<h3 id="封装的优点"><a href="#封装的优点" class="headerlink" title="封装的优点"></a>封装的优点</h3><p>最后仔细看一下非常简单的 <code>getName</code>/<code>getAge</code> 方法。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> String <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> Integer <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>这些都是典型的访问器方法。由于它们只返回实例字段值，因此又称为 <strong>字段访问器</strong>。</p>
<p>如果将 <code>name</code>、<code>age</code> 字段标记为 <code>public</code>，允许任意方法访问，而不是编写单独的访问其方法，难道不是更容易一些嘛？</p>
<p>上面的例子似乎并不明显 <em>(而且 <code>name</code> 还是一个只读字段)</em>，所以为了说明这一点，我们来举一个更加有趣的例子。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/c0dcc95b-b595-4c3e-803b-f4771eb1b1c0.png" alt=""></p>
<p>假设我们有两个类，男人正在辛苦挣钱并时不时地查看余额，而此时来了一个小偷，专门偷男人的钱，<strong>逮着一个偷一个</strong>，而被偷了之后男人抓到了小偷，此时由于小偷的钱是私有的，<strong>男人抓着小偷咬牙切齿却没有丝毫办法可以把钱拿回来！</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/5dcf13d6-6dff-4432-8da5-33788c151311.gif" alt=""></p>
<p>封装不仅仅帮助我们提高安全性，更可以简化操作和提高 <strong>内聚性</strong>。</p>
<p>假设你写了一个很庞大的系统，一开始你的定义是这样的：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span></code></pre>
<p>你的程序里大概有 <code>100</code> 条类似于这样的语句：</p>
<pre class=" language-java"><code class="language-java">instance<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></code></pre>
<p>此时突然要求你把数据类型变一下或者对这个字段其他一些什么统一的处理，需要修改 <code>100</code> 处的你，是不是傻了？</p>
<p><strong>封装的另一个好处是模块化</strong>。这方便我们把散落在各处的代码收拢并做统一的处理。</p>
<blockquote>
<p>设计模式器大原则之一的 <strong>迪米特法则</strong> 就是对于封装的具体要求，即 A 模块使用 B 模块的某个接口行为，对 B 模块中除此行为之外的其他信息知道得尽可能少。</p>
<p>比如：耳塞的插孔就是提供声音输出的行为接口，只需要关心这个插孔是否有相应的耳塞标记，是否是圆形，有没有声音即可，至于内部 CPU 如何运算音频信息，以及各个电容如何协同工作，根本不需要关注，这使得模块之间的协作只需忠于接口、忠于功能实现即可。</p>
</blockquote>
<h2 id="创建和使用类"><a href="#创建和使用类" class="headerlink" title="创建和使用类"></a>创建和使用类</h2><p>定义了 <code>class</code> 只是定义了对象模板，而要根据模板创建出真正的对象实例，必须使用 <code>new</code> 关键字，并调用对象的构造函数才行：</p>
<pre class=" language-java"><code class="language-java">Dog dog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">"大黄"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>上述代码创建了一个 <code>Dog</code> 类型的实例，并通过变量 <code>dog</code> 指向它。<em>(下面我们将详细说明是怎么 “指向” 它的…)</em></p>
<p>第一个 <code>Dog</code> 表明了 <code>dog</code> 变量的类型，第二个 <code>Dog</code> 则是调用了 <code>Dog</code> 类的构造函数。在 <strong>Java 10</strong> 中，如果可以从变量的初始值推导出它们的类型，那么可以用 <code>var</code> 关键字来声明局部变量，而无须指定类型。例如：</p>
<pre class=" language-java"><code class="language-java">var dog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">"大黄"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>这一点很好，因为可以避免重复写类型名 <code>Dog</code>。但是参数和字段的类型还是必须显式地声明，该用法仅能用于方法中的局部变量。</p>
<p>要想使用类中公用方法，我们可以直接使用 <code>.</code> <em>(英文句号)</em> 来连接类中的方法并调用：</p>
<pre class=" language-java"><code class="language-java">dog<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 调用该实例的 eat() 方法</span></code></pre>
<h2 id="Java-使用引用来操纵对象"><a href="#Java-使用引用来操纵对象" class="headerlink" title="Java 使用引用来操纵对象"></a>Java 使用引用来操纵对象</h2><p>每种编程语言都有自己的操纵内存中元素的方式。有时候，程序员必须注意将要处理的数据是什么类型。你是直接操纵元素，还是用某种基于特殊语法的间接表示 <em>(例如 C 和 C++ 里的指针)</em> 来操纵对象？</p>
<p><strong>在 Java 中一切都被视为对象</strong>，这使得我们可以使用固定的语法。尽管这一切都看作对象，但操纵的标识符 <em>(例如上面的 <code>dog</code> 变量)</em> 实际上是 <strong>对象的一个 “引用”</strong> <em>(reference)</em>。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/d319dcdb-166a-4804-b16c-785721d07b06.png" alt=""></p>
<p>只要握住这个遥控器，就能保持与电视机的连接。当有人想改变频道或减小音量时，实际操纵的是遥控器 <em>(引用)</em>，再由控制器来调控电视机 <em>(对象)</em>。</p>
<p>如果想在房间里四处走走，同时仍能调控电视机，那么只需要携带遥控器就可以了，而不是背着电视机…</p>
<p><strong>此外，即使没有电视机，遥控器也可以独立存在</strong>。</p>
<p>也就是说，你拥有一个引用，并不一定需要有一个对象与它关联。因此，如果你想操纵一个词或者一个句子，则可以创建一个 <strong>String</strong> 对象：</p>
<pre class=" language-java"><code class="language-java">String s<span class="token punctuation">;</span></code></pre>
<p>但是这里创建的只是引用，并不是对象。如果此时向 <code>s</code> 发送一个消息，就会返回一个运行时错误。这是因为此时 <code>s</code> 实际上没有与任何事物相关联 <em>(即没有电视机)</em>。</p>
<p><strong>因此，一种安全的做法是：创建一个引用的同时便进行初始化。</strong></p>
<pre class=" language-java"><code class="language-java">String s <span class="token operator">=</span> <span class="token string">"abcd"</span><span class="token punctuation">;</span></code></pre>
<p>这里运用到了 Java 语言的一个特性：字符串可以直接使用带引号的文本进行初始化 <em>(其他对象需要使用 <code>new</code>)</em>。</p>
<h3 id="null-引用"><a href="#null-引用" class="headerlink" title="null 引用"></a>null 引用</h3><p>上面我们已经了解到，一个对象变量包含一个对象的引用。当引用没有关联对象时，实际上指向了一个特殊的值 <code>null</code>，这表示它没有引用任何对象。<em>(可以理解为 <code>String s;</code> 等同于 <code>String s = null;</code>)</em></p>
<p>听上去这是一种处理特殊情况的便捷机制，如未知的名字。但使用 <code>null</code> 值需要非常小心！如果对 <code>null</code> 值应用一个方法，那么就会产生一个 <code>NullPointException</code> 异常。</p>
<pre class=" language-java"><code class="language-java">String s <span class="token operator">=</span> null<span class="token punctuation">;</span>
System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// NullPointException</span></code></pre>
<p>这是一个很严重的错误！如果你的程序没有 “捕获” <em>(理解为手动检测和处理)</em> 异常，程序就会终止！正常情况下，程序并不会捕获这些异常，而是依赖于程序员从一开始就不要带来异常。<em>(这显然很难..)</em></p>
<p>定义一个类时，最好清楚的知道哪些字段可能为 <code>null</code>。在我们的例子中 <em>(Dog 类)</em>，我们不希望 <code>name</code> 和 <code>age</code> 字段为 <code>null</code>。</p>
<p>对此我们有两种解决方法。</p>
<p><strong>“宽容型” 方法</strong> 是把 <code>null</code> 参数转换为一个适当的非 <code>null</code> 值：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    name <span class="token operator">=</span> <span class="token string">"unknow"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    name <span class="token operator">=</span> n<span class="token punctuation">;</span> 
<span class="token punctuation">}</span></code></pre>
<p>在 <strong>Java 9</strong> 中，<code>Objects</code> 类 <em>(JDK 自带的工具类)</em> 对此提供了一个便利方法：</p>
<pre class=" language-java"><code class="language-java">name <span class="token operator">=</span> Objects<span class="token punctuation">.</span><span class="token function">requireNonNullElse</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token string">"unknow"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 效果与上面代码等同</span></code></pre>
<p><strong>“严格型” 方法</strong> 则是干脆拒绝 <code>null</code> 参数：</p>
<pre class=" language-java"><code class="language-java">name <span class="token operator">=</span> Objects<span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token string">"The name cannot be null!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>如果把上述代码添加进 <code>Dog</code> 类的构造函数，并且有人用 <code>null</code> 名字构造了一个 <code>Dog</code> 类，就会产生一个 <code>NullPointerException</code> 异常。乍看上去，这种做法似乎不太好，但有以下几个好处：</p>
<ol>
<li>异常报告会提供这个问题的描述；<em>(也就是 <code>The name cannot be null!</code>)</em></li>
<li>异常报告会准确地支出问题所在的位置，否则异常可能在其他地方出现，而很难追踪到真正导致问题的这个构造器参数；</li>
</ol>
<h1 id="Part-3-面向对象的四大特性"><a href="#Part-3-面向对象的四大特性" class="headerlink" title="Part 3. 面向对象的四大特性"></a>Part 3. 面向对象的四大特性</h1><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/cfeaa75b-ab0f-493d-8173-20e49cbcac1b.png" alt=""></p>
<ul>
<li>图片来源：<a href="https://flashgene.com/archives/51547.html" target="_blank" rel="noopener">https://flashgene.com/archives/51547.html</a></li>
</ul>
<p>面向对象有三大特性：<strong>封装</strong>、<strong>继承</strong>、<strong>多态</strong>。有的地方支持把 <strong>“抽象”</strong> 也归纳进来，合并称为面向对象的四大特性。我觉得也无可厚非。</p>
<p><em>(关于继承和多态会在后续章节里面详细说明, 这里只作简单描述用于简单理解..)</em></p>
<h2 id="抽象"><a href="#抽象" class="headerlink" title="抽象"></a>抽象</h2><p>抽象是面相对象思想最基础的能力之一，正确而严谨的业务抽象和建模分析能力是后续的封装、继承、多态的基础，是软件大厦的基石。<em>(上面有专门的一节描述，这里不再展开)</em></p>
<h2 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h2><p>正如我们上面 <strong>男人与小偷</strong> 的例子，封装不仅能提高我们的安全性、帮助我们把实现细节隐藏起来，还是一种对象功能内聚的表现形式，这有助于让模块之间的耦合度变低，也更具有维护性。<em>(封装的优点上方有介绍，这里也不再展开)</em></p>
<p>封装使面向对象的世界变得单纯，对象之间的关系变得简单，”自扫门前雪” 就行了。特别是当今智能化的时代，对封装的要求越来越高了，例如 <strong>小爱同学</strong> 好了，对外的唯一接口就是语音输入，隐藏了指令内部的细节实现和相关数据，这大大降低了使用成本，也有效地保护了内部数据安全。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/5edae3e9-dbd8-4562-8fab-945b36eb68d4.png" alt=""></p>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>继承允许创建 <strong>具有逻辑等级结构的类体系</strong>，形成一个继承树。就拿我们上面创建的 <strong>Dog</strong> 类来说明吧，不是只有狗拥有那些属性和方法，猫也有！<em>(可能猫叫不能用 <code>bark</code> 表示，但本质都是叫)</em> 自然界中，有许多动物 <em>(动物是对这些生物的自然抽象)</em> 都有这样的行为，那么好了，我们往上再抽象一个 <code>Animal</code> 对象：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/f4970969-e654-4bed-957b-fe5a3881cbc4.png" alt=""></p>
<p>只要继承自 <code>Animal</code> 类，那么就会拥有 <code>Animal</code> 这个父类所描述的属性和方法 <em>(子类当然可以有自己的实现，这一点我们在后续章节中详细描述)</em>。这让软件在业务多变的客观条件下，某些基础模块可以被直接复用、间接复用或增强复用。</p>
<p><strong>继承把枯燥的代码世界变得更有层次感，更具有扩展性，为多态打下了语法基础。</strong></p>
<p>不过继承也有几个 <strong>缺点</strong>：</p>
<ol>
<li>继承是一种 <strong>强耦合</strong> 的关系，父类如果做出一定改变，那么子类也必然会改变；</li>
<li>继承 <strong>破坏了封装</strong>，对于子类而言，它的实现对子类来说都是透明的；</li>
</ol>
<h2 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h2><p><strong>多态是以上述的三个面向对象特征为基础</strong>，根据运行时的实际对象类型，同一个方法产生不同的运行结果，使同一个行为具有不同的表现形式。</p>
<p>太学术化了一点，举个例子可能明白点。比如，有一杯水，我不知道它是温的、冰的还是烫的，但是我一摸我就知道了，我摸水杯的这个动作 <em>(方法)</em>，对于不同温度的水 <em>(运行时不同的对象类型)</em>，就会得到不同的结果，这就是多态。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay4%EF%BC%9A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80/ae55c7cc-ea6e-45f6-8014-307eb774bb38.png" alt=""></p>
<p>自然界中最典型的例子就是碳家族。如果你告诉你的女朋友将在她的生日晚会上送她一块碳，女朋友当然不高兴了，可事实上却是 5 克拉的钻石。钻石就是碳元素在不断进化过程中的一种多态表现。</p>
<p>严格意义来说，多态并不是面向对象的一种特质，而是一种由继承行为衍生而来的进化能力而已。</p>
<p>(完)</p>
<h1 id="要点回顾"><a href="#要点回顾" class="headerlink" title="要点回顾"></a>要点回顾</h1><ol>
<li>类和对象 - 什么是类 / 什么是对象 / OOP 起源和发展 / 面向对象其他相关概念</li>
<li>定义类 - 基本结构 / 属性和方法 / 构造器</li>
<li>使用对象 - 创建对象 / 给对象发消息</li>
<li>面向对象的四大支柱 - 抽象 / 封装 / 继承 / 多态的简单介绍</li>
<li>基础练习 - 定义 Dog 类 / 定义时钟类 / 定义图形类 <em>(下方)</em></li>
</ol>
<h1 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h1><h2 id="练习-1：定义一个类描述数字时钟"><a href="#练习-1：定义一个类描述数字时钟" class="headerlink" title="练习 1：定义一个类描述数字时钟"></a>练习 1：定义一个类描述数字时钟</h2><p>参考答案：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Clock</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> Integer hour<span class="token punctuation">;</span>
    <span class="token keyword">private</span> Integer minute<span class="token punctuation">;</span>
    <span class="token keyword">private</span> Integer second<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Clock</span><span class="token punctuation">(</span>Integer hour<span class="token punctuation">,</span> Integer minute<span class="token punctuation">,</span> Integer second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>hour <span class="token operator">=</span> hour<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>minute <span class="token operator">=</span> minute<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>second <span class="token operator">=</span> second<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * 时钟走字(走1s)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        second <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>second<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            second <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            minute <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>minute<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                minute <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                hour <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>hour<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    hour <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * 显示当前时间
     * @return
     */</span>
    <span class="token keyword">public</span> String <span class="token function">showCurrentTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> String<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"当前时间是：%d时:%d分:%d秒"</span><span class="token punctuation">,</span> hour<span class="token punctuation">,</span> minute<span class="token punctuation">,</span> second<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * 内部测试
     * @throws InterruptedException - 使用 Thread.sleep() 需要手动检测该异常, 这里节约篇幅直接抛出
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token punctuation">{</span>
        Clock clock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Clock</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            clock<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>clock<span class="token punctuation">.</span><span class="token function">showCurrentTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 让当前线程睡 1s</span>
            Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="练习-2：定义一个类描述平面上的点并提供移动点和计算到另一个点距离的方法"><a href="#练习-2：定义一个类描述平面上的点并提供移动点和计算到另一个点距离的方法" class="headerlink" title="练习 2：定义一个类描述平面上的点并提供移动点和计算到另一个点距离的方法"></a>练习 2：定义一个类描述平面上的点并提供移动点和计算到另一个点距离的方法</h2><p>参考答案：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> Integer x<span class="token punctuation">;</span>
    <span class="token keyword">private</span> Integer y<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">Point</span><span class="token punctuation">(</span>Integer x<span class="token punctuation">,</span> Integer y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * 移动到指定位置
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">moveTo</span><span class="token punctuation">(</span>Integer x<span class="token punctuation">,</span> Integer y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * 移动指定的距离
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">moveBy</span><span class="token punctuation">(</span>Integer dx<span class="token punctuation">,</span> Integer dy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+=</span> dx<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">+=</span> dy<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * 计算并返回与另一个点的距离
     */</span>
    <span class="token keyword">public</span> Double <span class="token function">distanceTo</span><span class="token punctuation">(</span>Point other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> dx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">-</span> other<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
        <span class="token keyword">int</span> dy <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">-</span> other<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>dx <span class="token operator">^</span> <span class="token number">2</span> <span class="token operator">+</span> dy <span class="token operator">^</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * 当前的坐标信息
     */</span>
    <span class="token keyword">public</span> String <span class="token function">currentLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> String<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"当前点横坐标：%d，纵坐标：%d"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * 内部测试
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Point point1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Point point2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>point1<span class="token punctuation">.</span><span class="token function">currentLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>point2<span class="token punctuation">.</span><span class="token function">currentLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        point2<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>point2<span class="token punctuation">.</span><span class="token function">currentLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>point1<span class="token punctuation">.</span><span class="token function">distanceTo</span><span class="token punctuation">(</span>point2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol>
<li>《Java 核心技术 卷 I》</li>
<li>《Java 编程思想》</li>
<li>《码出高效 Java 开发手册》</li>
<li>Deepen your knowledge by learning Object Oriented Programming (OOP) with Swift - <a href="https://openclassrooms.com/en/courses/4542221-deepen-your-knowledge-by-learning-object-oriented-programming-oop-with-swift" target="_blank" rel="noopener">https://openclassrooms.com/en/courses/4542221-deepen-your-knowledge-by-learning-object-oriented-programming-oop-with-swift</a></li>
<li>Think like a computer: the logic of programming - <a href="https://openclassrooms.com/en/courses/5261196-think-like-a-computer-the-logic-of-programming" target="_blank" rel="noopener">https://openclassrooms.com/en/courses/5261196-think-like-a-computer-the-logic-of-programming</a></li>
<li>Introduction to Computer Science using Java - <a href="http://programmedlessons.org/Java9/index.html#part02" target="_blank" rel="noopener">http://programmedlessons.org/Java9/index.html#part02</a></li>
<li>Python 100 天从新手到大师 - <a href="https://github.com/jackfrued/Python-100-Days" target="_blank" rel="noopener">https://github.com/jackfrued/Python-100-Days</a></li>
</ol>
<blockquote>
<ul>
<li>本文已收录至我的 Github 程序员成长系列 <strong>【More Than Java】，学习，不止 Code，欢迎 star：<a href="https://github.com/wmyskxz/MoreThanJava" target="_blank" rel="noopener">https://github.com/wmyskxz/MoreThanJava</a></strong></li>
<li><strong>个人公众号</strong> ：wmyskxz，<strong>个人独立域名博客</strong>：wmyskxz.com，坚持原创输出，下方扫码关注，2020，与您共同成长！</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/common/qrcode.png" alt=""></p>
<p>非常感谢各位人才能 <strong>看到这里</strong>，如果觉得本篇文章写得不错，觉得 <strong>「我没有三颗心脏」有点东西</strong> 的话，<strong>求点赞，求关注，求分享，求留言！</strong></p>
<p>创作不易，各位的支持和认可，就是我创作的最大动力，我们下篇文章见！</p>

      
    </div>
    
      
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post white-box shadow reveal ">
  


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h2 class="title">
    <a href="/2020/07/31/hao-wen-tui-jian-hei-mei-os-shou-ce-shi-ru-he-xiang-xi-chan-shu-di-ceng-de-jin-cheng-he-xian-cheng-mo-xing-de/">
      【好文推荐】黑莓OS手册是如何详细阐述底层的进程和线程模型的？
    </a>
  </h2>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a class='author' href="" rel="nofollow">
    <img no-lazy src="">
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/MoreThanJava/%E5%A4%9A%E7%BA%BF%E7%A8%8B/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>MoreThanJava/多线程</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2020年7月31日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  


            
          
            
              

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/db1944cc-0cc4-4ee0-befd-c3cd2059a58d.png" alt=""></p>
<ul>
<li><strong>「MoreThanJava」</strong> 宣扬的是 <strong>「学习，不止 CODE」</strong>，本系列 Java 基础教程是自己在结合各方面的知识之后，对 Java 基础的一个总回顾，旨在 <strong>「帮助新朋友快速高质量的学习」</strong>。</li>
<li>当然 <strong>不论新老朋友</strong> 我相信您都可以 <strong>从中获益</strong>。如果觉得 <strong>「不错」</strong> 的朋友，欢迎 <strong>「关注 + 留言 + 分享」</strong>，文末有完整的获取链接，您的支持是我前进的最大的动力！</li>
</ul>
<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>该文章的大部分内容都是翻译自是黑莓 <code>10</code> 实时操作系统 <code>QNX Neutrino</code> 的<a href="https://developer.blackberry.com/native/documentation/dev/rtos/arch/about_system_architecture.html" target="_blank" rel="noopener">开发手册</a>，该手册不仅详细地阐述了 BlackBerry 10 OS 的原理以及 OS 的体系结构，还描述了其 QNX Neutrino 微内核的详细信息 <em>(包括进程线程、多和处理、网络架构、文件系统等…非常完整..)</em>。</p>
<p>我阅读了其中「描述进程和线程」的精华部分，觉得写的非常不错，特意翻译 <em>(主要靠有道和 Google 翻译)</em> 跟大家分享一下 <em>(部分内容有改动)</em>。</p>
<p>手册中详细描述了许多关于 Linux 函数调用涉及底层方面的细节，在本文中我大都没有贴出来，<strong>感兴趣的朋友强烈建议去拜读一下原文！</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/336441d3-e4fc-450e-9271-1b4ef3a4f6ed.png" alt=""></p>
<blockquote>
<ul>
<li>原文地址：<a href="https://developer.blackberry.com/native/documentation/dev/rtos/arch/about_system_architecture.html" target="_blank" rel="noopener">https://developer.blackberry.com/native/documentation/dev/rtos/arch/about_system_architecture.html</a></li>
</ul>
</blockquote>
<h1 id="Part-1-进程和线程基础"><a href="#Part-1-进程和线程基础" class="headerlink" title="Part 1. 进程和线程基础"></a>Part 1. 进程和线程基础</h1><p>在我们开始讨论线程、进程、时间片和所有其他的精彩的概念之前，让我们先来建立一个类比。</p>
<p>我要做的首先是 <strong>说明线程和进程是如何工作的</strong>。我能想到的最好的方法 <em>(不涉及实时系统的设计)</em> 是在某种情况下想象我们的线程和进程。</p>
<h2 id="进程就像一栋房子"><a href="#进程就像一栋房子" class="headerlink" title="进程就像一栋房子"></a>进程就像一栋房子</h2><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/e283ed13-3541-4a3d-8ec9-6b845d6434f4.png" alt=""></p>
<p>房子实际上是 <strong>具有某些属性的容器</strong> <em>(例如卧室数量、占地面积、区域划分等)</em>。</p>
<p>如果您以这个角度来看，房子实际上并不会主动做任何事情————它是一个 <strong>被动的对象</strong>。这实际上就是进程干的事情了 <em>(充当容器)</em>。</p>
<h2 id="线程就像是居住者"><a href="#线程就像是居住者" class="headerlink" title="线程就像是居住者"></a>线程就像是居住者</h2><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/3d262b67-f931-41fa-8328-bcce20034a5b.png" alt=""></p>
<p>居住在房子里面的人是 <strong>活动的对象</strong>，他们可以使用各种房间，看电视、做饭、洗澡等等等…</p>
<h3 id="单线程"><a href="#单线程" class="headerlink" title="单线程"></a>单线程</h3><p>如果您独居过，那么您就会知道————<strong>您可以在家里的任何时间做您任何想做的事</strong>，因为家里面没有其他人，您只要遵从内心的规则就好。</p>
<h3 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h3><p>如果在您的房子中再另外添加一个人，情况将发生巨变。</p>
<p>假设您结婚了，那么现在您的家里住着您和您的配偶。因此您不能在 <strong>任何时间</strong> 都能够使用厕所，因为您需要首先确保您的配合不在其中！</p>
<p>如果您有两个 <strong>负责任的成年人</strong> 居住在房屋中，那么通常您可以在 <strong>「安全性」</strong> 这一块儿稍微放松一些 <em>(因为您知道另一个成年人会尊重您的空间，不会试图故意在厨房放火之类的..)</em>。</p>
<p>但是，如果把几个 <strong>熊孩子</strong> 混在一起，事情就会变得更加有趣了…</p>
<h2 id="说回进程和线程"><a href="#说回进程和线程" class="headerlink" title="说回进程和线程"></a>说回进程和线程</h2><p>就像是房屋占用土地一样，进程也要占用内存。</p>
<p>也正如房屋拥有者可以随意进入他们想去的任何房间一样，进程中的线程也 <strong>都拥有</strong> 对该内存区域访问的权限。</p>
<p>如果某个线程被分配了某些东西 <em>(例如哥哥进程出去买了游戏机🎮回家)</em>，那么其他所有线程都可以立即访问它 <em>(因为它存在于公共地址空间中————都在房子里)</em>。</p>
<p>同样，如果给进程分配额外多的一块空间，则新的区域也能够用于所有线程。</p>
<p><strong>这里的窍门在于识别内存是否应该对进程中的所有线程可用。</strong></p>
<ul>
<li><p>如果是，那么您将需要让所有线程同步它们对其的访问。</p>
</li>
<li><p>如果不是，那么我们将假定它只能用于某个特定的线程 <em>(在这种情况下，因为只有特定线程能够访问它，我们可以在假设线程不会自己把自己玩儿坏的前提下，不需要同步操作)</em>。</p>
</li>
</ul>
<p><strong>从日常的生活中我们知道，事情并不是那么简单。</strong></p>
<p>现在我们已经了解了基本特征 <em>(所有内容都是共享的)</em>，下面我们来深入探究一下事情变得有趣的地方以及原因。</p>
<p>下图显示了我们表示线程和进程的方式。进程是一个圆圈，代表“容器”概念（地址空间），三个长方形是线程。在本文中，您将看到类似这样的图。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/2c253102-4bd3-4164-892f-315c5fba4467.png" alt=""></p>
<h2 id="互斥"><a href="#互斥" class="headerlink" title="互斥"></a>互斥</h2><p>在生活中，如果您想洗个澡，并且已经有人在洗手间了，您将不得不等待。线程又是如何处理的呢？</p>
<p>这是通过一种叫做 <strong>互斥</strong> <em>(mutual exclusion)</em> 的操作完成的。和你想的差不多——当涉及到 <strong>特定资源</strong> 时，许多线程是互斥的。</p>
<p>当你想要独占浴室洗澡时，你通常会走进浴室，从里面锁上门。任何想要上厕所的人都会被锁挡住。当你洗完之后，你会打开门，允许其他人进入。</p>
<p>这就是线程的作用。一个线程使用一个叫做 <strong>互斥锁</strong> <em>(mutex)</em> 的对象 <em>(互斥锁 MUTual EXclusion 的首字母缩写)</em>。这个对象就像门上的锁 —— 一旦一个线程锁定了互斥锁，其他线程就不能获得该互斥锁，直到拥有它的线程释放它。就像门锁一样，等待获得互斥锁的线程将被阻挡。</p>
<p>互斥锁和门锁的另一个有趣的相似之处是，互斥锁实际上是一种 <strong>“建议” 锁</strong> <em>(“advisory” lock)</em>。如果一个线程不遵守使用互斥锁的约定，那么保护就没有用了。在我们的房子比喻中，这就像有人不顾门和锁的惯例，从一堵墙闯进盥洗室。</p>
<h2 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h2><p>如果卫生间现在上锁了，有很多人在等着使用怎么办？显然，所有人都坐在外面，等着洗手间里的人出来。</p>
<p><strong>真正的问题是：当门打开时会发生什么?谁下一个去?</strong></p>
<p>你会想，让等待时间最长的人下一个走或许是 “公平的”。又或者，让年龄最大的人排在第二位也可能是 “公平的”。有很多方法可以确定什么是“公平”。</p>
<p>我们通过两个因素来解决这个问题：<strong>优先级</strong> 和 <strong>等待的时长</strong>。</p>
<p>假设两个人同时出现在锁着的浴室门口。其中一个有一个有急事 <em>(例如：他们开会已经迟到了…)</em>，而另一个没有。让那个有急事的人去做下一个，不是很有意义吗？</p>
<p>当然！问题的关键是你如何决定谁更 “重要”。</p>
<p>这可以通过分配优先级来实现 <em>(我们可以使用数字，例如 <code>1</code> 是最低的可用优先级，<code>255</code> 是这个版本的最高优先级)</em>。房子中那些有急事的人将被给予更高的优先权，而那些没有急事的人将被给予较低的优先权。</p>
<p>线程也是一样。线程从父线程继承自己的调度算法，但是可以调用 <code>Linux</code> 系统函数 <a href="https://man7.org/linux/man-pages/man3/pthread_setschedparam.3.html" target="_blank" rel="noopener"><code>pthread_setschedparam()</code></a> 来更改自己的调度策略和优先级 <em>(如果它有权限这么做的话)</em>。</p>
<p>如果有很多线程在等待，并且互斥锁被解锁，我们将把互斥锁给优先级最高的等待线程。但是，假设两个人有相同的优先级。现在该做什么呢？</p>
<p>好吧，在这种情况下，让等待时间最长的人下一个去才是 “公平的”。这不仅是“公平的”，也是内核实际所做的。在有一堆线程等待的情况下，我们主要根据优先级，其次是等待的长度。</p>
<p>互斥锁当然不是我们将遇到的唯一 <strong>同步对象</strong>。让我们看看其他一些例子。</p>
<h2 id="信号量"><a href="#信号量" class="headerlink" title="信号量"></a>信号量</h2><p>让我们从浴室转到厨房，因为那里是一个社会认可的可以同时容纳一个人以上的地方。在厨房里，你可能不想让每个人都同时待在那里。事实上，你可能想要限制厨房里的人数 <em>(厨师太多等等…)</em>。</p>
<p>假设你不希望同时有 <strong>超过两个人</strong> 在里面，这可以使用互斥锁来实现吗？这对于我们的类比来说是一个非常有趣的问题。让我们稍微讨论一下。</p>
<h3 id="计数为-1-的信号量"><a href="#计数为-1-的信号量" class="headerlink" title="计数为 1 的信号量"></a>计数为 1 的信号量</h3><p>在上面类比的卫生间的例子中，可以有两种情况，并且两种状态相互关联:</p>
<ul>
<li>门没锁，房间里没人；</li>
<li>门锁了，房间里有人；</li>
</ul>
<p>这里并没有其他可能的组合 —— 房间里没有人的时候门不能锁上 <em>(我们怎么能打开它?)</em>，房间里有人的时候门也不能打开 <em>(他们怎么能保证自己的隐私呢?)</em>。这是一个计数为 <code>1</code> 的信号量示例：房间中最多只能有一个人，或者有一个线程使用该信号量。</p>
<p><strong>这里的关键是我们描述锁的方式。</strong></p>
<p>在你典型的浴室锁里，你只能从里面上锁和解锁 <em>(没有可以从外部访问的锁)</em>。实际上，这意味着互斥锁的所有权是一个原子操作 —— 在你获得互斥锁的过程中，其他线程不可能获得它，结果就是一个线程进入 “厨房” 上锁，导致另一个线程将无法进入。在我们用房子来比喻的故事里，这一点就不那么明显了，因为人类比 <code>1</code> 和 <code>0</code> 聪明得多。</p>
<p>很显然，我们厨房需要的是一种不同类型的锁。</p>
<h3 id="计数大于-1-的信号量"><a href="#计数大于-1-的信号量" class="headerlink" title="计数大于 1 的信号量"></a>计数大于 1 的信号量</h3><p>假设我们在厨房安装了传统的基于钥匙的锁。这把锁的工作原理是，如果你有一把钥匙，你就可以开门进去。任何使用这把锁的人都同意，当他们进入内部时，他们将立即从内部锁门，这样，任何在外部的人都将始终需要一把钥匙。</p>
<p>好了，现在控制我们想要多少人在厨房就变成一件简单的事情了 —— 把两把钥匙挂在门外！厨房总是锁着。当有人想进厨房时，他们要看是否有钥匙挂在门外。如果是的话，他们就把它带在身边，打开厨房的门，走进去，用钥匙锁门。</p>
<p>因为进入厨房的人必须在他们进入厨房时带着钥匙，所以我们通过限制门外挂钩上可用的钥匙数量来直接控制允许进入厨房的人数。</p>
<p>对于线程，这是通过 <strong>信号量</strong> 来完成的。“普通” 信号量就像互斥锁一样工作 —— 你要么拥有互斥锁，在这种情况下你可以访问资源，要么不拥有，在这种情况下你不能访问资源。我们刚才在厨房中描述的信号量是一个计数信号量 —— 它跟踪计数 <em>(根据线程可用的 “钥匙” 的数量)</em>。</p>
<h2 id="作为互斥锁的信号量"><a href="#作为互斥锁的信号量" class="headerlink" title="作为互斥锁的信号量"></a>作为互斥锁的信号量</h2><p>我们刚才问了这样一个问题:“可以用互斥锁来实现吗?” 对于使用互斥锁实现计数，答案是否定的。反过来怎么样？我们可以使用信号量作为互斥锁吗？</p>
<p>当然可以！事实上，在某些操作系统中，这正是它们所做的 —— 它们没有互斥锁，只有信号量！<strong>那么，为什么要为互斥锁费心呢？</strong></p>
<p>要回答这个问题，先看看你的洗手间。你房子的建造者是如何实现 “互斥锁” 的？我敢肯定你家的厕所外面并没有挂在墙上的钥匙！</p>
<p>互斥锁是一种 “特殊用途” 的信号量。如果您希望在代码的特定部分中运行一个线程，那么互斥是目前为止最有效的实现。</p>
<p><em>(事实上文章的后续介绍了其他同步方案——称为 <code>condvars</code>、<code>barrier</code> 和 <code>sleepons</code>，这些就是 Java 中同步方案的操作系统层面的原型，感兴趣的可以自行去阅读一下.. 差别不大，只不过使用的是操作系统层面的描述…)</em></p>
<blockquote>
<p>为了避免混淆，请认识到 <strong>互斥锁还有其他属性</strong>，比如 <strong>优先级继承</strong>，这是它与 <strong>信号量</strong> 的区别。</p>
</blockquote>
<h1 id="Part-2-内核的作用"><a href="#Part-2-内核的作用" class="headerlink" title="Part 2. 内核的作用"></a>Part 2. 内核的作用</h1><p>房子的类比很好地解释了同步的概念，但是它在另一个主要领域是解释不通的。在我们家里，有许多 “线程” 是同时运行的。然而，在一个真实的实时系统中，通常只有一个 CPU，所以一次只能运行一个 “东西”。</p>
<h2 id="单核-CPU"><a href="#单核-CPU" class="headerlink" title="单核 CPU"></a>单核 CPU</h2><p>让我们看看在现实情况中会发生什么，特别是在系统中 <strong>只有一个 CPU</strong> 的情况下。在这种情况下，由于只有一个 CPU，因此在 <strong>任何给定的时间点只能运行一个线程</strong>。内核决定 <em>(使用一些规则，我们将很快看到)</em> 到底该运行哪个线程。</p>
<h2 id="多核CPU-SMP"><a href="#多核CPU-SMP" class="headerlink" title="多核CPU (SMP)"></a>多核CPU (SMP)</h2><p>如果您购买的系统具有多个相同的 CPU，它们都共享内存和设备，那么您将拥有一个 SMP box <em>(SMP 代表对称的多处理器，“对称的” 部分表示系统中的所有 CPU 都是相同的)*。在这种情况下，可以并发 *(同时)</em> 运行的线程数量受到 CPU 数量的限制。<em>(实际上，单处理器机箱也是如此!)</em> 由于每个处理器一次只能执行一个线程，因此如果有多个处理器，多个线程就可以同时执行。</p>
<p>现在让我们先忽略 CPU 的数量 —— 一个有用的抽象是把系统设计成多线程同时运行的样子，即使事实并非如此。<em>(稍后，在 “使用 SMP 时要注意的事情” 一节中，我们将看到 SMP 的一些非直观影响…)</em></p>
<h2 id="内核作为仲裁程序"><a href="#内核作为仲裁程序" class="headerlink" title="内核作为仲裁程序"></a>内核作为仲裁程序</h2><p>那么，在任何给定的时刻，谁来决定哪个线程将运行？这是内核的工作。</p>
<p>内核确定在特定时刻应该使用 CPU 的线程，并将上下文切换到该线程。让我们研究一下内核对 CPU 做了什么。</p>
<p>CPU 有许多寄存器 <em>(确切的数目取决于处理器家族，例如，<code>x86</code> 对 <code>MIPS</code>，以及特定的家族成员，例如，<code>80486</code> 对 奔腾)</em>。当线程运行时，信息存储在这些寄存器中 <em>(例如，当前程序位置)</em>。</p>
<p>当内核决定另一个线程应该运行时，它需要:</p>
<ol>
<li>保存当前运行线程的寄存器和其他上下文信息；</li>
<li>将新线程的寄存器和上下文加载到 CPU 中；</li>
</ol>
<p><strong>但是内核如何决定应该运行另一个线程呢？</strong> 它会查看某个特定线程此时是否能够使用该 CPU。例如，当我们谈到互斥锁时，我们引入了一种 <strong>阻塞状态</strong> <em>(当一个线程拥有互斥锁，另一个线程也想获得它时，就会发生这种情况;第二个线程将被阻塞)</em>。</p>
<p>因此，从内核的角度来看，我们有一个线程可以消耗 CPU，而另一个线程由于被阻塞而不能等待互斥锁。在这种情况下，内核让可以运行的线程消耗 CPU，并将另一个线程放入一个内部列表 <em>(以便内核可以跟踪它对互斥锁的请求)</em>。</p>
<p>显然，这不是一个很有趣的情况。假设有许多线程可以使用该 CPU。还记得我们基于优先级和等待长度来委托对互斥的访问吗？内核使用类似的方案来确定下一个将运行哪个线程。有两个因素：<strong>优先级</strong> 和 <strong>调度算法</strong>，基于此顺序评估。</p>
<h3 id="优先级-1"><a href="#优先级-1" class="headerlink" title="优先级"></a>优先级</h3><p>考虑两个能够使用 CPU 的线程。如果这些线程具有不同的优先级，那么答案真的很简单 —— 内核将 CPU 分配给优先级最高的线程。正如我们在讨论获得互斥锁时提到的，优先级是从 <code>1</code> <em>(可用性最低的)</em> 开始的。</p>
<p><strong>注意，优先级为零是为空闲线程保留的 —— 您不能使用它。</strong> <em>(如果您想知道您的系统的最小值和最大值，可以使用 Linux 的系统函数 <code>sched_get_priority_min()</code> 和 <code>sched_get_priority_max()</code> —— 它们的原型被定义在 <code>&lt;sched.h&gt;</code> 中。我们假设 <code>1</code> 是最低可用性，<code>255</code> 是最高可用性。)</em></p>
<p>如果另一个具有更高优先级的线程突然能够使用 CPU，内核将立即上下文切换到更高优先级的线程。我们称之为 <strong>抢占</strong> —— 高优先级线程抢占了低优先级线程。当高优先级线程完成时，内核上下文切换回之前运行的低优先级线程，我们称之为 <strong>恢复</strong> —— 内核继续运行前一个线程。</p>
<p>现在，假设有两个线程能够使用 CPU，并且具有完全相同的优先级。</p>
<h3 id="调度算法"><a href="#调度算法" class="headerlink" title="调度算法"></a>调度算法</h3><p>让我们假设其中一个线程当前正在使用该 CPU。在本例中，我们将研究内核用于决定何时进行上下文切换的规则。<em>(当然，这整个讨论实际上只适用于具有相同优先级的线程)</em></p>
<p>内核有两种主要调度算法 <em>(策略)*：轮询调度 *(或简称“RR”)</em> 和 FIFO <em>(先入先出)</em>。</p>
<h4 id="FIFO-First-In-First-Out，先进先出"><a href="#FIFO-First-In-First-Out，先进先出" class="headerlink" title="FIFO(First In First Out，先进先出)"></a>FIFO(First In First Out，先进先出)</h4><p>在 FIFO 调度算法中，允许线程一直使用 CPU <em>(只要它想要使用)*。这意味着，如果该线程正在进行非常长的数学计算，并且没有其他具有更高优先级的线程准备好，那么该线程可能会永远运行下去。那么具有相同优先级的线程呢？它们也被锁在外面了。</em>(显然，此时低优先级的线程也被锁定。)*</p>
<p>如果正在运行的线程放弃或自愿放弃 CPU，那么内核将查找 <strong>具有相同优先级、能够使用该 CPU</strong> 的其他线程。如果没有这样的线程，那么内核将寻找能够使用 CPU 的低优先级线程。</p>
<p>注意，术语 <em>“自愿放弃CPU”</em> 可能意味着两种情况。</p>
<p>如果线程进入睡眠状态，或者在信号量上阻塞，那么是的，一个低优先级的线程可以运行 <em>(如上所述)</em>。</p>
<p>但是还有一个 <strong>“特殊” 调用，<a href="http://www.qnx.com/developers/docs/6.4.1/neutrino/lib_ref/s/sched_yield.html" target="_blank" rel="noopener"><code>sched_yield()</code></a></strong> <em>(基于内核调用 <code>SchedYield()</code>)</em>，它仅将 CPU 让给另一个具有相同优先级的线程 —— 如果高优先级的线程已经准备好运行，那么低优先级的线程将永远不会有机会运行。如果一个线程确实调用了 <code>sched_yield()</code>，并且没有其他具有相同优先级的线程准备运行，那么原始线程将继续运行。实际上，<code>sched_yield()</code> 用于在 CPU 上对另一个具有相同优先级的线程进行访问。</p>
<p>在下面的图中，我们看到三个线程在两个不同的进程中运行:</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/d1dcc7d2-65c5-411d-b392-e9e5f68b901f.png" alt=""></p>
<p>如果我们假设线程“A”和“B”已经准备好了，线程“C”被阻塞了(可能在等待互斥)，线程“D”(没有显示)正在执行，那么内核维护的就绪队列的一部分看起来是这样的：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/990839a3-c5e9-44c1-a4a8-5c57d885b15a.png" alt=""></p>
<p>这显示了内核的 <strong>内部就绪队列</strong>，内核使用它来决定下一步调度谁。注意，线程“C”没有在就绪队列中，因为它被阻塞了；线程“D”也没有在就绪队列中，因为它正在运行。</p>
<h4 id="轮循-Round-Robin"><a href="#轮循-Round-Robin" class="headerlink" title="轮循(Round Robin)"></a>轮循(Round Robin)</h4><p><strong>RR 调度算法</strong> 与 FIFO 相同，只是如果有另一个具有相同优先级的线程，则该线程不会永远运行。它只对系统定义的时间片运行，您可以使用函数 <a href="http://www.qnx.com/developers/docs/6.4.1/neutrino/lib_ref/c/clockperiod.html" target="_blank" rel="noopener"><code>sched_rr_get_interval()</code></a> 来确定时间片的值。时间片通常为 <code>4</code> 毫秒，但实际上是 <code>ticksize</code> 的 <code>4</code> 倍，您可以查询或使用 <a href="http://www.qnx.com/developers/docs/6.4.1/neutrino/lib_ref/s/sched_rr_get_interval.html" target="_blank" rel="noopener"><code>ClockPeriod()</code></a> 设置 <code>ticksize</code>。</p>
<p>实际发生的情况是，内核启动一个 RR 线程，并记录时间。如果 RR 线程运行了一段时间，分配给它的时间就会超时 <em>(时间片已经过期)</em>。内核查看是否有另一个具有相同优先级的线程已经准备好了。如果有，内核运行它。如果没有，那么内核将继续运行 RR 线程 <em>(内核授予线程另一个时间片)</em>。</p>
<p>让我们总结一下 <strong>调度规则</strong> <em>(对于单个CPU)</em>，按重要性排序:</p>
<ul>
<li>一次只能运行一个线程。</li>
<li>最高优先级的就绪线程将运行。</li>
<li>线程将一直运行，直到阻塞或退出。</li>
<li>RR 线程将运行它的时间片，然后内核将重新安排它 <em>(如果需要)</em>。</li>
</ul>
<p>下面的流程图显示了内核做出的决策：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/b0053516-c0fb-4655-91d1-a725cba0681d.png" alt=""></p>
<p>对于多 CPU 系统，规则是相同的，除了多个 CPU 可以并发地运行多个线程。线程运行的顺序 <em>(在多个 CPU 上运行哪些线程)</em> 的确定方法与在单个 CPU 上完全相同 —— 最高优先级的就绪线程将在一个 CPU 上运行。对于优先级较低或等待时间较长的线程，内核在安排它们以避免缓存使用效率低下方面具有一定的灵活性。</p>
<h2 id="内核状态"><a href="#内核状态" class="headerlink" title="内核状态"></a>内核状态</h2><p>我们一直在松散地讨论 “运行”、“就绪” 和 “阻塞” —— 现在让我们更加深入地来讨论这些线程状态。</p>
<h3 id="运行态（RUNNING）"><a href="#运行态（RUNNING）" class="headerlink" title="运行态（RUNNING）"></a>运行态（RUNNING）</h3><p>运行状态仅仅意味着线程正在积极地消耗 CPU。在一个 SMP 系统上，会有多个线程在运行;在单处理器系统中，只有一个线程在运行。</p>
<h3 id="就绪态（READY）"><a href="#就绪态（READY）" class="headerlink" title="就绪态（READY）"></a>就绪态（READY）</h3><p>就绪状态意味着这个线程现在就可以运行 —— 但它不会立刻运行，因为另一个线程 <em>(具有相同或更高优先级)</em> 正在运行。如果两个线程能够使用 CPU，一个线程优先级为 <code>10</code>，一个线程优先级为 <code>7</code>，那么优先级为 <code>10</code> 的线程将正在运行，优先级为 <code>7</code> 的线程将准备就绪。</p>
<h3 id="阻塞状态（BLOCKED）"><a href="#阻塞状态（BLOCKED）" class="headerlink" title="阻塞状态（BLOCKED）"></a>阻塞状态（BLOCKED）</h3><p>我们把阻塞状态称为什么？问题是，阻塞状态并不只有一个。在内核的作用下，实际上有超过 <code>12</code> 种阻塞状态。</p>
<p>为什么那么多？因为内核会跟踪线程被阻塞的原因。</p>
<p>我们已经看到了两种阻塞状态 —— 当一个线程被阻塞等待互斥锁时，这个线程处于互斥锁状态；当线程被阻塞等待信号量时，它处于 <code>SEM</code> 状态。这些状态只是表明线程阻塞在哪个队列 <em>(和哪个资源)</em> 上。</p>
<p>如果在一个互斥锁上阻塞了许多线程 <em>(处于互斥锁阻塞状态)</em>，内核不会注意到它们，直到拥有该互斥锁的线程释放它。此时，阻塞的一个线程已经准备就绪，内核将做出重新调度决策 <em>(如果需要)</em>。</p>
<p>为什么说 “如果需要” 呢？刚刚释放互斥锁的线程可能还有其他事情要做，并且比等待的线程有更高的优先级。在本例中，我们使用第二个规则，即 “最高优先级的就绪线程将运行”，这意味着调度顺序没有改变 —— 高优先级线程继续运行。</p>
<h3 id="内核状态，完整的列表"><a href="#内核状态，完整的列表" class="headerlink" title="内核状态，完整的列表"></a>内核状态，完整的列表</h3><p>下面是内核阻塞状态的完整列表，并简要说明了每个状态。顺便说一下，这个列表可以在 <code>\&lt;sys/neutrino.h&gt;</code> —— 你会注意到所有的状态都以 <code>STATE_</code> 作为前缀 <em>(例如，这个表中的 “READY” 在头文件中以 <code>STATE_READY</code> 的形式列出)</em>：</p>
<table>
<thead>
<tr>
<th align="left">状态标识</th>
<th align="left">当前线程动作</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CONDVAR</td>
<td align="left">等待一个条件变量被通知。</td>
</tr>
<tr>
<td align="left">DEAD</td>
<td align="left">线程死亡。内核正在等待释放线程的资源。</td>
</tr>
<tr>
<td align="left">INTR</td>
<td align="left">等待中断。</td>
</tr>
<tr>
<td align="left">JOIN</td>
<td align="left">等待另一个线程的完成。</td>
</tr>
<tr>
<td align="left">MUTEX</td>
<td align="left">等待获取互斥锁。</td>
</tr>
<tr>
<td align="left">NANOSLEEP</td>
<td align="left">睡一段时间 <em>(当前的线程将暂停执行,直到 <code>rqtp</code> 参数所指定的时间间隔)</em>。</td>
</tr>
<tr>
<td align="left">NET_REPLY</td>
<td align="left">等待通过网络发送的回复。</td>
</tr>
<tr>
<td align="left">NET_SEND</td>
<td align="left">等待一个脉冲或消息通过网络传送。</td>
</tr>
<tr>
<td align="left">READY</td>
<td align="left">不在 CPU 上运行，但已准备运行 <em>(一个或多个更高或同等优先级的线程正在运行)</em>。</td>
</tr>
<tr>
<td align="left">RECEIVE</td>
<td align="left">等待客户端发送消息。</td>
</tr>
<tr>
<td align="left">REPLY</td>
<td align="left">等待服务器回复消息。</td>
</tr>
<tr>
<td align="left">RUNNING</td>
<td align="left">正在 CPU 上积极地运行。</td>
</tr>
<tr>
<td align="left">SEM</td>
<td align="left">等待获取信号量。</td>
</tr>
<tr>
<td align="left">SEND</td>
<td align="left">等待服务器接收消息。</td>
</tr>
<tr>
<td align="left">SIGSUSPEND</td>
<td align="left">等待信号。</td>
</tr>
<tr>
<td align="left">SIGWAITINFO</td>
<td align="left">等待信号。</td>
</tr>
<tr>
<td align="left">STACK</td>
<td align="left">等待分配更多堆栈。</td>
</tr>
<tr>
<td align="left">STOPPED</td>
<td align="left">暂停(SIGSTOP信号)。</td>
</tr>
<tr>
<td align="left">WAITCTX</td>
<td align="left">等待寄存器上下文 <em>(通常是浮点)</em> 可用 <em>(仅在SMP系统上)</em>。</td>
</tr>
<tr>
<td align="left">WAITPAGE</td>
<td align="left">等待进程管理者解决页面上的一个错误。</td>
</tr>
<tr>
<td align="left">WAITTHREAD</td>
<td align="left">等待创建线程。</td>
</tr>
</tbody></table>
<p><strong>需要记住的重要一点是，当一个线程被阻塞时，无论它处于何种状态，它都不会消耗CPU。相反，线程消耗 CPU 的唯一状态是运行状态。</strong></p>
<h1 id="Part-3-线程和进程"><a href="#Part-3-线程和进程" class="headerlink" title="Part 3. 线程和进程"></a>Part 3. 线程和进程</h1><p>让我们从真实的实时系统的角度回到对线程和进程的讨论。</p>
<p>我们知道一个进程可以有一个或多个线程。<em>(一个没有线程的进程将不能做任何事情 —— 也就是说，没有人在家执行任何有用的工作。)</em> 一个系统可以有一个或多个进程。<em>(同样的讨论也适用于 —— 一个没有任何进程的系统不会有任何作用。)</em></p>
<p>那么这些进程和线程是做什么的呢？最终，它们形成一个系统 —— 执行某个目标的线程和进程的集合。</p>
<p>在最高层次上，系统由许多进程组成。每个进程都负责提供某种性质的服务 —— 无论是文件系统、显示驱动程序、数据采集模块、控制模块，还是其他什么。</p>
<p>在每个进程中，可能有许多线程。线程的数量是不同的。一个只使用一个线程的进程可以完成与另一个使用五个线程的进程相同的功能。有些问题本身是多线程的，实际上解决起来相对简单，而其他进程本身是单线程的，很难实现多线程。</p>
<p>如何用线程进行设计的话题很容易就会被另一本书占用 —— 在这里我们只关注基础知识。</p>
<h2 id="为什么需要多个进程？"><a href="#为什么需要多个进程？" class="headerlink" title="为什么需要多个进程？"></a>为什么需要多个进程？</h2><p>那么为什么不让一个进程拥有无数线程呢？虽然有些操作系统强迫你这样编码，但将事情分解成多个进程的好处有很多:</p>
<ul>
<li>分离和模块化；</li>
<li>可维护性；</li>
<li>可靠性；</li>
</ul>
<p>将问题 “分解” 成几个独立问题的能力是一个强大的概念。它也是系统的核心。一个系统由许多独立的模块组成，每个模块都有一定的职责。这些独立的模块是不同的进程。QSS 的人员使用这个技巧来开发独立的模块，而不需要模块相互依赖。模块之间唯一的 “依赖” 是通过少量定义良好的接口实现的。</p>
<p>由于缺乏相互依赖关系，这自然会增强可维护性。因为每个模块都有自己的特定定义，所以修复一个模块相当容易 —— 尤其是在它不绑定到任何其他模块的情况下。</p>
<p><strong>然而，可靠性可能是最重要的一点</strong>。进程就像房子一样，有一些定义明确的 “边界”。住在房子里的人很清楚自己什么时候在房子里，什么时候不在房子里。一个线程有一个很好的想法 —— 如果它在进程中访问内存，它可以存活。如果它超出了进程地址空间的范围，它就会被杀死。这意味着运行在不同进程中的两个线程可以有效地相互隔离。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/bbe2b7f2-7b04-44a7-a5fe-712433286783.png" alt=""></p>
<p>进程地址空间由系统的进程管理器模块维护和执行。当一个进程启动时，进程管理器会分配一些内存给它，并启动一个正在运行的线程。内存被标记为该进程所拥有。</p>
<p>这意味着如果进程中有多个线程，内核需要在它们之间进行上下文切换，这是一个非常高效的操作 —— 我们不需要改变地址空间，只需要改变哪个线程在运行。但是，如果我们必须切换到另一个进程中的另一个线程，那么进程管理器就会介入并导致地址空间的切换。不用担心，虽然在这个额外的步骤中会有一些额外的开销，但是在系统的作用下仍然是非常快的。</p>
<h2 id="如何启动一个进程"><a href="#如何启动一个进程" class="headerlink" title="如何启动一个进程"></a>如何启动一个进程</h2><p>现在让我们将注意力稍微转向可用于处理线程和进程的函数调用 。<strong>任何线程都可以启动一个进程</strong>；唯一施加的限制是那些来自基本安全性的限制 <em>(文件访问、特权限制等)</em>。</p>
<p>想要启动一个进程大概有以下几种方法 <em>(具体的细节我们在这里不介绍)</em>：</p>
<ol>
<li><strong>命令行启动</strong>；</li>
<li><strong>使用 <a href="http://www.qnx.com/developers/docs/6.4.1/neutrino/lib_ref/s/system.html" target="_blank" rel="noopener"><code>system()</code></a> 函数调用启动</strong>：这是最简单的，直接在命令行输入就可以。实际上，<code>system()</code> 启动了一个外壳程序来处理您要执行的命令；</li>
<li><strong>使用 <a href="http://www.qnx.com/developers/docs/6.4.1/neutrino/lib_ref/lib-e.html" target="_blank" rel="noopener"><code>exec()</code> 系列函数</a> 和 <a href="http://www.qnx.com/developers/docs/6.4.1/neutrino/lib_ref/s/spawn.html" target="_blank" rel="noopener"><code>spawn()</code></a> 函数调用启动</strong>：当一个进程发出 <code>exec()</code> 函数，则该进程停止运行当前程序，并开始运行另一个程序；进程 ID 没有改变 ——— 进程变成了另一个程序；而调用 <code>spwan()</code> 函数则会创建另一个进程 <em>(带有新的进程 ID)</em>，该进程与函数的参数中指定的程序相对应。</li>
<li><strong>使用 <a href="http://www.qnx.com/developers/docs/6.4.1/neutrino/lib_ref/f/fork.html" target="_blank" rel="noopener"><code>fork()</code></a> 调用启动</strong>：完全复制当前进程，所有代码都是相同的，数据也与创建 <em>(或父)</em> 进程的数据相同。有意思的是，当您调用 <code>fork()</code> 时，您创建了另一个进程，该进程在相同的位置执行相同的代码，两个进程都将从 <code>fork()</code> 调用中作为父进程返回。<em>(感兴趣的同学可以自行搜索一下…)</em></li>
<li><strong>使用 <a href="http://www.qnx.com/developers/docs/6.4.1/neutrino/lib_ref/v/vfork.html" target="_blank" rel="noopener"><code>vfork()</code></a> 调用启动</strong>：与普通 <code>fork()</code> 函数相比，<code>vfork()</code> 函数的资源消耗要少得多，因为它共享父线程的地址空间。<code>vfork()</code> 函数创建一个子线程，然后挂起父线程，直到子线程调用 <code>exec()</code> 或退出。另外，<code>vfork()</code> 可以在物理内存模型系统上工作，而 <code>fork()</code> 不能 —— <code>fork()</code> 需要创建相同的地址空间，这在物理内存模型中是不可能的。</li>
</ol>
<h2 id="如何启动线程"><a href="#如何启动线程" class="headerlink" title="如何启动线程"></a>如何启动线程</h2><p>现在我们已经了解了如何启动另一个进程，让我们看看如何启动另一个线程。</p>
<p>任何线程都可以在同一进程中创建另一个线程。没有任何限制 <em>（当然，内存空间不足除外！）</em>。最常见的方法是通过 POSIX <a href="http://www.qnx.com/developers/docs/6.4.1/neutrino/lib_ref/p/pthread_create.html" target="_blank" rel="noopener"><code>pthread_create()</code></a> 调用：</p>
<pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h></span></span>

<span class="token keyword">int</span>
<span class="token function">pthread_create</span> <span class="token punctuation">(</span>pthread_t <span class="token operator">*</span>thread<span class="token punctuation">,</span>
                <span class="token keyword">const</span> pthread_attr_t <span class="token operator">*</span>attr<span class="token punctuation">,</span>
                <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>start_routine<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">void</span> <span class="token operator">*</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<ul>
<li>参数细节和更多线程管理的内容这里就不讨论了..</li>
</ul>
<h2 id="线程是个好主意"><a href="#线程是个好主意" class="headerlink" title="线程是个好主意"></a>线程是个好主意</h2><p>有两类问题，线程的应用是一个好主意。</p>
<ul>
<li><strong>并行化操作</strong>，如计算许多数学问题 <em>(图形、数字信号处理等…)</em>；</li>
<li><strong>共享数据执行几个独立的功能</strong>，如服务器同时服务多个客户；</li>
</ul>
<p>第一类问题很容易理解，把同一个问题分成四份并让四个 CPU 同时计算，这当然感觉会快上不少。</p>
<p>第二类问题稍微麻烦一些，我们借助网络中一台「计算图形结果并发往远端的节点」用来演示，并进一步说明「为什么单核 CPU 系统使用多线程仍然是一个好主意」。</p>
<p>假设我们有一个程序，需要先计算图形的部分 <em>(假设使用 “C” 表示)</em>，然后需要传输到远端 <em>(假设使用 “X” 表示)</em>，并最终等待远端回应做下一步操作 <em>(假设使用 “W” 表示)</em>，以下就是该程序在单核 CPU 下的使用情况：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/fee14383-a2e8-484c-bcfa-f7ccf0845420.png" alt="序列化的单核 CPU"></p>
<p>等一下！这浪费了我们许多宝贵的可用于计算的时间！因为等待远端回复的过程，CPU 做的仅仅是 “等待” 而已..</p>
<p>如果我们使用多线程，应该可以更好地利用我们的 CPU，对吗？</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/99911d6b-3116-47ea-9f3d-8bca77e5abea.png" alt="多线程单 CPU"></p>
<p>这样好得多，因为现在，即使第二个线程花了一些时间等待，我们也减少了计算所需的总时间。</p>
<p>我们可以来简单计算一下。假设我们计算的时间记为 <em>T<sub>计算</sub><em>，发送和等待的时间分别记为：</em>T<sub>发送</sub></em> 和 <em>T<sub>等待</sub></em>。那么在第一种情况下，我们的总运行时间为：</p>
<p>（<em>T<sub>计算</sub></em> + <em>T<sub>发送</sub></em> + <em>T<sub>等待</sub></em>） x <code>任务数量</code></p>
<p>而使用两个线程：</p>
<p>(<em>T<sub>计算</sub></em> + <em>T<sub>发送</sub></em>) x <code>任务数量</code> + <em>T<sub>等待</sub></em></p>
<p>直接减少了：</p>
<p><em>T<sub>等待</sub></em> x (<code>任务数量</code> - <code>1</code>)</p>
<blockquote>
<p>请注意，我们速度最终还是受到以下因素的决定：</p>
<p><em>T<sub>计算</sub></em> + <em>T<sub>发送</sub></em> x <code>任务数量</code></p>
<p>因为我们必须至少进行一次完整的计算，并且必须将数据传输到硬件之外 —— 尽管我们可以使用多线程覆盖计算周期，但只有一个硬件资源可以传输。</p>
</blockquote>
<p>现在，我们创建一个四线程的版本，并且在 <code>4</code> 核的系统上运行它，那么我们最终将得到如下图示的结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/b669fc01-c058-4df2-9853-73f0b5705c41.png" alt="4 核 4 CPU 图示"></p>
<p><strong>请注意，四个 CPU 的每个利用率均未得到充分利用</strong> <em>(如图示  “利用率” 中的灰色矩形所示)</em>。上图中有两个有趣的区域。当四个线程启动时，它们各自进行计算。不过，当线程在每次计算完成时，它们都在争夺传输硬件 <em>(图中的 “X” 部分 —— 一次只能进行一次传输)</em>。这算是在启动部分给了我们一个小异常。一旦线程经过此阶段，由于传输时间比计算周期的 <code>1/4</code> 小得多，因此它们自然会与传输硬件同步。首先，忽略小异常，该系统的特征在于以下公式：</p>
<p>（<em>T<sub>计算</sub></em> + <em>T<sub>发送</sub></em> + <em>T<sub>等待</sub></em>） x <code>任务数量</code> / <code>CPU 数量</code></p>
<p>该公式指出，在四个 CPU 上使用四个线程将比我们刚开始使用的单线程模型快大约 <code>4</code> 倍。</p>
<p>通过结合从简单拥有多线程单处理器版本中学到的知识，我们理所当然地希望拥有更多的 CPU 运行更多的线程，以便多余的线程可以 “吸收” 发送确认等待 <em>（和发送信息）</em> 中的空闲的 CPU 时间。</p>
<p>但是你尝试像我这样画一下 <code>8</code> 核 <code>8</code> 线程的情况，你就会注意到一些神奇的事情：我们仍然会遭遇利用率不足的情况，并且会发现 CPU 处于 “停滞等待” 状态的可能同时会有很多个。</p>
<p><strong>这给了我们一个很重要的教训 —— 我们不能简单的增加 CPU 以倍速我们的运算速度。</strong></p>
<p>我们希望越来越快，但存在许多限制因素。在某些情况下，这些限制因素仅受多 CPU 主板的设计 —— 当许多 CPU 尝试访问相同的内存区域时，会发生多少内存和设备争用。</p>
<blockquote>
<p>尽管多线程多核给我们带来了许多好处，但 “更加复杂的环境” 也让我们面临更多的困难和挑战。可以参考我们类比的例子，在生活中，你面临的情况如果仔细思考和罗列的话，那将会是多么复杂…. 这里也不展开讲了</p>
</blockquote>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>相信看完的朋友都能够对进程和线程进一步加深印象.. <strong>进程像房子，线程像住户</strong>，非常深入人心！</p>
<p>原文章的后半程还详细地介绍了很多线程同步的更多内容，涉及 Linux 底层的函数调用，再后面一个章节还详细地介绍了进程间的通讯相关的内容，感兴趣的童鞋，<strong>请移步原文！</strong></p>
<blockquote>
<ul>
<li>本文已收录至我的 Github 程序员成长系列 <strong>【More Than Java】，学习，不止 Code，欢迎 star：<a href="https://github.com/wmyskxz/MoreThanJava" target="_blank" rel="noopener">https://github.com/wmyskxz/MoreThanJava</a></strong></li>
<li><strong>个人公众号</strong> ：wmyskxz，<strong>个人独立域名博客</strong>：wmyskxz.com，坚持原创输出，下方扫码关注，2020，与您共同成长！</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E5%A5%BD%E6%96%87%E6%8E%A8%E8%8D%90%E3%80%91%E9%BB%91%E8%8E%93OS%E6%89%8B%E5%86%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%A6%E7%BB%86%E9%98%90%E8%BF%B0%E5%BA%95%E5%B1%82%E7%9A%84%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%EF%BC%9F/ace97ed9-3cfd-425f-85e5-c1a1e5ca7d3f.png" alt=""></p>
<p>非常感谢各位人才能 <strong>看到这里</strong>，如果觉得本篇文章写得不错，觉得 <strong>「我没有三颗心脏」有点东西</strong> 的话，<strong>求点赞，求关注，求分享，求留言！</strong></p>
<p>创作不易，各位的支持和认可，就是我创作的最大动力，我们下篇文章见！</p>

      
    </div>
    
      
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post white-box shadow reveal ">
  


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h2 class="title">
    <a href="/2020/07/15/zhi-hu-wen-ti-ru-he-rang-bu-dong-bian-cheng-de-ren-gan-shou-dao-bian-cheng-de-mei-li/">
      【知乎问题】如何让不懂编程的人感受到编程的魅力
    </a>
  </h2>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a class='author' href="" rel="nofollow">
    <img no-lazy src="">
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/MoreThanJava/%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>MoreThanJava/知乎问题</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2020年7月15日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  


            
          
            
              

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-351314da7008a3e3.png" alt=""></p>
<ul>
<li><strong>「MoreThanJava」</strong> 宣扬的是 <strong>「学习，不止 CODE」</strong>，本系列 Java 基础教程是自己在结合各方面的知识之后，对 Java 基础的一个总回顾，旨在 <strong>「帮助新朋友快速高质量的学习」</strong>。</li>
<li>当然 <strong>不论新老朋友</strong> 我相信您都可以 <strong>从中获益</strong>。如果觉得 <strong>「不错」</strong> 的朋友，欢迎 <strong>「关注 + 留言 + 分享」</strong>，文末有完整的获取链接，您的支持是我前进的最大的动力！</li>
</ul>
<blockquote>
<p>知乎问题：如何让不懂编程的人感受到编程的魅力？</p>
<p>链接：<a href="https://www.zhihu.com/question/406408447" target="_blank" rel="noopener">https://www.zhihu.com/question/406408447</a></p>
</blockquote>
<h1 id="Part-0-前言"><a href="#Part-0-前言" class="headerlink" title="Part 0. 前言"></a>Part 0. 前言</h1><p>问一个类似的问题：<strong>「如何让不懂篮球的人感受到篮球的乐趣？」</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-700bd10edecec370.png" alt=""></p>
<p><strong>很明显，答案取决于人。</strong> </p>
<p>对于某些人来说，编码可能是乏味而艰巨的，但对于有些人则是非常有趣且有益的。</p>
<p>通常情况下，编写好代码之后，我们很难评判编码的过程是无聊还是有趣的。</p>
<p>但是我们可以通过更好地了解 <strong>「计算机编程是什么」</strong>，因此您可以自己来评判这是否让你感到乐趣。</p>
<blockquote>
<p>就当代的发展水平来说，只要有电的东西就会涉及到编码；</p>
</blockquote>
<h1 id="Part-1-计算机发展简史-解决实际的问题"><a href="#Part-1-计算机发展简史-解决实际的问题" class="headerlink" title="Part 1. 计算机发展简史 | 解决实际的问题"></a>Part 1. 计算机发展简史 | 解决实际的问题</h1><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-4454fadf617336bd.png" alt=""></p>
<ul>
<li>原文地址：<a href="https://www.wmyskxz.com/2020/04/07/morethanjava-ji-suan-ji-fa-zhan-shi-cong-zhi-bu-ji-dao-ibm/#toc-heading-1">「MoreThanJava」计算机发展史—从织布机到IBM</a></li>
</ul>
<h2 id="一切的开端-织布机"><a href="#一切的开端-织布机" class="headerlink" title="一切的开端 | 织布机"></a>一切的开端 | 织布机</h2><p>衣食住行是人类的基本需求，世界各地都有纺织和织机的发明。</p>
<p><strong>如何提升纺织的效率</strong>，成为一个很重要的课题。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-0f4048a9139128c2.gif" alt="纺织的原理"></p>
<p>与 <strong>「针织物」</strong> 不同，<strong>「机织物」</strong> 由两条或两组以上的相互垂直的两个系统纱线或丝线构成，<strong>纵向的纱线</strong> 叫 <strong>经纱</strong>，<strong>横向的纱线</strong> 叫 <strong>纬纱</strong>。</p>
<p>通过两条线不同规律的交错，就会形成不同的颜色和排列的变化，也就会带来不同的纹样。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-b5e5c065179e720e.png" alt=""></p>
<ul>
<li>图片引用自：<a href="https://www.sohu.com/a/301616592_99894978" target="_blank" rel="noopener">https://www.sohu.com/a/301616592_99894978</a></li>
</ul>
<p>最原始的织机是手动完成的。</p>
<p>后来人们发现，织物纹样的变化总是按照一定规律排列完成的，到了战国时期，就发明了 <strong>多综式提花织机</strong>，通过 <strong>综框</strong> 来完成这一项工作：</p>
<p>[图片上传失败…(image-a35874-1594826100047)]</p>
<p>这或许就是最原始的 <strong>编码</strong>：通过把 <strong>提起规律相同的经纱</strong> 穿入 <strong>同一个综框的综丝</strong> 中，来达到当某一个综框提起时 <em>(通过脚踏板完成)</em>，表达某一个特定纹路的线被提起，也就完成了 <strong>特定纹路的编织</strong>，加快了工作效率。</p>
<h3 id="织布机的更进一步-束综提花织机"><a href="#织布机的更进一步-束综提花织机" class="headerlink" title="织布机的更进一步 | 束综提花织机"></a>织布机的更进一步 | 束综提花织机</h3><p>不过采用综框也有一个明显的限制，那就是 <strong>无法织出比较复杂的纹样</strong>，因为纹样复杂则代表着需要更多的经纬纱以及经纱提升的规律更复杂，意味着可能引入成百上千次纬纱才能完成一个循环。</p>
<p>如果仍然采用综框控制纱线提升，则可能需要成百上千个综框，这在机械上实现是非常困难的，因此便有了 <strong>束综提花织机</strong>。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-4dcb3933474e6a08.png" alt=""></p>
<p>束综提花织机没有综框，而是被 <strong>设计成两层</strong>，每一根经纱会穿入综丝中实现 <strong>单独的控制</strong>，<strong>上层</strong> 的人将需要提起的经纱提起，而 <strong>下层</strong> 的人则再经纱提起后通过梭子将纬纱送入织口，并用打纬装置将引入的纬纱打牢。</p>
<p>然而通常来说，这类织机上会有成千上万根纬纱，纹样复杂，于是聪明的老祖宗们发明了 <strong>花本</strong>：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-495859ac23a889bc.png" alt=""></p>
<p><strong>简单来说，花本存储了纹样信息。</strong></p>
<p>图中花本的竖线连接穿入了经纱的综丝，横线存储了每一次引入纬纱时提花信息，当竖线越过横线覆盖在横线前方时，表明对应的经纱要被提起。</p>
<p>这就有点儿 <strong>编码规则</strong> 的意思。</p>
<h3 id="会说话的「机器」-雅卡尔织布机"><a href="#会说话的「机器」-雅卡尔织布机" class="headerlink" title="会说话的「机器」 | 雅卡尔织布机"></a>会说话的「机器」 | 雅卡尔织布机</h3><p>上面说到的束综提花织机虽然是一大进步，但可想而知的是，它仍然效率缓慢并且织布工人的劳动量非常大，也非常辛苦。</p>
<p>时间来到 <code>18</code> 世纪的欧洲。<code>1725</code> 年，<strong>布乔</strong> 开拓性的使用 <strong>打孔纸带</strong> 来控制经线的提起和放下，从而让织出花样成为一种半自动化的工作：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-6bee426e9032cc72.png" alt=""></p>
<p><strong>历史上第一次，机器能够读出存储介质中的内容，并且照其行事。</strong></p>
<p>在布乔提出构想 <code>65</code> 后的 <code>1790</code> 年，<strong>约瑟夫·玛丽·雅卡尔</strong> 根据前人的成果设计了新式织机，最终于 <code>1805</code> 年完成了首台 <strong>自动提花织机</strong>：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-87cd6dcde3f1eded.png" alt=""></p>
<p>雅卡尔将 <strong>穿孔纸带</strong> 改进为 <strong>穿孔卡片</strong>，根据纹样图案在卡片上打孔，<strong>通过孔的有无</strong> 带动一系列机械运动装置来 控制经纱的提升，一张卡片对应循环内一次引纬时经纱提升的信息，引纬完成后，可通过脚踏板控制卡孔卡片转动，下一张卡片翻转至工作位置以控制新一次引纬的提花：</p>
<p>[图片上传失败…(image-547502-1594826100047)]</p>
<p>雅卡尔织机大幅度节省了时间和工作量 (全自动且效率是之前的二十五倍)，而且只需一位工人，很快就被广泛使用在工厂生产中，雅卡尔也荣获了拿破仑授予的荣誉勋章。</p>
<p><strong>穿孔卡片控制织物纹样的设计成为了程序设计思想的萌芽</strong>，为信息技术的发展开展了一条新的道路。</p>
<h2 id="程序设计思想开始萌芽-差分机"><a href="#程序设计思想开始萌芽-差分机" class="headerlink" title="程序设计思想开始萌芽 | 差分机"></a>程序设计思想开始萌芽 | 差分机</h2><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-3fdbe3e3ebdef557.png" alt=""></p>
<p>时间来到 <code>19</code> 世纪初，法国人 <strong>巴贝奇 (Chanles Badbbage)</strong> 在贾卡织机的启发下，设计并制造了 <strong>差分机</strong>。</p>
<h3 id="故事背景"><a href="#故事背景" class="headerlink" title="故事背景"></a>故事背景</h3><p><code>18</code> 世纪末，法国政府在开创米制之后，决定在数学中统一采用十进制，竟奇葩地想把原本 <code>90</code> 度的直角划分成 <code>100</code> 度、把原本 <code>60</code> 秒的 <code>1</code> 分钟划分成 <code>100</code> 秒，尽管从现在看来这样的想法绝逼是一种倒退，但他们在当时真就实施了。这一改制带来的不光是人们在使用时直观上的别扭，原本制作好的数学用表 <em>（如三角函数表）</em> 都需要全部重制。</p>
<p>法国政府将这项丧心病狂的工程交给了 <strong>数学家普罗尼</strong>  <em>（Gaspard de Prony）<em>，普罗尼正头疼着要如何才能完成这项艰巨的任务，突然想起著名经济学家 *</em>亚当·斯密** *（Adam Smith）</em> 的那本《富国论》，他决定采用书中提出的 <strong>劳动分工</strong> 的做法，将制表的工作人员分成三组：</p>
<ul>
<li><strong>第一组</strong> 由五六名牛逼的数学家组成，他们负责制定运算中所需的公式；</li>
<li><strong>第二组</strong> 由九到十个擅长数学的人组成，他们负责计算出一些关键数据，并把第一组制定好的公式进行简化；</li>
<li><strong>第三组</strong> 由约一百名计算人员组成，他们利用第二组提供的关键数据和公式，做最简单的加减操作就能得出最终结果。</li>
</ul>
<p>第三组的工作简单到什么程度，就是他们甚至都不知道自己正在算什么玩意儿，事实上他们的文化程度大部分都不高，里头好多都是理发师、失业人员什么的。可见即便文盲都能完成的计算，在那个时代还是得依靠人力去做。</p>
<p>而为了保证用表的正确性，普罗尼要求 <strong>每个数至少算两遍</strong>，并且 <strong>要在法国的不同地点用不同的方法计算</strong>。这项劳民伤财的工程整整进行了十年才完成，然而不幸的是，<strong>最终的表里仍然有错</strong>。说到这一点，可以说，那个时代基本没有一版数学用表是完全正确的，有些版本甚至错误百出，要知道数学用表出错有时后果会很严重，比如航海表一出错就可能直接导致船毁人亡。</p>
<p><strong>巴贝奇</strong> 在了解到普罗尼的事迹后泪流满面，决心要做一套完全正确的数学用表，为达目的，他尝试了各种减少错误的手段，比如调整纸张和墨水的颜色以提高数字的识别度，直接拿现有的多个版本的表进行誊抄、比对、让不同人员反复校对，在 <code>1827</code> 年出版了一个版本，结果里头还是有错。<strong>只要是人为的就没有完美的</strong>，巴贝奇彻底跪了，他发誓要造一台机器，让机器去生产数学表。</p>
<p>这就是史上著名的 <strong>差分机</strong> 了。</p>
<blockquote>
<p>伦敦科学博物馆·差分机设计图纸&amp;半成品：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-4bc4354c797ffe4a.png" alt=""></p>
</blockquote>
<h2 id="第一台真正意义上的电脑-分析机"><a href="#第一台真正意义上的电脑-分析机" class="headerlink" title="第一台真正意义上的电脑 | 分析机"></a>第一台真正意义上的电脑 | 分析机</h2><p>尽管没能亲手实现差分机，但巴贝奇并不会气馁，或者说他本来就是根本停不下来的那种人。明知实现不了，巴贝奇仍在一刻不停地改进着自己的设计，直到有一天，他构思出了一种空前的机器——分析机，正式成为现代计算机史上的第一位伟大先驱。 <em>(Father of computing)</em></p>
<p><code>1834</code> 年，分析机概念诞生之际，巴贝奇自己都为之感到无比震惊。在此之前，任何一台计算机器都只能完成其被预定赋予的计算任务，要么是简单的加减乘除，要么像差分机那样只能做差分运算，它们都属于 <code>calculator</code>，而分析机才是真正的 <code>computer</code>，它不局限于特定功能，而竟然是可编程的，可以用来 <strong>计算任意函数</strong>——现代人无论如何也无法想象在一坨齿轮上写程序是怎样一种体验吧！</p>
<p>巴贝奇设计的分析机主要包括三大部分： </p>
<ol>
<li>用于存储数据的计数装置，巴贝奇称之为 <strong>“仓库”（store）</strong>，相当于现在 <strong>CPU 中的存储器</strong>，这部分是从差分机上的计数装置改进而来的，我们很容易想象它的模样；</li>
<li>专门负责四则运算的装置，巴贝奇称之为 <strong>“工厂”（mill）</strong>，相当于现在 <strong>CPU 中的运算器</strong>，这部分的结构相对复杂，巴贝奇针对乘除法还做了一些优化； </li>
<li>控制操作顺序、选择所需处理的数据和输出结果的装置，巴贝奇没有起名字，由于其呈桶状，我们可以叫它 <strong>“控制桶”</strong>，控制桶显然相当于现在 <strong>CPU 中的控制器</strong>。 </li>
</ol>
<p>以上三部分，加上巴贝奇并没有疏漏的输入输出设备，我们惊讶地发现，<strong>分析机的组成部分和现在冯·诺依曼架构所要求的五大部件一模一样！</strong> </p>
<p>巴贝奇另一大了不起的创举就是将 <strong>穿孔卡片（punched card）</strong> 引入了计算机器领域，用于控制数据输入和计算，从那时起，到第一台电子计算机诞生为止，期间几乎所有的数字计算机都使用了穿孔卡片。</p>
<p>[图片上传失败…(image-14c434-1594826100047)]</p>
<p>整个分析机就是在类似这样的齿轮和拉杆作用下实现可编程运算的：先从数据卡片读入数据到存储器，再将存储器中的数据传输到运算器，运算器算完后又将数据传回存储器。</p>
<p>可惜的是，巴贝奇穷其一生也没能真正把分析机做出来，留给后世的又是一台模型机和两千多张图纸，以及这样一段遗言：</p>
<p><em>「如果一个人不因我一生的借鉴而却步，仍然一往直前制成一台本身具有全部数学分析能力的机器……那么我愿将我的声誉毫不吝啬地让给他，因为只有他能够完全理解我的种种努力以及这些努力所得成果的真正价值。」</em></p>
<blockquote>
<p>伦敦科学博物馆·分析机设计图纸&amp;模型机：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-204037703964ebfc.png" alt=""></p>
</blockquote>
<h2 id="穿孔时代的到来-制表机"><a href="#穿孔时代的到来-制表机" class="headerlink" title="穿孔时代的到来 | 制表机"></a>穿孔时代的到来 | 制表机</h2><p>从 <code>1790</code> 年开始，美国每 <code>10</code> 进行一次人口普查。百年间，随着人口繁衍和移民的增多，从 <code>1790</code> 年的 <code>400</code> 万不到，到 <code>1880</code> 年的 <code>5000</code> 多万，人口总数呈爆炸式地增长。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-85d1fc8fa7c22b0f.png" alt="1790~1880 年美国人口增长曲线"></p>
<p>不像现在这个的互联网时代，人一出生，各种信息就已经电子化、登记好了，甚至还能数据挖掘，你无法想象，在那个计算设备简陋得基本只能靠手摇进行四则运算的 <code>19</code> 世纪，千万级的人口统计就已经成了当时政府的 <strong>“不能承受之重”</strong>。</p>
<p><code>1880</code> 年开始的第 <code>10</code> 次人口普查，历时 <code>8</code> 年才最终完成，也就是说，他们在休息两年之后就要开始第 <code>11</code> 次普查了，而这一次普查，需要的时间恐怕要超过 <code>10</code> 年，那第 <code>12</code> 次、<code>13</code> 次呢？本来就是 <code>10</code> 年一次的统计，如果每次耗时都在 <code>10</code> 年以上，这件事情就变得没有意义了。</p>
<p>这可愁煞了当时的人口调查办公室，他们决定面向全社会招标，寻求能减轻手工劳动、提高统计效率的发明。正所谓机会都是给有准备的人的，一位毕业于哥伦比亚大学的年轻人 <strong>赫尔曼·霍尔瑞斯</strong> <em>（Herman Hollerith）</em> 带着他在 <code>1884</code> 年申请的专利从众多方案中脱颖而出。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-cf061bfcfb4fecfa.png" alt=""></p>
<h3 id="制表机"><a href="#制表机" class="headerlink" title="制表机"></a>制表机</h3><p>他发明的机器叫 <strong>制表机</strong> <em>（tabulator/tabulating machine）</em>，顾名思义，就是专门用来制作数据统计表的机器。制表机主要由示数装置、穿孔机、读卡装置和分类箱组成。</p>
<p>示数装置包含 <code>4</code> 行、<code>10</code> 列共 <code>40</code> 个示数表盘，每个盘面被均匀地分成 <code>100</code> 格，并装有两根指针，和钟表十分相像，“分针” 转一圈可计 <code>100</code>，“时针” 转一圈则计 <code>10000</code>。可见，整个示数装置可以表达很庞大的数据。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-ea6a6ff1d89422e1.png" alt=""></p>
<p>制表机的工作是围绕穿孔卡片展开的：操作员先使用穿孔机制作穿孔卡片，再使用读卡装置识别卡片上的信息，机器自动完成统计并在示数表盘上实时显示结果，最后，将卡片投入分类箱的某一格中，进行分类存放，以供下次统计使用。</p>
<h3 id="穿孔卡片的应用"><a href="#穿孔卡片的应用" class="headerlink" title="穿孔卡片的应用"></a>穿孔卡片的应用</h3><p>此前的某一天，霍尔瑞斯正在火车站排队检票，目光不经意落到检票员手中咔咔直响的打孔机上。他发现，检票员会特意根据乘客的性别和年龄段，在车票的不同地方打孔。越来越多的人过检，他进一步确认了这个规律。一个灵感朝他袭来：如果有一张更大的卡，上面有更多的位置可以打孔，就可以用来表示更多的身份信息，包括国籍、人种、性别、生日等等。</p>
<p>这就是用在 <code>1890</code> 年人口普查中的穿孔卡片，一张卡片记录一个居民的信息。卡片设计长约 <code>18.73cm</code>，宽约 <code>8.26cm</code>，正好是当时一张美元纸币的尺寸，因为霍尔瑞斯直接用财政部装钱的盒子来装卡片。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-8c71b8e877734daa.png" alt=""></p>
<p>卡片设有 <code>300</code> 多个孔位，与雅卡尔和巴贝奇的做法一样，靠每个孔位打孔与否来表示信息。<strong>尽管这种形式颇有几分二进制的意味，但当时的设计还远不够成熟，并没有用到二进制真正的价值</strong>。举个例子，我们现在一般用 <code>1</code> 位数据就可以表示性别，比如 <code>1</code> 表示男性，<code>0</code> 表示女性，而霍尔瑞斯在卡片上用了两个孔位，表示男性就其中一处打孔，表示女性就在另一处打孔。其实性别还凑合，表示日期时浪费得就多了，<code>12</code> 个月需要 <code>12</code> 个孔位，而常规的二进制编码只需要 <code>4</code> 位。当然，这样的局限也与制表机中简单的电路实现有关。</p>
<p>细心的读者可能发现卡片的右下角被切掉了，那不是残缺，而是为了避免放反而专门设计的，和现在的二维码只有 <code>3</code> 个角是一个道理。</p>
<p>这类实用的细节设计在穿孔机上表现得更为出色。下图为一位操作员正在使用穿孔机给卡片打孔的情景，她并不需要在卡片上吃力地搜寻孔位，而是直接对着孔距更大的操作面板打孔，一根杠杆将两者的孔位一一对应。操作面板还做成了弧形，颇有一分如今人体工程学键盘的风姿。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-61131c198723119f.png" alt=""></p>
<p>在制表机前，穿孔卡片（或纸带）多用于存储指令而不是数据。比较有代表性的，一是雅卡尔提花机，用穿孔卡片控制经线提沉；二是自动钢琴，用穿孔纸带控制琴键压放。美剧《西部世界》中，每次故事循环的开始，都会给一个自动钢琴的特写，弹奏起看似宁静安逸、实则诡异违和的背景乐。</p>
<p>是霍尔瑞斯将穿孔卡片作为 <strong>数据存储介质</strong> 开来，并开启了一个崭新的 <strong>数据处理纪元</strong>。后来人们也把这类卡片称为霍尔瑞斯卡片，穿孔卡片和穿孔纸带作为输入输出载体，统治了计算领域整整一个世纪。</p>
<h2 id="单元记录时代"><a href="#单元记录时代" class="headerlink" title="单元记录时代"></a>单元记录时代</h2><p>在制表机的高效运转下，<code>1890</code> 年的人口普查只花了 <code>6</code> 年时间。<code>1896</code> 年，霍尔瑞斯成立制表机公司（The Tabulating Machine Company）并不断改进自己的产品，先后与英国、意大利、德国、俄罗斯、澳大利亚、加拿大、法国、挪威、美国波多黎各、古巴、菲律宾等多个国家和地区合作开展了人口普查。</p>
<p>到 <code>1914</code> 年，制表机公司每天生产的穿孔卡片多达 <code>200</code> 万张。不多久，一些竞争对手逐渐起家，历史迎来了繁荣的数据处理时代。它们的产品也不再局限于人口普查，逐渐扩展到会计、库存管理等一些同样需要跟大数据打交道的领域，这些机器作为制表机的后裔被统称为单元记录设备（unit record equipment）。</p>
<p>围绕穿孔卡片的制卡、读卡、数据处理和卡片分类是它们的标准功能，穿孔机、读卡器、分类器是它们的标准配置。这些部件的自动化程度越来越高，比如手动的读卡装置很快被自动读卡机所取代，读卡速度从每分钟 <code>100</code> 张逐步提高至每分钟 <code>2000</code> 张。随着识别精度的提高，卡片的孔距也越来越小，具有 <code>80～90</code> 列孔位的卡片成为主流，有些卡片的孔位甚至多达 <code>130</code> 列。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-d0cbead1e22293b1.png" alt="20 世纪典型的 80 系穿孔卡片"></p>
<p>机器的功能也逐渐强大，不再只是简单地统计穿孔数目，减法、乘法等运算能力陆续登场。<code>1928</code> 年，哥伦比亚大学的科学家们甚至用单元记录设备计算月球的运行轨迹，他们在 <code>50</code> 万张卡片上打了 <code>2000</code> 万个孔，彰显着单元记录设备的无限潜力。</p>
<p>机器的电路实现越来越复杂，但同时也越来越通用。<code>1890</code> 年所用的那台制表机的 <strong>线路是固定的，遇到新的统计任务，改造起来十分麻烦。</strong></p>
<p><code>1906</code> 年，霍尔瑞斯便引入了接插线板（plugboard）——一块布满导电孔的板卡，可通过改变导线插脚在板上的位置改变线路逻辑。试想一下，接插线板的内部已经布好了具有各种功能的线路，但它们都处在断开状态，各自连接着接插线板上的某两个孔位，像一窝嗷嗷待哺的小鸟长大着嘴巴，外部的导线就像美味的虫子，当虫子的头尾分别与小鸟的上喙和下喙接触，线路就被导通，这只小鸟就开始工作了。如此，每次使用就可以激活不同的 “小鸟”，从而完成不同的任务。<strong>这已经是一种可编程性的体现。</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-070916e8c03eb0c7.png" alt=""></p>
<p><code>1911</code> 年，制表机公司与另外 <code>3</code> 家公司合并成立 <strong>CTR</strong> 公司 <em>（Computing-Tabulating-Recording Company）</em>，制表机公司作为其子公司继续运营到 <code>1933</code> 年。</p>
<p><code>1924</code> 年，<strong>CTR</strong> 更名为 <strong>国际商业机器公司</strong>（<strong>I</strong>nternational <strong>B</strong>usiness <strong>M</strong>achines Corporation），就是现在大名鼎鼎的 <strong>IBM</strong> 公司。可见，在如今众多年轻的 IT 公司中，拥有百年历史的 IBM 是位当之无愧的前辈，它完整地参与和见证了整个现代计算机的发展史。IBM 保持了制表机公司在单元记录市场的龙头地位，到 <code>1955</code> 年，其每天生产的穿孔卡片多达 <code>7250</code> 万张。</p>
<p><code>1937</code> 年开始，单元记录设备逐步电子化，与电子计算机的界线渐渐模糊，并最终为后者让路。随着 <code>1976</code> 年 IBM 一型最核心的单元记录产品的停产，短暂的单元记录时代也宣告谢幕，它仿佛是电子计算时代来临前的预演和铺垫，许多设计被沿用下来，比如穿孔卡片和接插线板。</p>
<p>有趣的是，即使电子计算机逐渐普及，许多机构由于用惯了单元记录设备，迟迟不愿更换，少数机构甚至一直用到了 <code>21</code> 世纪。</p>
<h2 id="一句话总结"><a href="#一句话总结" class="headerlink" title="一句话总结"></a>一句话总结</h2><p><strong>编程能够帮助我们解决一些非常实际的问题</strong>，用一种非常酷的方式。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-7b49c7549420ee36.png" alt=""></p>
<blockquote>
<p>感兴趣也可以扩展阅读一下：<a href="https://www.infoq.cn/article/5CaYH8NbS6BmptWKRgkX" target="_blank" rel="noopener">改变世界的代码行</a></p>
</blockquote>
<h1 id="Part-2-二进制和-CPU-原理-编码中蕴藏的智慧"><a href="#Part-2-二进制和-CPU-原理-编码中蕴藏的智慧" class="headerlink" title="Part 2. 二进制和 CPU 原理 | 编码中蕴藏的智慧"></a>Part 2. 二进制和 CPU 原理 | 编码中蕴藏的智慧</h1><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-e023b808f7fc9d07.png" alt=""></p>
<ul>
<li>原文地址：<a href="https://www.wmyskxz.com/2020/06/02/morethanjava-yi-wen-liao-jie-er-jin-zhi-he-cpu-gong-zuo-yuan-li/#toc-heading-6">「MoreThanJava」一文了解二进制和CPU工作原理</a></li>
</ul>
<h2 id="原来，我们是这样计数的"><a href="#原来，我们是这样计数的" class="headerlink" title="原来，我们是这样计数的"></a>原来，我们是这样计数的</h2><p>在讨论「二进制」和「CPU 如何工作」之前，我们先来讨论一下我们生活中最稀疏平常的 <strong>数字</strong>，我们与之频繁地打交道：一个约定的时间、一件商品的价格、一个人的身高….却很少有人细细想过，这些数字是如何表达出来的？为什么你理所当然地把 <code>1024</code> 理解为「一千零二十四」而不是别的含义？</p>
<p>也许你从未想过，在这简单的记数中，沉淀着人类的大智慧。</p>
<h3 id="一进制计数法"><a href="#一进制计数法" class="headerlink" title="一进制计数法"></a>一进制计数法</h3><p>早在数字的概念产生之前，人类就学会了使用树枝、石子、贝壳等自然界随处可见的小物件表示猎物的、果实的、部落人口的数量。比如在某个角落堆上一堆石子，每打到 1 只猎物，就扔 1 颗石子进去，每吃掉 2 只猎物，就从中取走 2 颗石子。他们并不在意石子的总数，只是时不时地瞅一眼，心底大致有数。</p>
<p>其实这是一种最朴素的记数方式，数学家称之为 <strong>一进制记数法</strong>（unary numeral system）。我们把它符号化一下，比如用斜杠 <code>/</code> 来表示：</p>
<ul>
<li><code>1</code> 就是 <code>/</code>；</li>
<li><code>2</code> 就是 <code>//</code>；</li>
<li><code>4</code> 就是 <code>////</code>；</li>
</ul>
<p>好像没毛病，我们平时掰手指用的就是这种记数法，但数字一大，场面就要失控了。</p>
<h3 id="符值相加记数法"><a href="#符值相加记数法" class="headerlink" title="符值相加记数法"></a>符值相加记数法</h3><p>为了解决记录大数的问题，于是我们得发明一些其他符号来表示更大的数值，比如用横杠 <code>-</code> 表示 <code>10</code>，用十字 <code>+</code> 表示 <code>100</code>。那么：</p>
<ul>
<li><code>16</code> 就是 <code>-//////</code>;</li>
<li><code>32</code> 就是 <code>---//</code>;</li>
<li><code>128</code> 就是 <code>+--////////</code>;</li>
</ul>
<p>漂亮….这种靠符号类型和符号数量表示数字的方法被称为 <strong>符值相加记数法</strong>（sign-value notation），古埃及和古罗马用的都是它，只不过符号各不相同。</p>
<p>古埃及的记数符号：</p>
<table>
<thead>
<tr>
<th align="left">1</th>
<th align="left">10</th>
<th align="left">100</th>
<th align="left">1000</th>
<th align="left">10000</th>
<th align="left">100000</th>
<th align="left">1000000</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><img src="https://upload-images.jianshu.io/upload_images/7896890-1db97e9b1a66b339.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></td>
<td align="left"><img src="https://upload-images.jianshu.io/upload_images/7896890-2157efef31e10459.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></td>
<td align="left"><img src="https://upload-images.jianshu.io/upload_images/7896890-b631fde4ed2dc11d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></td>
<td align="left"><img src="https://upload-images.jianshu.io/upload_images/7896890-1a98bc2c48ce4b6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></td>
<td align="left"><img src="https://upload-images.jianshu.io/upload_images/7896890-a262b0f9e2ab76e0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></td>
<td align="left"><img src="https://upload-images.jianshu.io/upload_images/7896890-84a15c3e83151fdf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></td>
<td align="left"><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-2782ee793a2cbd56.png" alt=""></td>
</tr>
</tbody></table>
<p><code>1024</code> 在古埃及就写作：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-f2d3840dd6c07bcc.png" alt=""></p>
<p><strong>你会发现，符值相加记数法的一大优点是，符号的顺序可以任意打乱，数字含义不受影响</strong>。我国藏族曾用石子表示 <code>1</code>、木棍表示 <code>10</code>、果核表示 <code>100</code>、蚕豆表示 <code>1000</code>、瓦片表示 <code>10000</code>，那么，当你把 <code>1</code> 颗蚕豆、<code>2</code> 根木棍和 <code>4</code> 颗石子胡乱地攥在手里，别人依然知道它们是 <code>1024</code>。</p>
<p>古罗马的做法略有不同，他们对五进制情有独钟：</p>
<table>
<thead>
<tr>
<th align="left">1</th>
<th align="left">5</th>
<th align="left">10</th>
<th align="left">50</th>
<th align="left">100</th>
<th align="left">500</th>
<th align="left">1000</th>
</tr>
</thead>
<tbody><tr>
<td align="left">I</td>
<td align="left">V</td>
<td align="left">X</td>
<td align="left">L</td>
<td align="left">C</td>
<td align="left">D</td>
<td align="left">M</td>
</tr>
</tbody></table>
<p>这些符号沿用至今，想必大家（至少对前 <code>3</code> 个）都比较熟悉，许多钟表仍保留着使用罗马数字的习惯，<code>1~12</code> 分别表示为：<code>I</code>、<code>II</code>、<code>III</code>、<code>IV</code>、<code>V</code>、<code>VI</code>、<code>VII</code>、<code>VIII</code>、<code>IX</code>、<code>X</code>、<code>XI</code>、<code>XII</code>。你会发现，罗马记数法是符值相加记数法的变种，因为它不光「相加」，还「相减」。这种方式就不允许符号乱序了，<code>IV</code> 和 <code>VI</code> 表示的是不同的数字。</p>
<p>那罗马人何苦要使用这种更复杂的记数法呢？无非是为了读写方便。同样表示 <code>9</code>，<code>IX</code> 比 <code>VIIII</code> 更简洁。</p>
<p>其实有一种更好使的方法——用另外一些列符号来表示符号的数量。比如用 <code>A</code> 表示 <code>1</code> 个符号，用 <code>B</code> 表示 <code>2</code> 个符号，以此类推，用 <code>I</code> 表示 <code>9</code> 个符号。</p>
<p>如此，上文表示 <code>256</code> 的 <code>++-----//////</code> 就可以写作 <code>B+E-F/</code>。你一定感觉莫名其妙，这种写法哪里方便了。其实中文的数字表示就是这种形式，只不过我们用得太习惯了，以至于没有发现。</p>
<p>在中文中，<code>个</code>、<code>十</code>、<code>百</code> 代替了 <code>/</code>、<code>-</code>、<code>+</code>，而 <code>一</code>、<code>二</code>、<code>三</code> 代替了 <code>A</code>、<code>B</code>、<code>C</code>。<code>256</code> 就写作 <code>二百五十六个</code>，<code>个</code> 比较累赘，我们通常把它省略了。</p>
<p>其实像日语、英语用的也同样是这种记数法，简洁、优雅。</p>
<p>美中不足的是，这种形式虽便于读写，却不便于计算。中国古人为算筹和算盘这类经典算具搭建起广阔的舞台，却没给笔算留出一席之地。想象一下，如果让你把这些汉字写在草稿纸上，列个竖式，你的内心一定非常别扭。</p>
<h3 id="位值制记数法"><a href="#位值制记数法" class="headerlink" title="位值制记数法"></a>位值制记数法</h3><p>公元5世纪，印度数学家阿耶波多（Aryabhata 476–550）创立了现在广泛使用的 <strong>位值制记数法</strong>（positional notation/place-value notation），该记数法使用的主要符号，是同为印度人发明的阿拉伯数字：<code>0</code>、<code>1</code>、<code>2</code>、<code>3</code>、<code>4</code>、<code>5</code>、<code>6</code>、<code>7</code>、<code>8</code>、<code>9</code>。</p>
<p>与符值相加记数法类比，位值制中的 <code>1</code>、<code>2</code>、<code>3</code> 代替的是 <code>A</code>、<code>B</code>、<code>C</code>，那 <code>/</code>、<code>-</code>、<code>+</code> 呢？是 <strong>靠阿拉伯数字的位置来表示的</strong>。众所周知，最右位相当于 <code>/</code>，次右位相当于 <code>-</code>。<strong>靠每个位置上的数值来表示数字，故名位值制。</strong></p>
<p>严谨的数学家用一种多项式高度概括了位值制记数法的本质，在十进制中，这个多项式是这样的：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-cea5ae3d7565bdcd.png" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-805b564507966875.png" alt=""></p>
<p>这是一个 <code>n</code> 位十进制数，a<sub>i</sub> 就是第 i 位上的数值。为便于直观理解，举个 <code>1024</code> 的例子吧：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-40db28c8206cc3e8.png" alt=""></p>
<p>由于我们熟悉了十进制，这样费心费力的展开可能会让你觉得好笑，但当我们把它推广到其他进制时，这个多项式的价值就体现了出来。<strong>n 位 b 进制数的位值制表示：</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-e121104f0c3c1fca.png" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-788e7702076fdf9b.png" alt=""></p>
<p><code>1024</code> 用二进制怎么表示？</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-c93f51767fe13dbf.png" alt=""></p>
<p>因此，<code>1024</code> 的二进制写作 <code>10000000000</code>。</p>
<p>除了最普遍的十进制和计算机中的二进制，常见的还有七进制（如 <code>1</code> 周 <code>7</code> 天）、十二进制（如 <code>1</code> 年 <code>12</code> 个月）、十六进制（如古代 <code>1</code> 斤 <code>16</code> 两）、六十进制（如六十甲子）等等，只要有意义，任何进制都可以为你所用。</p>
<h2 id="为什么使用二进制"><a href="#为什么使用二进制" class="headerlink" title="为什么使用二进制"></a>为什么使用二进制</h2><p>至此，你对「二进制」或许不再那么陌生，它仅仅是数制的一种而已。</p>
<p>可为什么一定是二进制呢？使用人类习惯的十进制不好吗？</p>
<h3 id="理由一：物理上易于实现"><a href="#理由一：物理上易于实现" class="headerlink" title="理由一：物理上易于实现"></a>理由一：物理上易于实现</h3><p>计算机依靠电力工作，这也就意味着需要将数字信号映射到电信号，实现这种映射最简单的方法是：</p>
<ul>
<li>0 - 没有电（0 V）</li>
<li>1 - 有点（5 V）</li>
</ul>
<p>二进制在技术上最容易实现。这是因为具有两种 <strong>稳定状态</strong> 的物理器件很多，如门电路的导通与截止、电压的高与低等，而它们恰好可以对应表示 “1” 和 “0” 这两个数码。假如采用十进制，那么就要制造具有 <code>10</code> 种 <strong>稳定状态</strong> 的物理电路，而这是非常困难的。</p>
<h3 id="理由二：机器可靠性高"><a href="#理由二：机器可靠性高" class="headerlink" title="理由二：机器可靠性高"></a>理由二：机器可靠性高</h3><p>为什么使用更复杂的数字系统是一个问题？</p>
<p>假设我们使用三元（3 位数字）数字系统涉及计算机，如果我们具有从 <code>0 V</code> 到 <code>5 V</code> 的电压，那么我们可以进行以下的映射：</p>
<ul>
<li>0 - 0 V;</li>
<li>1 - 2.5 V;</li>
<li>2 - 5 V;</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-67c70d38b00ae126.png" alt=""></p>
<ul>
<li>图片来源：<a href="https://pmihaylov.com/intro-binary-numbers/" target="_blank" rel="noopener">https://pmihaylov.com/intro-binary-numbers/</a></li>
</ul>
<p>看起来合理吧？但是，想象一下，我以 <code>2.5 V</code> 的电压发送了一个数字。但是由于电路中的一些噪声，我在输出端得到 <code>2.3 V</code> 的电压，因此将其视为 <code>0</code>。结果是？</p>
<p>有人给我发送了 <code>1</code>，但我将其视为 <code>0</code>。数据丢失可是一个非常严重的问题。</p>
<p>使用二进制则可靠得多，由于电压的高和低、电流的有和无等都是一种 <strong>质的变化</strong>，两种物理状态稳定、分明，因此，二进制码传输的抗干扰能力强，鉴别信息的可靠性高。</p>
<h4 id="为什么计算机系统必须有时钟"><a href="#为什么计算机系统必须有时钟" class="headerlink" title="为什么计算机系统必须有时钟"></a>为什么计算机系统必须有时钟</h4><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-fd12ddd0bca3e512.png" alt=""></p>
<ul>
<li>图片来源：<a href="http://programmedlessons.org/Java9/chap02/ch02_11.html" target="_blank" rel="noopener">http://programmedlessons.org/Java9/chap02/ch02_11.html</a></li>
</ul>
<p>建立数字系统的目的是 <strong>仅在某些时间点测试开/关（二进制）值</strong>，这使电线（或其他设备）有时间更换。<strong>这就是计算机系统有时钟的原因。</strong></p>
<p>时钟会周期性地进行信号的测量，图中所示的 T1 和 T2 就是可以测量信号的时间点。</p>
<p>时钟利用所有这些时间点来保持同步。更快的时钟意味着每秒可以对电线进行更多次测试，并且整个系统运行得更快。<code>2 GHz</code> 处理器每秒检查二进制值 <code>20</code> 亿次。在这些时间之间，允许值改变并稳定下来。处理器芯片速度越快，每秒可以测试的次数就越多，每秒可以做出的决策就越多。</p>
<h3 id="理由三：运算规则简单"><a href="#理由三：运算规则简单" class="headerlink" title="理由三：运算规则简单"></a>理由三：运算规则简单</h3><p>数学推导已经证明，对 <code>N</code> 进制数进行算术求和或求积运算，其运算规则各有 <code>N(N+1)/2</code> 种。如采用十进制，则 <code>N=10</code>，就有 <code>55</code> 种求和或求积的运算规则；而采用二进制，则 <code>N=2</code>，仅有 <code>3</code> 种求和或求积的运算规则，以上面提到的加法为例：</p>
<pre class=" language-text"><code class="language-text">0+0=0，0+1=1 (1+0=1)，1+1=10</code></pre>
<p>因而可以大大简化运算器等物理器件的设计。</p>
<h3 id="理由四：逻辑判断方便"><a href="#理由四：逻辑判断方便" class="headerlink" title="理由四：逻辑判断方便"></a>理由四：逻辑判断方便</h3><p>采用二进制后，仅有的两个符号 <code>“1”</code> 和 <code>“0”</code> 正好可以与逻辑命题的两个值 “真” 和 “假” 相对应，能够方便地使用逻辑代数这一有力工具来分析和设计计算机的逻辑电路。</p>
<p>虽然在 <code>1950</code> 年代就造出了更加高效的三元计算机，但在效率和复杂度的取舍上，始终抵不过二进制。二进制仍然在当今世界中长期存在。</p>
<h2 id="CPU-的实际工作方式简单演示"><a href="#CPU-的实际工作方式简单演示" class="headerlink" title="CPU 的实际工作方式简单演示"></a>CPU 的实际工作方式简单演示</h2><p>上面我们了解到计算机以二进制的形式运行，它们只有两种状态：开（1）和关（0），为了执行二进制计算，我们需要采用一种特殊的电子元器件，称为 <strong>「晶体管」</strong>。暂时我们把它理解为一种开关吧，通电就打开，没电流通过就关闭。</p>
<h3 id="利用「开关」搭建逻辑电路"><a href="#利用「开关」搭建逻辑电路" class="headerlink" title="利用「开关」搭建逻辑电路"></a>利用「开关」搭建逻辑电路</h3><p>我们知道，给电灯通上电，它就会亮：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-21aa883da3442d74.png" alt=""></p>
<p>于是，结合上开关，我们就能搭建出最基础的 <strong>与门</strong> 和 <strong>或门</strong>。</p>
<h4 id="与门"><a href="#与门" class="headerlink" title="与门"></a>与门</h4><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-dd1909130caa5270.png" alt=""></p>
<p>该电路的逻辑是：<strong>只有当 A 和 B 同时开启时，LED 灯才会亮</strong>，也就是认为输出 1，我们可以利用电信号来简单模拟一下：</p>
<table>
<thead>
<tr>
<th align="left">A</th>
<th align="left">B</th>
<th align="left">Y</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left"><strong>1</strong></td>
<td align="left"><strong>1</strong></td>
<td align="left"><strong>1</strong></td>
</tr>
</tbody></table>
<h4 id="或门"><a href="#或门" class="headerlink" title="或门"></a>或门</h4><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-211665a1cf4b1c80.png" alt=""></p>
<p>该电路的逻辑是：<strong>当 A 或者 B 开启时，LED 灯就会亮</strong>，也就是认为输出 1，我们可以利用电信号来简单模拟一下：</p>
<table>
<thead>
<tr>
<th align="left">A</th>
<th align="left">B</th>
<th align="left">Y</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">0</td>
<td align="left"><strong>1</strong></td>
</tr>
<tr>
<td align="left">0</td>
<td align="left">1</td>
<td align="left"><strong>1</strong></td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">1</td>
<td align="left"><strong>1</strong></td>
</tr>
</tbody></table>
<h4 id="其他门"><a href="#其他门" class="headerlink" title="其他门"></a>其他门</h4><p>类似地，我们可以借助更多的电子元器件来创造出基础的 <code>7</code> 种逻辑门电路：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-49996b6d3187d909.png" alt=""></p>
<ul>
<li>图片来源：<a href="https://www.zhihu.com/question/348237008/answer/843382847" target="_blank" rel="noopener">https://www.zhihu.com/question/348237008/answer/843382847</a> | @Zign</li>
</ul>
<p>这里需要特别提一下 <strong>异或门</strong>，我们需要先知道有一种电子元器件可以利用电气特性对 <strong>输入取反</strong>，也就是说输入 <code>1</code> 则输出 <code>0</code>，输入 <code>0</code> 则输出 <code>1</code>，那么我们就可以 <strong>简单模拟</strong> 出异或门逻辑电路（实际会更复杂些，这里仅展示出异或的意思）：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-3ca50f593a26487b.png" alt=""></p>
<p><code>A&#39;</code> 和 <code>B&#39;</code> 分别表示 <code>A</code> 和 <code>B</code> 开关的反值，从图中我们很容易知道只有当 <code>A</code>、<code>B</code> 只存在一个输入 <code>1</code> 时，整个电路才会输出 <code>1</code>。</p>
<h3 id="利用逻辑门制作简单加法器演示"><a href="#利用逻辑门制作简单加法器演示" class="headerlink" title="利用逻辑门制作简单加法器演示"></a>利用逻辑门制作简单加法器演示</h3><p>OK，上面我们了解到我们能够利用 “开关” 来模拟逻辑的运算，我们接下来试着还原一个简单的加法运算器是如何实现的：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-160e516bc2f57614.png" alt=""></p>
<p>仅需两个门，就可以完成基本的二进制加法运算。上图是利用 <code>logic.ly</code> 创建的半加法器，<code>A</code>、<code>B</code> 相当于使我们计算的两个数，最后一块相当于是我们的数显芯片，它的功能是根据输入显示数字，从上到下的引脚（也就是图中输入的地方，通常我们这样称呼）分别对应了 <strong>2<sup>0</sup>=1</strong>、<strong>2<sup>1</sup>=2</strong>、<strong>2<sup>2</sup>=4</strong>、<strong>2<sup>3</sup>=8</strong> 的输入，没有任何输入时显示为 <code>0</code>，如果 <code>引脚 1</code>（对应 <strong>2<sup>0</sup>=1</strong>）像上图一样有输入，则显示 <code>0 + 1 = 1</code>。</p>
<p>我们来理解一下上方的电路：</p>
<ul>
<li>如果仅打开一个输入，但不同时打开两个输入，则此处的 XOR 门（异或门）将打开，此时对应输入 <code>引脚 1</code>，显示 <code>数字 1</code>（类似于 <code>1 + 0 和 0 + 1</code>)；</li>
<li>如果两个输入均打开，则 AND 门(与门)将打开，此时对应输入 <code>引脚 2</code>，显示 <code>数字 2</code>（类似于 <code>1 + 1</code>）；</li>
<li>如果没有输入，则 AND 门和 XOR 门都保持关闭，此时显示 <code>数字 0</code>（类似于 <code>0 + 0</code>）；</li>
</ul>
<p>因此，如果两个都打开，则 XOR 保持关闭，并且 AND 门打开，得出正确的答案为 <code>2</code>：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-d67ba0a0b17caa67.png" alt=""></p>
<p>但这只是最基础的半加法运算器，不是太有用，因为它只能解决最简单的数学问题之一。但如果我们把它们两个与另一个输入连接，就会得到一个完整的加法器：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-b21731da4d9b8c8c.png" alt=""></p>
<p>仔细思考几遍，你就会得知这个三个输入的加法器已经可以计算 <code>3</code> 个二进制数字的加法运算了，我们如法炮制，可以通过连接更多的”进位”来使这个加法器能够运算更多的数，这当然也意味着这个计算链条更长。 </p>
<p>大多数其他数学运算都可以加法完成。乘法只是重复加法，减法可以通过一些奇特的位反转来完成，而除法只是重复减法。并且，尽管所有现代计算机都具有基于硬件的解决方案以加快更复杂的操作，但从技术上讲，您可以使用完整的加法器来完成全部操作。</p>
<h2 id="一句话总结-1"><a href="#一句话总结-1" class="headerlink" title="一句话总结"></a>一句话总结</h2><p>编码伴随探索和学习新知的过程，如果愿意，我们能从中获取很多类似于解出一道数学题的乐趣。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-4e6a6242fa01f8ce.png" alt=""></p>
<h1 id="Part-3-机器指令到高级语言-站在先驱巨人的肩膀"><a href="#Part-3-机器指令到高级语言-站在先驱巨人的肩膀" class="headerlink" title="Part 3. 机器指令到高级语言 | 站在先驱巨人的肩膀"></a>Part 3. 机器指令到高级语言 | 站在先驱巨人的肩膀</h1><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-79e712f4603e2019.png" alt=""></p>
<ul>
<li>原文地址：<a href="https://www.wmyskxz.com/2020/06/04/morethanjava-ji-qi-zhi-ling-dao-hui-bian-zai-dao-gao-ji-bian-cheng-yu-yan/">「MoreThanJava」机器指令到汇编再到高级编程语言</a></li>
</ul>
<h2 id="机器指令"><a href="#机器指令" class="headerlink" title="机器指令"></a>机器指令</h2><p>我们已经了解了 <strong>二进制和 CPU 的基本原理</strong>，知道了程序运行时，CPU 每秒数以亿次、十亿次、百亿次地震荡着时钟，同步执行着微小的 <strong>「电子操作」</strong>，例如：从内存读取一个字节的数据到 CPU 又或者判断字节中的某一位是 <code>0</code> 还是 <code>1</code>。 </p>
<p><strong>CPU</strong> 本身有一组 <strong>规定好的</strong> 可以执行的 <strong>「基本动作」</strong>（被称为 <strong>机器指令</strong>）：</p>
<ol>
<li>读取指令；2. 执行指令；3. 写寄存器；</li>
</ol>
<p><strong>这几乎就是 CPU 工作的全部了。</strong> 这些动作虽然每次只能执行一次，但是每秒可以执行数十亿次，这个数量级的「小操作」累加成为一个大的「有用的操作」。</p>
<p>处理器所做的一切都是基于这些微小的操作！幸运的是，我们已经不再需要了解这些操作的详细信息就可以编写和使用各类程序。诸如 <strong>Java</strong> 这一类的 <strong>「高级语言」</strong> 的 <strong>目的</strong> 就是 <strong>将这些微小的电子操作组织成由人类可读的「程序语言」表示的大型有用单元</strong>。</p>
<p>尽管机器语言有一些反人类，但至少我们可以用它来来编写代码了，如：</p>
<pre class=" language-console"><code class="language-console">00000001 00000010 00000001
00000100 00000100 00000000</code></pre>
<p>似乎看着这一段儿代码有点迷糊，并且 <strong>可读性太差了</strong>。</p>
<p>如此你就会感知到 <strong>上个世纪</strong> 的程序员使用 <strong>打孔卡片</strong>：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-44fb9d2c629a4a77.png" alt=""></p>
<p>使用 <strong>纸带</strong>：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-69b6f0ab7afc12d0.png" alt=""></p>
<p>甚至是 <strong>直接插拔线路 or 按下开关</strong>：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-7a392e44b222b9f4.png" alt=""></p>
<p>是一件多么硬核的事情…</p>
<h2 id="汇编语言"><a href="#汇编语言" class="headerlink" title="汇编语言"></a>汇编语言</h2><p>PU 的指令都是 <strong>二进制</strong> 的，这显然对于人类来说是 <strong>不可读</strong> 的。为了解决二进制指令的可读性问题，工程师将那些指令写成了 <strong>八进制</strong>。二进制转八进制是轻而易举的，但是八进制的可读性也不行。</p>
<p>很自然地，最后还是用文字表达，加法指令写成 <code>ADD</code>。内存地址也不再直接引用，而是 <strong>用标签</strong> 表示。</p>
<p>这样的话，就多出一个步骤，<strong>要把这些文字指令翻译成二进制</strong>，这个步骤就称为 <code>assembling</code>，完成这个步骤的程序就叫做 <code>assembler</code>。它处理的文本，自然就叫做 <code>aseembly code</code>。标准化以后，称为 <code>assembly language</code>，缩写为 <code>asm</code>，中文译为 <strong>汇编语言</strong>。</p>
<h2 id="汇编语言演示"><a href="#汇编语言演示" class="headerlink" title="汇编语言演示"></a>汇编语言演示</h2><p>举个简单的例子，我们需要计算：</p>
<pre class=" language-text"><code class="language-text">(1 + 4) * 2 + 3</code></pre>
<p>我们按照 <strong>「后缀表示法」</strong> 进行一下转换：</p>
<pre class=" language-text"><code class="language-text">1，4，+，2，*，3，+</code></pre>
<p>我们平常使用的方法是 <strong>「中缀表示法」</strong>，也就是把计算符号放中间，例如 <code>1 + 3</code>，后缀则是把符号放最后，例如 <code>1, 3, +</code>。</p>
<p>这样做的好处是没有先乘除后加减的影响，也没有括号，直接运算就行了。<em>（例如 <code>1, 3, +</code>，先把 <code>1</code> 和 <code>3</code> 保存起来碰到 <code>+</code> 知道是加法则直接相加）</em></p>
<p>OK，我们从头开始使用汇编语言来编写一下程序，首先第一步：把 <code>1</code> 保存起来（放入寄存器）：</p>
<pre class=" language-arm"><code class="language-arm">MOV  1</code></pre>
<p>之后是 <code>4, +</code>，那就直接加一下：</p>
<pre class=" language-arm"><code class="language-arm">ADD 4</code></pre>
<p>然后是 <code>2, *</code>，那就直接乘一下（<code>SHL</code> 是向左移动一位的意思，二进制中左移一个单位就相当于乘以 <code>2</code>，例如 <code>01</code> 表示 <code>1</code>，而 <code>10</code> 则表示 <code>2</code>）：</p>
<pre class=" language-arm"><code class="language-arm">SHL 0</code></pre>
<p>最后是 <code>3, +</code>，再加一下：</p>
<pre class=" language-arm"><code class="language-arm">ADD 3</code></pre>
<p>完整程序如下：</p>
<pre class=" language-arm"><code class="language-arm">MOV  1
ADD  4
SHL  0
ADD  3</code></pre>
<p>这似乎看起来比 <code>00001111</code> 这样的二进制要好上太多了！程序员们感动到落泪：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-ec3b285844a06fcd.png" alt=""></p>
<h2 id="高级语言"><a href="#高级语言" class="headerlink" title="高级语言"></a>高级语言</h2><p>摆脱了 <strong>二进制</strong>，我们有了更可读的 <strong>汇编语言</strong>，但仍然十分繁琐和复杂，每一条汇编指令代表一个基本操作，例如：「从内存 x 位置获取一个数字并放入寄存器 A」、「将寄存器 A 中的数字添加到寄存器 B 的数字上」。<strong>这样的编程风格既费时又容易出错，并且一旦出错还很难发现。</strong></p>
<p>例如，我们来看一看 <strong>「1969 年阿波罗 11号登月计划」</strong> 用来 <strong>防止登月舱计算机耗尽自身资源</strong> 的 BAILOUT 代码：</p>
<pre class=" language-arm"><code class="language-arm">POODOO    INHINT
    CA  Q
    TS  ALMCADR

    TC  BANKCALL
    CADR  VAC5STOR  # STORE ERASABLES FOR DEBUGGING PURPOSES.

    INDEX  ALMCADR
    CAF  0
ABORT2    TC  BORTENT

OCT77770  OCT  77770    # DONT MOVE
    CA  V37FLBIT  # IS AVERAGE G ON
    MASK  FLAGWRD7
    CCS  A
    TC  WHIMPER -1  # YES.  DONT DO POODOO.  DO BAILOUT.

    TC  DOWNFLAG
    ADRES  STATEFLG

    TC  DOWNFLAG
    ADRES  REINTFLG

    TC  DOWNFLAG
    ADRES  NODOFLAG

    TC  BANKCALL
    CADR  MR.KLEAN
    TC  WHIMPER</code></pre>
<ul>
<li>出处：改变世界的代码行 - <a href="https://www.infoq.cn/article/5CaYH8NbS6BmptWKRgkX" target="_blank" rel="noopener">https://www.infoq.cn/article/5CaYH8NbS6BmptWKRgkX</a></li>
</ul>
<p>似乎不太容易读的样子…</p>
<blockquote>
<p>阿波罗登月计划的源代码在 Github 上已经公开，有兴趣的可以去下方链接膜拜一下（可以去感受一下当时程序员的工程能力）：</p>
<ul>
<li><a href="https://github.com/chrislgarry/Apollo-11" target="_blank" rel="noopener">https://github.com/chrislgarry/Apollo-11</a></li>
</ul>
<p>另外附一下当时代码的设计负责人 Margaret Heafield Hamilton（女程序员）和完成的堆起来跟人一样高的代码量：<br><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-476a8d4a96fc0745.png" alt=""></p>
</blockquote>
<h3 id="第一个高级语言：FORTRAN"><a href="#第一个高级语言：FORTRAN" class="headerlink" title="第一个高级语言：FORTRAN"></a>第一个高级语言：FORTRAN</h3><p>当 <strong>John Backus</strong> 在 <code>1950</code> 年以一名科学程序员的身份加入 IBM 时，已经可以使用诸如 <code>ADD</code> 之类的助记词代替数字代码来编写程序，也就是我们的汇编语言。这使编程变得容易一些，但是即使是一个简单的程序也需要数十次操作，并且仍然很难找到错误。</p>
<p>巴克斯认为，应该有可能创建一种编程语言，使一系列计算可以用类似于数学符号的形式来表达。然后，使用特定的翻译程序（以今天的术语来说是编译器）可以将其转换为计算机可以理解的数字代码。</p>
<p>Backus 在 <code>1953</code> 年向他的经理提出了这个想法。他得到了预算，并被鼓励雇用一个小团队来测试该想法的可行性。三年后，该团队发布了一本手册，其中描述了 IBM Mathematical Formula Translating System（简称 FORTRAN）。不久之后， IBM 向 IBM 704 的用户提供了第一个 FORTRAN 编译器。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-f0bde8f7347a6bd9.png" alt="FORTRAN 之父"></p>
<p>Backus 和他的团队创造了世界上第一种高级编程语言。<strong>科学家和工程师将不再需要将其程序编写为数字代码或冗长的助记符</strong>。</p>
<h4 id="FORTRAN-代码演示"><a href="#FORTRAN-代码演示" class="headerlink" title="FORTRAN 代码演示"></a>FORTRAN 代码演示</h4><p>下面演示计算并输出 <code>8 * 6</code> 的代码实例：</p>
<pre class=" language-fortran"><code class="language-fortran"><span class="token keyword">program</span> VF0944
<span class="token keyword">implicit none</span>

<span class="token keyword">integer</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c
a<span class="token operator">=</span> <span class="token number">8</span>
b<span class="token operator">=</span> <span class="token number">6</span>
c<span class="token operator">=</span> a<span class="token operator">*</span>b

<span class="token keyword">print</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token string">'Hello World, a, b, c= '</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c
<span class="token keyword">end program</span> VF0944</code></pre>
<p><em>对比汇编代码，是不是看上去要清晰（人类可读）多了呢？</em></p>
<h4 id="FORTRAN-的意义"><a href="#FORTRAN-的意义" class="headerlink" title="FORTRAN 的意义"></a>FORTRAN 的意义</h4><p>FORTRAN 的问世在计算机史上具有划时代的意义，它使计算机语言从原始的低级汇编语言走出来，进入了更高的境界，使得 <strong>计算机语言不再是计算机专家的专利</strong>，使广大的工程技术人员有了进行计算机编程的手段。</p>
<p>由此计算机更快地深入到了社会之中，它在工业部门中初露头角，更是在火箭、导弹、人造地球卫星的设计中大显身手，因此有人称 FORTRAN 语言使计算机的工业应用成了可能，是推动第二次世界大战以后西方工业经济复苏和进入第二次工业革命的无形力量，是 “看不见的蒸汽机”。</p>
<h2 id="一句话总结-2"><a href="#一句话总结-2" class="headerlink" title="一句话总结"></a>一句话总结</h2><p>计算机先驱们已经为我们架设好了计算机的世界，站在先驱巨人们的肩膀，我们如今很容易也可以看得更高和更远。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-2d73962556d7b782.png" alt=""></p>
<h1 id="Part-4-构建自己独有的程序-世界"><a href="#Part-4-构建自己独有的程序-世界" class="headerlink" title="Part 4. 构建自己独有的程序(世界)"></a>Part 4. 构建自己独有的程序(世界)</h1><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-904716eb2c4bca86.png" alt=""></p>
<ul>
<li>图片来源自：<a href="https://www.infoq.cn/article/5CaYH8NbS6BmptWKRgkX" target="_blank" rel="noopener">https://www.infoq.cn/article/5CaYH8NbS6BmptWKRgkX</a></li>
</ul>
<p><strong>编码的乐趣有很多，把自己的想法动手实践就是其中一个。</strong></p>
<p>例如网友玩儿游戏活动需要不停点鼠标，于是写了一个鼠标连点器：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-494dcf75586b4fdb.png" alt=""></p>
<p>例如给自己心爱的妹子写一个恋爱纪念网站：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-d3da6ce3fce36a4e.png" alt=""></p>
<p>例如给 FlappyBird 加一个强化学习算法让它自己学习如何飞行：<em>(图示已经能自己飞 <code>4527</code> 步了)</em></p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-35def72595919870.png" alt=""></p>
<p>例如网友自己写的文言文语言：<em>(使用文言文写代码)</em></p>
<pre class=" language-console"><code class="language-console">// HelloWorld 程序演示
吾有一數。曰三。名之曰「甲」。
為是「甲」遍。
    吾有一言。曰「「問天地好在。」」。書之。
云云。</code></pre>
<p>运行输出：</p>
<pre class=" language-console"><code class="language-console">問天地好在。
問天地好在。
問天地好在。</code></pre>
<h2 id="一句话总结-3"><a href="#一句话总结-3" class="headerlink" title="一句话总结"></a>一句话总结</h2><p>我们可以动手通过编程把我们的很多想法付诸于实现 <em>(前提是不断探索和学习)</em>，并在迎接挑战和最终实现的过程中获得无限的乐趣。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-3844b2e008eee442.png" alt=""></p>
<h1 id="小总结"><a href="#小总结" class="headerlink" title="小总结"></a>小总结</h1><p>总体而言，IT 是令人兴奋的。</p>
<p>素有「软件吞噬世界」的说法，我们也正生活在计算机当道的世界。</p>
<p>并且编程并不是每个人都具备的技能，借助技术，一切皆有可能，并且现在互联网时代比以往都更有机会学习和创建「自己的世界」。</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-d009cb2cb26cb34b.png" alt=""></p>
<blockquote>
<ul>
<li>本文已收录至我的 Github 程序员成长系列 <strong>【More Than Java】，学习，不止 Code，欢迎 star：<a href="https://github.com/wmyskxz/MoreThanJava" target="_blank" rel="noopener">https://github.com/wmyskxz/MoreThanJava</a></strong></li>
<li><strong>个人公众号</strong> ：wmyskxz，<strong>个人独立域名博客</strong>：wmyskxz.com，坚持原创输出，下方扫码关注，2020，与您共同成长！</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%90%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98%E3%80%91%E5%A6%82%E4%BD%95%E8%AE%A9%E4%B8%8D%E6%87%82%E7%BC%96%E7%A8%8B%E7%9A%84%E4%BA%BA%E6%84%9F%E5%8F%97%E5%88%B0%E7%BC%96%E7%A8%8B%E7%9A%84%E9%AD%85%E5%8A%9B/7896890-4e1699bcaca95e92.png" alt=""></p>
<p>非常感谢各位人才能 <strong>看到这里</strong>，如果觉得本篇文章写得不错，觉得 <strong>「我没有三颗心脏」有点东西</strong> 的话，<strong>求点赞，求关注，求分享，求留言！</strong></p>
<p>创作不易，各位的支持和认可，就是我创作的最大动力，我们下篇文章见！</p>

      
    </div>
    
      
    
  </section>
</article>

          </div>
        
      
        
          <div class='post-wrapper'>
            <article class="post white-box shadow reveal ">
  


  <section class='meta'>
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h2 class="title">
    <a href="/2020/07/05/morethanjava-day-3-gou-jian-cheng-xu-luo-ji-de-fang-fa/">
      「MoreThanJava」Day 3：构建程序逻辑的方法
    </a>
  </h2>


        
        <div class='new-meta-box'>
          
            
          
            
              
<div class='new-meta-item author'>
  <a class='author' href="" rel="nofollow">
    <img no-lazy src="">
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class='new-meta-item category'>
    <a href='/categories/MoreThanJava/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>MoreThanJava</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2020年7月5日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  


            
          
            
              

            
          
            
              

            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


  <section class="article typo">
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay-3%EF%BC%9A%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91%E7%9A%84%E6%96%B9%E6%B3%95/7896890-4d13da83e783850b.png" alt=""></p>
<ul>
<li><strong>「MoreThanJava」</strong> 宣扬的是 <strong>「学习，不止 CODE」</strong>，本系列 Java 基础教程是自己在结合各方面的知识之后，对 Java 基础的一个总回顾，旨在 <strong>「帮助新朋友快速高质量的学习」</strong>。</li>
<li>当然 <strong>不论新老朋友</strong> 我相信您都可以 <strong>从中获益</strong>。如果觉得 <strong>「不错」</strong> 的朋友，欢迎 <strong>「关注 + 留言 + 分享」</strong>，文末有完整的获取链接，您的支持是我前进的最大的动力！</li>
</ul>
<h1 id="Part-1-分支结构"><a href="#Part-1-分支结构" class="headerlink" title="Part 1. 分支结构"></a>Part 1. 分支结构</h1><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay-3%EF%BC%9A%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91%E7%9A%84%E6%96%B9%E6%B3%95/7896890-5d36374d88d6f29d.png" alt=""></p>
<ul>
<li>图片来源：<a href="http://www.jituwang.com/vector/201512/569157.html" target="_blank" rel="noopener">http://www.jituwang.com/vector/201512/569157.html</a></li>
</ul>
<p>迄今为止，我们写的 Java 代码都是一条一条语句顺序执行的，这种代码结构通常称之为 <strong>顺序结构</strong>。</p>
<p>然而仅有顺序结构并不能解决所有的问题，比如我们设计一个游戏，游戏第一关的通关条件是获得 <code>1000</code> 分，如果分数到达则进入下一关，如果未到达则 <code>“Game Over”</code>：</p>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay-3%EF%BC%9A%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91%E7%9A%84%E6%96%B9%E6%B3%95/7896890-28be7d34a817f1fe.png" alt=""></p>
<p>这里就产生了两个分支，而且这两个分支只有一个会被执行。类似的场景还有很多，我们将这种结构称之为 <strong>「分支结构」</strong> 或 <strong>「选择结构」</strong>。</p>
<p>「是否进入下一关」这样的决策似乎很小，但是在编程中，复杂的决策是由许多这种小的决策组成的。下面是实现是否进入下一关的程序演示：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Scanner<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Scanner scan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
        String answer<span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家是否达到 1000 分?(Y or N): "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        answer <span class="token operator">=</span> scan<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"Y"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"进入下一关"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// true branch</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Game Over"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// false branch</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>程序首先提醒用户用单一的字符 <code>Y</code> 或 <code>N</code> 来回答：</p>
<pre class=" language-java"><code class="language-java">System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"玩家是否达到 1000 分?(Y or N): "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>然后使用 <code>Scanner</code> 类来获取用户的输入：</p>
<pre class=" language-java"><code class="language-java">answer <span class="token operator">=</span> scan<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>然后使用 <code>if</code> 关键字来判断用户输入的字符是否等于 <code>Y</code>：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"Y"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>如果相等则进入 <code>true branch</code>，否则进入 <code>false branch</code>。</p>
<blockquote>
<p><strong>缩进：</strong></p>
<p>这里 <code>if</code> 下方的缩进是为了让用户更容易看到程序的逻辑，编译器将忽略掉这些缩进。</p>
<p>合理的缩进和程序布局很重要，没有适当的距离和缩进，看程序的逻辑有时会稍显困难。您也期望尽可能清晰地表明程序在做什么不是吗？</p>
</blockquote>
<h2 id="if-条件语句"><a href="#if-条件语句" class="headerlink" title="if 条件语句"></a>if 条件语句</h2><p>在 Java 中，要构造分支结构可以使用 <code>if</code>、<code>else</code> 关键字。</p>
<p><code>if</code> 语句的基本语法是：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>条件<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 条件满足时执行的语句</span>
<span class="token punctuation">}</span></code></pre>
<p>当条件满足时，则会执行 <code>if</code> 语句中的代码块儿，否则执行 <code>if</code> 语句块后面的代码。</p>
<p>例如：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">70</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"及格了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"END"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>尽管当 <code>if</code> 语句块只有一行语句时，可以省略花括号 <code>{}</code>：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">)</span>
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"及格了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>当这并不是一个好主意。</p>
<p>假设某个时候，突然想给 <code>if</code> 语句块增加一条语句时：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">)</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"及格了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"恭喜你"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 注意这条语句不是if语句块的一部分</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"END"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>由于使用缩进格式，很容易把两行语句都看成 <code>if</code> 语句的执行块，但实际上只有第一行语句是 <code>if</code> 的执行块。</p>
<p>在使用 <code>git</code> 这些版本控制系统自动合并时更容易出问题，所以不推荐忽略花括号的写法。<em>(事实上，你使用 IDEA 的自动排版代码的功能会帮你自动还原成有花括号的写法，快捷键「ctrl + alt + l」)</em></p>
<h2 id="else-语句"><a href="#else-语句" class="headerlink" title="else 语句"></a>else 语句</h2><p><code>if</code> 语句还可以编写一个 <code>else { ... }</code>，当条件判断为 <code>false</code> 时，将执行 <code>else</code> 的语句块：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">70</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"及格了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"挂科了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"END"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>修改上面代码的 <code>n</code> 值，观察 <code>if</code> 条件为 <code>true/ false</code> 时，程序执行的语句块。</p>
<p>注意，<code>else</code> 不是必须的。</p>
<p>还可以用多个 <code>if ... else if ...</code> 串联。例如：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">70</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"优秀"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"及格了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"挂科了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"END"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>串联的效果其实相当于：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// n >= 90为true:</span>
    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"优秀"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// n >= 90为false:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// n >= 60为true:</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"及格了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// n >= 60为false:</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"挂科了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="注意顺序和临界条件"><a href="#注意顺序和临界条件" class="headerlink" title="注意顺序和临界条件"></a>注意顺序和临界条件</h3><p>在串联使用多个 <code>if</code> 时，要特别注意判断顺序。观察下面的代码：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"及格了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"优秀"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"挂科了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>执行发现，<code>n = 100</code> 时，满足条件 <code>n &gt;= 90</code>，但输出的不是 <code>&quot;优秀&quot;</code>，而是 <code>&quot;及格了&quot;</code>，原因是 <code>if</code> 语句从上到下执行时，先判断 <code>n &gt;= 60</code> 成功后，后续 <code>else</code> 不再执行，因此，<code>if (n &gt;= 90)</code> 没有机会执行了。</p>
<p>正确的方式是按照判断范围从大到小依次判断：</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// 从大到小依次判断：</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// ...</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// ...</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// ...</span>
<span class="token punctuation">}</span></code></pre>
<p>或者改写成从小到大依次判断：</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// 从小到大依次判断：</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// ...</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// ...</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// ...</span>
<span class="token punctuation">}</span></code></pre>
<p>使用 <code>if</code> 时，还要特别注意边界条件。例如：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"优秀"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"及格了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"挂科了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>假设我们期望 <code>90</code> 分或更高为 <code>“优秀”</code>，上述代码输出的却是 <code>“及格”</code>，原因是 <code>&gt;</code> 和 <code>&gt;=</code> 效果是不同的。</p>
<h1 id="Part-2-循环结构"><a href="#Part-2-循环结构" class="headerlink" title="Part 2. 循环结构"></a>Part 2. 循环结构</h1><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay-3%EF%BC%9A%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91%E7%9A%84%E6%96%B9%E6%B3%95/7896890-1d3d6cc91283ad20.png" alt=""></p>
<ul>
<li>图片引用自：<a href="https://www.zlovezl.cn/articles/two-tips-on-loop-writing/" target="_blank" rel="noopener">https://www.zlovezl.cn/articles/two-tips-on-loop-writing/</a></li>
</ul>
<p>顺序结构的程序语句只能被执行一次。如果您想要同样的操作执行多次，就需要使用循环结构。</p>
<p>Java 中有三种主要的循环结构：</p>
<ul>
<li><code>while</code> 循环；</li>
<li><code>do...while</code> 循环；</li>
<li><code>for</code> 循环 <em>(在 Java 5 中还引入了一种主要用于数组的增强型 <code>for</code> 循环)</em>；</li>
</ul>
<h2 id="while-循环"><a href="#while-循环" class="headerlink" title="while 循环"></a>while 循环</h2><p><code>while</code> 是最基本的循环，它的结构为：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">while</span> <span class="token punctuation">(</span> 布尔表达式 <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 循环内容</span>
<span class="token punctuation">}</span></code></pre>
<p>只要布尔表达式为 <code>true</code>，循环就会一直执行下去。</p>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"value of x : "</span> <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            x<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>以上实例编译运行结果如下：</p>
<pre class=" language-console"><code class="language-console">value of x : 10
value of x : 11
value of x : 12
value of x : 13
value of x : 14
value of x : 15
value of x : 16
value of x : 17
value of x : 18
value of x : 19</code></pre>
<h2 id="do…while-循环"><a href="#do…while-循环" class="headerlink" title="do…while 循环"></a>do…while 循环</h2><p>对于 <code>while</code> 语句而言，如果不满足条件，则不能进入循环。但有时候我们需要即使不满足条件，也至少执行一次。</p>
<p><code>do…whil</code>e 循环和 <code>while</code> 循环相似，不同的是，<code>do…while</code> 循环至少会执行一次。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 代码语句</span>
<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>布尔表达式<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><strong>注意</strong>：布尔表达式在循环体的后面，所以语句块在检测布尔表达式之前已经执行了。 如果布尔表达式的值为 <code>true</code>，则语句块一直执行，直到布尔表达式的值为 <code>false</code>。</p>
<h3 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

        <span class="token keyword">do</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"value of x : "</span> <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            x<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>以上实例编译运行结果如下：</p>
<pre class=" language-console"><code class="language-console">value of x : 10
value of x : 11
value of x : 12
value of x : 13
value of x : 14
value of x : 15
value of x : 16
value of x : 17
value of x : 18
value of x : 19</code></pre>
<h2 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h2><p>虽然所有循环结构都可以用 <code>while</code> 或者 <code>do...while</code> 表示，但 Java 提供了另一种语句 —— <code>for</code> 循环，使一些循环结构变得更加简单。</p>
<p><code>for</code> 循环执行的次数是在执行前就确定的。语法格式如下：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">for</span><span class="token punctuation">(</span>初始化<span class="token punctuation">;</span> 布尔表达式<span class="token punctuation">;</span> 更新<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 代码语句</span>
<span class="token punctuation">}</span></code></pre>
<p>关于 <code>for</code> 循环有以下几点说明：</p>
<ul>
<li>最先执行初始化步骤。可以声明一种类型，但可初始化一个或多个循环控制变量，也可以是空语句。</li>
<li>然后，检测布尔表达式的值。如果为 true，循环体被执行。如果为false，循环终止，开始执行循环体后面的语句。</li>
<li>执行一次循环后，更新循环控制变量。</li>
<li>再次检测布尔表达式。循环执行上面的过程。</li>
</ul>
<h3 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span> x <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"value of x : "</span> <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>以上实例编译运行结果如下：</p>
<pre class=" language-console"><code class="language-console">value of x : 10
value of x : 11
value of x : 12
value of x : 13
value of x : 14
value of x : 15
value of x : 16
value of x : 17
value of x : 18
value of x : 19</code></pre>
<blockquote>
<p>您可以再 IDEA 中快速输入 <code>fori</code> 关键字来快速创建 <code>for</code> 循环的基本结构</p>
</blockquote>
<h2 id="控制循环"><a href="#控制循环" class="headerlink" title="控制循环"></a>控制循环</h2><h3 id="break-关键字"><a href="#break-关键字" class="headerlink" title="break 关键字"></a>break 关键字</h3><p><code>break</code> 主要用在循环语句或者 <code>switch</code> 语句中，用来跳出整个语句块。</p>
<p><code>break</code> 跳出最里层的循环，并且继续执行该循环下面的语句。</p>
<h4 id="实例-3"><a href="#实例-3" class="headerlink" title="实例"></a>实例</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">:</span> numbers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// x 等于 30 时跳出循环</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>以上实例编译运行结果如下：</p>
<pre class=" language-console"><code class="language-console">10
20</code></pre>
<h3 id="continue-关键字"><a href="#continue-关键字" class="headerlink" title="continue 关键字"></a>continue 关键字</h3><p><code>continue</code> 适用于任何循环控制结构中。作用是让程序立刻跳转到下一次循环的迭代。</p>
<p>在 <code>for</code> 循环中，<code>continue</code> 语句使程序立即跳转到更新语句。</p>
<p>在 <code>while</code> 或者 <code>do…while</code> 循环中，程序立即跳转到布尔表达式的判断语句。</p>
<h4 id="实例-4"><a href="#实例-4" class="headerlink" title="实例"></a>实例</h4><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> numbers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">:</span> numbers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>以上实例编译运行结果如下：</p>
<pre class=" language-console"><code class="language-console">10
20
40
50</code></pre>
<h1 id="Part-3-构造程序逻辑"><a href="#Part-3-构造程序逻辑" class="headerlink" title="Part 3. 构造程序逻辑"></a>Part 3. 构造程序逻辑</h1><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay-3%EF%BC%9A%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91%E7%9A%84%E6%96%B9%E6%B3%95/7896890-701dc11e59bb080c.png" alt=""></p>
<ul>
<li>图片来源：<a href="http://www.mzh.ren/machine-learning-3.html" target="_blank" rel="noopener">http://www.mzh.ren/machine-learning-3.html</a></li>
</ul>
<p>虽然迄今为止我们学习的内容只是 Java 的冰山一角，但是这些内容已经足够我们来构建程序中的逻辑。</p>
<p>对于编程语言的初学者来说，在学习了 Java 的核心语言元素 <em>（变量、类型、运算符、表达式、分支结构、循环结构等）</em> 之后，必须做的一件事情就是尝试用所学知识去解决现实中的问题，换句话说就是锻炼自己把用人类自然语言描述的算法 <em>（解决问题的方法和步骤）</em> 翻译成 Java 代码的能力，而这件事情必须通过大量的练习才能达成。</p>
<p>我们在这一 Part 为大家整理了一些经典的案例和习题，希望通过这些例子，一方面帮助大家巩固之前所学的 Java 知识，另一方面帮助大家了解如何建立程序中的逻辑以及如何运用一些简单的算法解决现实中的问题。</p>
<h2 id="经典的例子"><a href="#经典的例子" class="headerlink" title="经典的例子"></a>经典的例子</h2><h3 id="题目一：寻找水仙花数"><a href="#题目一：寻找水仙花数" class="headerlink" title="题目一：寻找水仙花数"></a>题目一：寻找水仙花数</h3><blockquote>
<p><strong>说明</strong>：水仙花数也被称为超完全数字不变数、自恋数、自幂数、阿姆斯特朗数，它是一个 <code>3</code> 位数，该数字每个位上数字的立方之和正好等于它本身，<em>例如：1<sup>3</sup> + 5<sup>3</sup>+ 3<sup>3</sup>=153</em>。</p>
</blockquote>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">findAllDaffodilNumberAndPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * 查找所有的水仙花数并打印
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">findAllDaffodilNumberAndPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> num <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> num<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> low <span class="token operator">=</span> num <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> mid <span class="token operator">=</span> num <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> high <span class="token operator">=</span> num <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// Math.pow(x, 3) 相当于求 x 的 3 次方</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">==</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>low<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>mid<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>high<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="题目二：百钱百鸡问题"><a href="#题目二：百钱百鸡问题" class="headerlink" title="题目二：百钱百鸡问题"></a>题目二：百钱百鸡问题</h3><blockquote>
<p><strong>说明</strong>：百钱百鸡是我国古代数学家张丘建在《算经》一书中提出的数学问题：鸡翁一值钱五，鸡母一值钱三，鸡雏三值钱一。百钱买百鸡，问鸡翁、鸡母、鸡雏各几何？翻译成现代文是：公鸡 <code>5</code> 元一只，母鸡 <code>3</code> 元一只，小鸡 <code>1</code> 元三只，用 <code>100</code> 块钱买一百只鸡，问公鸡、母鸡、小鸡各有多少只？</p>
</blockquote>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">getResultAndPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * 获取百钱百鸡的结果并输出
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getResultAndPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> cockNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> cockNum <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span> cockNum<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> henNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> henNum <span class="token operator">&lt;</span> <span class="token number">33</span><span class="token punctuation">;</span> henNum<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> chickNum <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">-</span> cockNum <span class="token operator">-</span> henNum<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> cockNum <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> henNum <span class="token operator">+</span> chickNum <span class="token operator">/</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    System<span class="token punctuation">.</span>out
                        <span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"公鸡："</span> <span class="token operator">+</span> cockNum <span class="token operator">+</span> <span class="token string">"只, 母鸡："</span> <span class="token operator">+</span> henNum <span class="token operator">+</span> <span class="token string">"只, 小鸡："</span> <span class="token operator">+</span> chickNum <span class="token operator">+</span> <span class="token string">"只"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>上面使用的方法叫做 <strong>穷举法</strong>，也称为 <strong>暴力搜索法</strong>，这种方法通过一项一项的列举备选解决方案中所有可能的候选项并检查每个候选项是否符合问题的描述，最终得到问题的解。</p>
<p>这种方法看起来比较笨拙，但对于运算能力非常强大的计算机来说，通常都是一个可行的甚至是不错的选择，而且问题的解如果存在，这种方法一定能够找到它。</p>
<h1 id="要点回顾"><a href="#要点回顾" class="headerlink" title="要点回顾"></a>要点回顾</h1><ol>
<li>分支结构 <code>if</code> 和 <code>else</code> 的使用和实例；</li>
<li>循环结构 <code>while</code>、<code>do...while</code> 和 <code>for</code> 循环的使用和实例；</li>
<li>控制循环的 <code>break</code> 和 <code>continue</code> 实例；</li>
<li>构建程序逻辑的练习；</li>
</ol>
<h1 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h1><h2 id="练习-1：百分之成绩转换成等级制成绩"><a href="#练习-1：百分之成绩转换成等级制成绩" class="headerlink" title="练习 1：百分之成绩转换成等级制成绩"></a>练习 1：百分之成绩转换成等级制成绩</h2><blockquote>
<p><strong>要求：</strong></p>
<ol>
<li>如果输入成绩在 <code>90</code> 分以上 <em>(含 <code>90</code> 分)</em> 输出 <code>A</code>；</li>
<li><code>80 ~ 90</code> 分 <em>(不含 <code>90</code>)</em> 输出 <code>B</code>；</li>
<li><code>70 ~ 80</code> 分 <em>(不含 <code>80</code>)</em> 输出 <code>C</code>；</li>
<li><code>60 ~ 70</code> 分 <em>(不含 <code>70</code>)</em> 输出 <code>D</code>；</li>
<li><code>60</code> 分以下输出 <code>E</code>；</li>
</ol>
</blockquote>
<p>参考答案：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Scanner<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Scanner scan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> score <span class="token operator">=</span> scan<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">>=</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">>=</span> <span class="token number">80</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">>=</span> <span class="token number">70</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>score <span class="token operator">>=</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"E"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="练习-2：输入三条边长，如果能构成三角形就计算周长和面积"><a href="#练习-2：输入三条边长，如果能构成三角形就计算周长和面积" class="headerlink" title="练习 2：输入三条边长，如果能构成三角形就计算周长和面积"></a>练习 2：输入三条边长，如果能构成三角形就计算周长和面积</h2><p>参考答案：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Scanner<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Scanner scan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">double</span> a <span class="token operator">=</span> scan<span class="token punctuation">.</span><span class="token function">nextDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">double</span> b <span class="token operator">=</span> scan<span class="token punctuation">.</span><span class="token function">nextDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">double</span> c <span class="token operator">=</span> scan<span class="token punctuation">.</span><span class="token function">nextDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> b <span class="token operator">></span> c <span class="token operator">&amp;&amp;</span> a <span class="token operator">+</span> c <span class="token operator">></span> b <span class="token operator">&amp;&amp;</span> b <span class="token operator">+</span> c <span class="token operator">></span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">double</span> perimeter <span class="token operator">=</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c<span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"三角形周长为："</span> <span class="token operator">+</span> perimeter<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">double</span> p <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> b <span class="token operator">+</span> c<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">double</span> area <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>p <span class="token operator">*</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> a<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"三角形面积为："</span> <span class="token operator">+</span> area<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"不能构成三角形！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="练习-3：打印如下所示的三角形图案"><a href="#练习-3：打印如下所示的三角形图案" class="headerlink" title="练习 3：打印如下所示的三角形图案"></a>练习 3：打印如下所示的三角形图案</h2><pre class=" language-console"><code class="language-console">*
**
***
****
*****</code></pre>
<pre class=" language-console"><code class="language-console">    *
   **
  ***
 ****
*****</code></pre>
<pre class=" language-console"><code class="language-console">    *
   ***
  *****
 *******
*********</code></pre>
<p>参考答案：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Scanner<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Tester</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入行数："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Scanner scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> row <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> row <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// 换行</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">&lt;</span> row <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// 换行</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> row <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// 换行</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h1 id="自取资料"><a href="#自取资料" class="headerlink" title="自取资料"></a>自取资料</h1><h2 id="优秀入门资料选取"><a href="#优秀入门资料选取" class="headerlink" title="优秀入门资料选取"></a>优秀入门资料选取</h2><ol>
<li>Introduction to Computer Science using Java - <a href="http://programmedlessons.org/Java9/index.html" target="_blank" rel="noopener">http://programmedlessons.org/Java9/index.html</a></li>
<li>Java零基础入门教程包含面向对象 - <a href="https://study.163.com/course/courseMain.htm?courseId=1003108028" target="_blank" rel="noopener">https://study.163.com/course/courseMain.htm?courseId=1003108028</a></li>
<li>网易云课堂 - 顶尖中文大学计算机专业课程体系 - <a href="https://study.163.com/curricula/cs.htm" target="_blank" rel="noopener">https://study.163.com/curricula/cs.htm</a></li>
<li>TeachYourselfCS-CN (自学计算机科学) - <a href="https://github.com/keithnull/TeachYourselfCS-CN" target="_blank" rel="noopener">https://github.com/keithnull/TeachYourselfCS-CN</a></li>
<li>C语言中文网 Java 入门系列教程 - <a href="http://c.biancheng.net/java/10/" target="_blank" rel="noopener">http://c.biancheng.net/java/10/</a></li>
<li>廖雪峰 Java 教程 - <a href="https://www.liaoxuefeng.com/wiki/1252599548343744" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/1252599548343744</a></li>
<li>注重动手能力的 Java 教程 - <a href="https://how2j.cn/" target="_blank" rel="noopener">https://how2j.cn/</a></li>
</ol>
<h2 id="推荐书籍"><a href="#推荐书籍" class="headerlink" title="推荐书籍"></a>推荐书籍</h2><h4 id="Java-核心技术·卷-I-原书第-11-版"><a href="#Java-核心技术·卷-I-原书第-11-版" class="headerlink" title="Java 核心技术·卷 I(原书第 11 版)"></a>Java 核心技术·卷 I(原书第 11 版)</h4><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay-3%EF%BC%9A%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91%E7%9A%84%E6%96%B9%E6%B3%95/7896890-1ca8ce2c5c200d54.png" alt=""></p>
<p><strong>推荐理由：</strong> 这本书在知识体系完整充实的同时，又比《Thinking in Java》暴风式的知识洗礼来得轻松，新人入门书籍强烈推荐！</p>
<h4 id="码出高效：Java开发手册"><a href="#码出高效：Java开发手册" class="headerlink" title="码出高效：Java开发手册"></a>码出高效：Java开发手册</h4><p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay-3%EF%BC%9A%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91%E7%9A%84%E6%96%B9%E6%B3%95/7896890-965747c9e0a10343.png" alt=""></p>
<p><strong>推荐理由：</strong> 阿里系出品。从最基础的计算机基础入手，到 Java 的方方面面，加上精美的配图和通俗易懂的解释，是非常适合新手阅读的一本儿关于 Java 的技术书籍。</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol>
<li>《Java 核心技术 卷I》(第11版)</li>
<li>Introduction to Computer Science using Java - <a href="http://programmedlessons.org/Java9/index.html#part02" target="_blank" rel="noopener">http://programmedlessons.org/Java9/index.html#part02</a></li>
<li>菜鸟教程 - <a href="https://www.runoob.com/java/" target="_blank" rel="noopener">https://www.runoob.com/java/</a></li>
<li>C语言中文网 Java 入门系列教程 - <a href="http://c.biancheng.net/java/10/" target="_blank" rel="noopener">http://c.biancheng.net/java/10/</a></li>
<li>Python 100 天从新手到大师 - <a href="https://github.com/jackfrued/Python-100-Days" target="_blank" rel="noopener">https://github.com/jackfrued/Python-100-Days</a></li>
</ol>
<blockquote>
<ul>
<li>本文已收录至我的 Github 程序员成长系列 <strong>【More Than Java】，学习，不止 Code，欢迎 star：<a href="https://github.com/wmyskxz/MoreThanJava" target="_blank" rel="noopener">https://github.com/wmyskxz/MoreThanJava</a></strong></li>
<li><strong>个人公众号</strong> ：wmyskxz，<strong>个人独立域名博客</strong>：wmyskxz.com，坚持原创输出，下方扫码关注，2020，与您共同成长！</li>
</ul>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/wmyskxz/img/img/%E3%80%8CMoreThanJava%E3%80%8DDay-3%EF%BC%9A%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91%E7%9A%84%E6%96%B9%E6%B3%95/7896890-cc0c249ed5158de1.png" alt=""></p>
<p>非常感谢各位人才能 <strong>看到这里</strong>，如果觉得本篇文章写得不错，觉得 <strong>「我没有三颗心脏」有点东西</strong> 的话，<strong>求点赞，求关注，求分享，求留言！</strong></p>
<p>创作不易，各位的支持和认可，就是我创作的最大动力，我们下篇文章见！</p>

      
    </div>
    
      
    
  </section>
</article>

          </div>
        
      
    
  </section>
  
    
      <br>
      <div class="prev-next">
        
        <p class="current">
          1 / 3
        </p>
        
          <a class="next" rel="next" href="/tags/MoreThanJava/page/2/">
            <section class="post next white-box shadow">
              &nbsp;下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i>
            </section>
          </a>
        
      </div>
    
    <!-- 根据主题中的设置决定是否在archive中针对摘要部分的MathJax公式加载mathjax.js文件 -->
    
    

  


    
  
</div>
<aside class='l_side'>
  
  
    
    

<section class="widget blogger shadow desktop mobile">
  <div class='content'>
    
      
        <a class='avatar flat-box rectangle' href='/about/'>
          <img no-lazy src='https://cdn.jsdelivr.net/gh/wmyskxz/img/img/common/avatar.png'/>
        </a>
      
    
    
      <div class='text'>
        
        
          <p>想做一个自由且自律的人，靠势必实现的决心认真地或者</p>

        
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="/atom.xml"
              class="social fas fa-rss flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="mailto:me@xxx.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://github.com/volantis-x/"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=260045301"
              class="social fas fa-headphones-alt flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

  

  
    
    
  

  <section class="widget category shadow desktop">
    
  <header>
    
      <a href='/blog/categories/'><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i><span class='name'>文章分类</span></a>
    
  </header>


    <div class='content'>
      <ul class="entry navigation">
        
          <li><a class="flat-box"
            title="/categories/Java-Web/" href="/categories/Java-Web/"
            id="categoriesJava-Web"
            ><div class='name'>Java Web</div><div class='badge'>(6)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Java-Web/Spring/" href="/categories/Java-Web/Spring/"
            id="categoriesJava-WebSpring"
            ><div class='name'>Spring</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Java-Web/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" href="/categories/Java-Web/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
            id="categoriesJava-WebE5ADA6E4B9A0E7AC94E8AEB0"
            ><div class='name'>学习笔记</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/"
            id="categoriesJavaWebE59FBAE7A180"
            ><div class='name'>JavaWeb基础</div><div class='badge'>(23)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SSM/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SSM/"
            id="categoriesJavaWebE59FBAE7A180SSM"
            ><div class='name'>SSM</div><div class='badge'>(5)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SSM/%E9%A1%B9%E7%9B%AE/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SSM/%E9%A1%B9%E7%9B%AE/"
            id="categoriesJavaWebE59FBAE7A180SSME9A1B9E79BAE"
            ><div class='name'>项目</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/Spring-MVC/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/Spring-MVC/"
            id="categoriesJavaWebE59FBAE7A180Spring-MVC"
            ><div class='name'>Spring MVC</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/Spring/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/Spring/"
            id="categoriesJavaWebE59FBAE7A180Spring"
            ><div class='name'>Spring</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SpringBoot/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/SpringBoot/"
            id="categoriesJavaWebE59FBAE7A180SpringBoot"
            ><div class='name'>SpringBoot</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E5%9F%BA%E7%A1%80/%E9%A1%B9%E7%9B%AE/" href="/categories/JavaWeb%E5%9F%BA%E7%A1%80/%E9%A1%B9%E7%9B%AE/"
            id="categoriesJavaWebE59FBAE7A180E9A1B9E79BAE"
            ><div class='name'>项目</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/"
            id="categoriesJavaWebE8BF9BE998B6"
            ><div class='name'>JavaWeb进阶</div><div class='badge'>(14)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/Spring-Boot/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/Spring-Boot/"
            id="categoriesJavaWebE8BF9BE998B6Spring-Boot"
            ><div class='name'>Spring Boot</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/Spring-Boot/%E9%A1%B9%E7%9B%AE/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/Spring-Boot/%E9%A1%B9%E7%9B%AE/"
            id="categoriesJavaWebE8BF9BE998B6Spring-BootE9A1B9E79BAE"
            ><div class='name'>项目</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E4%B8%AD%E9%97%B4%E4%BB%B6/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E4%B8%AD%E9%97%B4%E4%BB%B6/"
            id="categoriesJavaWebE8BF9BE998B6E4B8ADE997B4E4BBB6"
            ><div class='name'>中间件</div><div class='badge'>(5)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF/"
            id="categoriesJavaWebE8BF9BE998B6E5898DE7ABAF"
            ><div class='name'>前端</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF/Spring-Boot/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%89%8D%E7%AB%AF/Spring-Boot/"
            id="categoriesJavaWebE8BF9BE998B6E5898DE7ABAFSpring-Boot"
            ><div class='name'>Spring Boot</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"
            id="categoriesJavaWebE8BF9BE998B6E5BEAEE69C8DE58AA1"
            ><div class='name'>微服务</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF/"
            id="categoriesJavaWebE8BF9BE998B6E69EB6E69E84E4B98BE8B7AF"
            ><div class='name'>架构之路</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E9%A1%B9%E7%9B%AE/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E9%A1%B9%E7%9B%AE/"
            id="categoriesJavaWebE8BF9BE998B6E9A1B9E79BAE"
            ><div class='name'>项目</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E9%A1%B9%E7%9B%AE/Spring-Boot/" href="/categories/JavaWeb%E8%BF%9B%E9%98%B6/%E9%A1%B9%E7%9B%AE/Spring-Boot/"
            id="categoriesJavaWebE8BF9BE998B6E9A1B9E79BAESpring-Boot"
            ><div class='name'>Spring Boot</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/Java%E5%9F%BA%E7%A1%80/" href="/categories/Java%E5%9F%BA%E7%A1%80/"
            id="categoriesJavaE59FBAE7A180"
            ><div class='name'>Java基础</div><div class='badge'>(15)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Java%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" href="/categories/Java%E5%9F%BA%E7%A1%80/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"
            id="categoriesJavaE59FBAE7A180E5B9B6E58F91E7BC96E7A88B"
            ><div class='name'>并发编程</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Java%E5%9F%BA%E7%A1%80/%E9%9D%A2%E8%AF%95/" href="/categories/Java%E5%9F%BA%E7%A1%80/%E9%9D%A2%E8%AF%95/"
            id="categoriesJavaE59FBAE7A180E99DA2E8AF95"
            ><div class='name'>面试</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/MoreThanJava/" href="/categories/MoreThanJava/"
            id="categoriesMoreThanJava"
            ><div class='name'>MoreThanJava</div><div class='badge'>(14)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/MoreThanJava/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" href="/categories/MoreThanJava/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"
            id="categoriesMoreThanJavaE5A49AE7BABFE7A88B"
            ><div class='name'>多线程</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/MoreThanJava/%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98/" href="/categories/MoreThanJava/%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98/"
            id="categoriesMoreThanJavaE79FA5E4B98EE997AEE9A298"
            ><div class='name'>知乎问题</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/Python/" href="/categories/Python/"
            id="categoriesPython"
            ><div class='name'>Python</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Python/%E6%87%82%E4%B8%80%E7%82%B9%E7%B3%BB%E5%88%97/" href="/categories/Python/%E6%87%82%E4%B8%80%E7%82%B9%E7%B3%BB%E5%88%97/"
            id="categoriesPythonE68782E4B880E782B9E7B3BBE58897"
            ><div class='name'>懂一点系列</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/Redis/" href="/categories/Redis/"
            id="categoriesRedis"
            ><div class='name'>Redis</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/Redis/%E4%B8%AD%E9%97%B4%E4%BB%B6/" href="/categories/Redis/%E4%B8%AD%E9%97%B4%E4%BB%B6/"
            id="categoriesRedisE4B8ADE997B4E4BBB6"
            ><div class='name'>中间件</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/Ruby/" href="/categories/Ruby/"
            id="categoriesRuby"
            ><div class='name'>Ruby</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/Spring-Cloud/" href="/categories/Spring-Cloud/"
            id="categoriesSpring-Cloud"
            ><div class='name'>Spring Cloud</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"
            id="categoriesE4B8ADE997B4E4BBB6"
            ><div class='name'>中间件</div><div class='badge'>(7)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/JavaWeb%E8%BF%9B%E9%98%B6/" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/JavaWeb%E8%BF%9B%E9%98%B6/"
            id="categoriesE4B8ADE997B4E4BBB6JavaWebE8BF9BE998B6"
            ><div class='name'>JavaWeb进阶</div><div class='badge'>(7)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%85%AC%E4%BC%97%E5%8F%B7%EF%BC%9Awmyskxz/" href="/categories/%E5%85%AC%E4%BC%97%E5%8F%B7%EF%BC%9Awmyskxz/"
            id="categoriesE585ACE4BC97E58FB7EFBC9Awmyskxz"
            ><div class='name'>公众号：wmyskxz</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%89%8D%E7%AB%AF/" href="/categories/%E5%89%8D%E7%AB%AF/"
            id="categoriesE5898DE7ABAF"
            ><div class='name'>前端</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E5%89%8D%E7%AB%AF/%E6%87%82%E4%B8%80%E7%82%B9%E7%B3%BB%E5%88%97/" href="/categories/%E5%89%8D%E7%AB%AF/%E6%87%82%E4%B8%80%E7%82%B9%E7%B3%BB%E5%88%97/"
            id="categoriesE5898DE7ABAFE68782E4B880E782B9E7B3BBE58897"
            ><div class='name'>懂一点系列</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%96%9C%E6%AC%A2%E7%9A%84%E4%B8%89%E8%A7%82/" href="/categories/%E5%96%9C%E6%AC%A2%E7%9A%84%E4%B8%89%E8%A7%82/"
            id="categoriesE5969CE6ACA2E79A84E4B889E8A782"
            ><div class='name'>喜欢的三观</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" href="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"
            id="categoriesE5A49AE7BABFE7A88B"
            ><div class='name'>多线程</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%A5%BD%E5%A5%87%E6%98%9F%E4%BA%BA/" href="/categories/%E5%A5%BD%E5%A5%87%E6%98%9F%E4%BA%BA/"
            id="categoriesE5A5BDE5A587E6989FE4BABA"
            ><div class='name'>好奇星人</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"
            id="categoriesE5ADA6E4B9A0E7AC94E8AEB0"
            ><div class='name'>学习笔记</div><div class='badge'>(6)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Java%E8%BF%9B%E9%98%B6/" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Java%E8%BF%9B%E9%98%B6/"
            id="categoriesE5ADA6E4B9A0E7AC94E8AEB0JavaE8BF9BE998B6"
            ><div class='name'>Java进阶</div><div class='badge'>(3)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"
            id="categoriesE695B0E68DAEE7BB93E69E84E4B88EE7AE97E6B395"
            ><div class='name'>数据结构与算法</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E9%9D%A2%E8%AF%95/" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E9%9D%A2%E8%AF%95/"
            id="categoriesE695B0E68DAEE7BB93E69E84E4B88EE7AE97E6B395E99DA2E8AF95"
            ><div class='name'>面试</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E6%9C%89%E8%B6%A3%E9%9B%86%E4%B8%AD%E8%90%A5/" href="/categories/%E6%9C%89%E8%B6%A3%E9%9B%86%E4%B8%AD%E8%90%A5/"
            id="categoriesE69C89E8B6A3E99B86E4B8ADE890A5"
            ><div class='name'>有趣集中营</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF/" href="/categories/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF/"
            id="categoriesE69EB6E69E84E4B98BE8B7AF"
            ><div class='name'>架构之路</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E7%94%9F%E6%B4%BB/" href="/categories/%E7%94%9F%E6%B4%BB/"
            id="categoriesE7949FE6B4BB"
            ><div class='name'>生活</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E7%BC%96%E7%A8%8B%E4%BA%BA%E7%94%9F/" href="/categories/%E7%BC%96%E7%A8%8B%E4%BA%BA%E7%94%9F/"
            id="categoriesE7BC96E7A88BE4BABAE7949F"
            ><div class='name'>编程人生</div><div class='badge'>(5)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E7%BC%96%E7%A8%8B%E4%BA%BA%E7%94%9F/%E9%9D%A2%E8%AF%95/" href="/categories/%E7%BC%96%E7%A8%8B%E4%BA%BA%E7%94%9F/%E9%9D%A2%E8%AF%95/"
            id="categoriesE7BC96E7A88BE4BABAE7949FE99DA2E8AF95"
            ><div class='name'>面试</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box"
            title="/categories/%E9%9D%A2%E8%AF%95/" href="/categories/%E9%9D%A2%E8%AF%95/"
            id="categoriesE99DA2E8AF95"
            ><div class='name'>面试</div><div class='badge'>(8)</div></a></li>
        
          <li><a class="flat-box child"
            title="/categories/%E9%9D%A2%E8%AF%95/%E4%B8%AD%E9%97%B4%E4%BB%B6/" href="/categories/%E9%9D%A2%E8%AF%95/%E4%B8%AD%E9%97%B4%E4%BB%B6/"
            id="categoriesE99DA2E8AF95E4B8ADE997B4E4BBB6"
            ><div class='name'>中间件</div><div class='badge'>(1)</div></a></li>
        
      </ul>
    </div>
  </section>


  

  
    
    
  

  <section class="widget tagcloud shadow desktop mobile">
    
  <header>
    
      <a href='/blog/tags/'><i class="fas fa-tags fa-fw" aria-hidden="true"></i><span class='name'>热门标签</span></a>
    
  </header>


    <div class='content'>
      <a href="/tags/Docker/" style="font-size: 14px; color: #999">Docker</a> <a href="/tags/Elasticsearch/" style="font-size: 14px; color: #999">Elasticsearch</a> <a href="/tags/Java-Web/" style="font-size: 16.86px; color: #868686">Java Web</a> <a href="/tags/Java8/" style="font-size: 14px; color: #999">Java8</a> <a href="/tags/JavaWeb%E5%9F%BA%E7%A1%80/" style="font-size: 23.29px; color: #5a5a5a">JavaWeb基础</a> <a href="/tags/JavaWeb%E8%BF%9B%E9%98%B6/" style="font-size: 22.57px; color: #5f5f5f">JavaWeb进阶</a> <a href="/tags/Java%E5%9F%BA%E7%A1%80/" style="font-size: 21.86px; color: #646464">Java基础</a> <a href="/tags/Kafka/" style="font-size: 14px; color: #999">Kafka</a> <a href="/tags/MongoDB/" style="font-size: 14px; color: #999">MongoDB</a> <a href="/tags/MoreThanJava/" style="font-size: 20.43px; color: #6d6d6d">MoreThanJava</a> <a href="/tags/MyBatis/" style="font-size: 15.43px; color: #8f8f8f">MyBatis</a> <a href="/tags/Python/" style="font-size: 14px; color: #999">Python</a> <a href="/tags/React/" style="font-size: 14px; color: #999">React</a> <a href="/tags/Redis/" style="font-size: 19.71px; color: #727272">Redis</a> <a href="/tags/Ruby/" style="font-size: 14.71px; color: #949494">Ruby</a> <a href="/tags/SSM/" style="font-size: 16.86px; color: #868686">SSM</a> <a href="/tags/Shiro/" style="font-size: 14px; color: #999">Shiro</a> <a href="/tags/Spring/" style="font-size: 17.57px; color: #818181">Spring</a> <a href="/tags/Spring-Boot/" style="font-size: 17.57px; color: #818181">Spring Boot</a> <a href="/tags/Spring-Cloud/" style="font-size: 14px; color: #999">Spring Cloud</a> <a href="/tags/Spring-MVC/" style="font-size: 14px; color: #999">Spring MVC</a> <a href="/tags/Vue/" style="font-size: 14px; color: #999">Vue</a> <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" style="font-size: 21.14px; color: #686868">中间件</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/" style="font-size: 14.71px; color: #949494">代码规范</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 15.43px; color: #8f8f8f">前端</a> <a href="/tags/%E5%8E%9F%E5%88%9B/" style="font-size: 24px; color: #555">原创</a> <a href="/tags/%E5%96%9C%E6%AC%A2%E7%9A%84%E4%B8%89%E8%A7%82/" style="font-size: 16.14px; color: #8a8a8a">喜欢的三观</a> <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 14.71px; color: #949494">多线程</a> <a href="/tags/%E5%A5%BD%E5%A5%87%E6%98%9F%E4%BA%BA/" style="font-size: 15.43px; color: #8f8f8f">好奇星人</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 17.57px; color: #818181">学习笔记</a> <a href="/tags/%E5%AF%BC%E8%88%AA/" style="font-size: 14px; color: #999">导航</a> <a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size: 14.71px; color: #949494">并发编程</a> <a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 14px; color: #999">微服务</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 18.29px; color: #7c7c7c">总结</a> <a href="/tags/%E6%87%82%E4%B8%80%E7%82%B9%E7%B3%BB%E5%88%97/" style="font-size: 14.71px; color: #949494">懂一点系列</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" style="font-size: 16.14px; color: #8a8a8a">数据结构与算法</a> <a href="/tags/%E6%9C%89%E8%B6%A3%E9%9B%86%E4%B8%AD%E8%90%A5/" style="font-size: 14px; color: #999">有趣集中营</a> <a href="/tags/%E6%9E%B6%E6%9E%84%E4%B9%8B%E8%B7%AF/" style="font-size: 14px; color: #999">架构之路</a> <a href="/tags/%E7%9F%A5%E4%B9%8E%E9%97%AE%E9%A2%98/" style="font-size: 14px; color: #999">知乎问题</a> <a href="/tags/%E7%BC%96%E7%A8%8B%E4%BA%BA%E7%94%9F/" style="font-size: 16.86px; color: #868686">编程人生</a> <a href="/tags/%E7%BF%BB%E8%AF%91/" style="font-size: 14px; color: #999">翻译</a> <a href="/tags/%E7%BF%BB%E8%AF%91%E6%96%87/" style="font-size: 14px; color: #999">翻译文</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 21.14px; color: #686868">面试</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 19px; color: #777">项目</a> <a href="/tags/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/" style="font-size: 14px; color: #999">领域驱动设计</a>
    </div>
  </section>


  

  


</aside>


    </div>
    
  
  <footer class="clearfix">
    <br><br>
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/atom.xml"
                class="social fas fa-rss flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="mailto:me@xxx.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/volantis-x/"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://music.163.com/#/user/home?id=260045301"
                class="social fas fa-headphones-alt flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        本站使用
        <a href="https://github.com/volantis-x/hexo-theme-volantis/" target="_blank" class="codename">Volantis</a>
        作为主题，总访问量为
          <span id="busuanzi_value_site_pv"><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden="true"></i></span>
          次
        
      
    
      
        <div class='copyright'>
        <p><a href="/">Copyright © 2017-2020 XXX</a></p>

        </div>
      
    
  </footer>


    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <div>
    
      
  

  <div id="rightmenu-wrapper">
    <ul class="list-v rightmenu" id="rightmenu-content">
      <li class='option'>
        <a class='vlts-menu opt fix-cursor-default' id='menu-copy-text' onclick='document.execCommand("copy")'><i class='fa fa-copy fa-fw'></i>复制文本</a>
        <hr id='hr-text'>
        <a class='vlts-menu opt fix-cursor-default' id='menu-copy-href'><i class='fa fa-link fa-fw'></i>复制链接</a>
        <a class='vlts-menu opt fix-cursor-default' id='menu-open-href'><i class='fa fa-external-link-square-alt fa-fw'></i>在新标签页打开</a>
        <hr id='hr-href'>
        <a class='vlts-menu opt fix-cursor-default' id='menu-copy-src'><i class='fa fa-image fa-fw'></i>复制图片地址</a>
        <hr id='hr-src'>
      </li>
      <li class='navigation'>
        <a class='nav icon-only fix-cursor-default' onclick='history.back()'><i class='fa fa-arrow-left fa-fw'></i></a>
        <a class='nav icon-only fix-cursor-default' onclick='history.forward()'><i class='fa fa-arrow-right fa-fw'></i></a>
        <a class='nav icon-only fix-cursor-default' onclick='window.location.reload()'><i class='fa fa-redo fa-fw'></i></a>
        <a class='nav icon-only fix-cursor-default' href='/'><i class='fa fa-home fa-fw'></i></a>
      </li>
      <hr>
      
        
      
        
      
        
          <hr>
        
      
        
          
    <li>
      <a class='vlts-menu fix-cursor-default' href=https://github.com/volantis-x/volantis-docs/
        
        
        
        
          id="https:githubcomvolantis-xvolantis-docs"
        >
        <i class='fa fa-code-branch fa-fw'></i> 本站源码
      </a>
    </li>
  
        
      
        
          
    <li>
      <a class='vlts-menu fix-cursor-default' href=https://github.com/volantis-x/hexo-theme-volantis/
        
        
        
        
          id="https:githubcomvolantis-xhexo-theme-volantis"
        >
        <i class='fa fa-code-branch fa-fw'></i> 主题源码
      </a>
    </li>
  
        
      
        
          <hr>
        
      
        
          
    <li>
      <a class='vlts-menu fix-cursor-default' 
        
        
        
          onclick="document.execCommand('print')"
        
        >
        <i class='fa fa-print fa-fw'></i> 打印页面
      </a>
    </li>
  
        
      
        
          <hr>
        
      
        
          <li class='music name'>
            <p class='nav music-title fix-cursor-default'></p>
          </li>
          <li class='music ctrl'>
            <a class='nav icon-only backward fix-cursor-default' onclick='aplayerBackward()'><i class='fa fa-step-backward fa-fw'></i></a>
            <a class='nav icon-only toggle fix-cursor-default' onclick='aplayerToggle()'><i class='fa fa-play fa-fw'></i></a>
            <a class='nav icon-only forward fix-cursor-default' onclick='aplayerForward()'><i class='fa fa-step-forward fa-fw'></i></a>
          </li>
          <li class='music volume'>
            <a class='nav volume'>
              <div class="aplayer-volume-bar-wrap">
                <div class="aplayer-volume-bar fix-cursor-pointer">
                  <div class="aplayer-volume"></div>
                  <i class='left fa fa-volume-off fa-fw'></i>
                  <i class='right fa fa-volume-up fa-fw'></i>
                </div>
              </div>
            </a>
          </li>
        
      
    </ul>
  </div>

  <script>
    window.document.oncontextmenu = function (event) {
      if (event.ctrlKey) return true;
      if (/Android|webOS|BlackBerry/i.test(navigator.userAgent)) return true;
      return popMenu(event);
    };
    document.addEventListener("click", function (event) {
      var mymenu = document.getElementById('rightmenu-wrapper');
      mymenu.style.display = "none";
    });
    function popMenu(event) {
      var mymenu = document.getElementById('rightmenu-wrapper');
      var menuContent = document.getElementById('rightmenu-content');
      var screenWidth = document.documentElement.clientWidth || document.body.clientWidth;
      var screenHeight = document.documentElement.clientHeight || document.body.clientHeight;
      mymenu.style.left = event.clientX + "px"; // 获取鼠标位置
      mymenu.style.top = event.clientY + "px";
      mymenu.style.display = 'block';
      if (event.clientX * 2 > screenWidth) {
        menuContent.classList.add('left');
      } else {
        menuContent.classList.remove('left');
      }
      if (event.clientY * 2 > screenHeight) {
        menuContent.classList.add('top');
      } else {
        menuContent.classList.remove('top');
      }

      let hrText = document.getElementById('hr-text');
      let hrSrc = document.getElementById('hr-src');
      let hrHref = document.getElementById('hr-href');

      // 选中图片
      let copySrc = document.getElementById('menu-copy-src');
      if (copySrc != undefined) {
        if (event.target.currentSrc) {
          copySrc.style.display = 'block';
          copySrc.addEventListener("click", function (e) {
            copyString(event.target.currentSrc);
          },{once: true});
          hrSrc.style.display = 'block';
        } else {
          copySrc.style.display = 'none';
          hrSrc.style.display = 'none';
        }
      }

      // 选中按钮
      // 判断是不是按钮
      let href = '';
      if (event.path) {
        for (i = 0; i < event.path.length; i++) {
          if (event.path[i].href != undefined && event.path[i].href.length > 0) {
            href = event.path[i].href;
          }
        }
      }

      let copyText = document.getElementById('menu-copy-text');
      copyText.style.display = 'none';
      hrText.style.display = 'none';
      if (href.length == 0) {
        // 选中文本
        if (window.getSelection().toString()) {
          copyText.style.display = 'block';
          hrText.style.display = 'block';
        }
      }

      // 在新标签页打开
      let openHref = document.getElementById('menu-open-href');
      if (openHref != undefined) {
        if (href.length > 0) {
          openHref.style.display = 'block';
          openHref.addEventListener("click", function (e) {
            window.open(href);
          },{once: true});
          hrHref.style.display = 'block';
        } else {
          openHref.style.display = 'none';
          hrHref.style.display = 'none';
        }
      }
      // 复制链接
      let copyHref = document.getElementById('menu-copy-href');
      if (copyHref != undefined) {
        if (href.length > 0) {
          copyHref.style.display = 'block';
          copyHref.addEventListener("click", function (e) {
            copyString(href);
          },{once: true});
        } else {
          copyHref.style.display = 'none';
        }
      }

      // 有音乐播放器
      if (true == true) {
        // 如果有aplayer，初始化一下
      	try {
      		checkAPlayer();
          updateTitle();
      	} catch (error) {
      		console.log(error);
      	}
      }

      return false; // 该行代码确保系统自带的右键菜单不会被调出
    }
    function hideMenu() {
      document.getElementById('rightmenu-wrapper').style.display = 'none';
    }
    function copyString(str) {
      const input = document.createElement('input');
      input.setAttribute('readonly', 'readonly');
      document.body.appendChild(input);
      input.setAttribute('value', str);
      input.select();
      document.execCommand('copy');
      document.body.removeChild(input);
    }
    document.execCommand('click');
  </script>


    
    
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5/dist/jquery.min.js"></script>



  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>



  <script async src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/001.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/002.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/003.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/004.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/005.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/006.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/012.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/016.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/019.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/033.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/034.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/035.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/038.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/039.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/042.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/046.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/051.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/052.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/054.jpg", "https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/056.jpg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('.cover') {
          $('.cover').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  



  <script>
    let APlayerController = new Object();
    APlayerController.id = '3175833810';  // 设定全局音乐播放ID
    APlayerController.volume = '0.7';
  </script>
  
    
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>

  
    
<script src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js"></script>

  
    
<script src="/js/aplayer.js"></script>

  




  <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script type="text/javascript">
  function pjax_gitalk() {
    let pageUrl = $.trim($('#pjax-comment-path').text()) === "none" ? 
      decodeURI(window.location.pathname) : $.trim($('#pjax-comment-path').text());
    
    let ALLPATH = '';
    if(ALLPATH != '') pageUrl = ALLPATH;

    if (document.getElementById('gitalk-container') != null) {
      var gitalk = new Gitalk({
        clientID: "a9f57bed080703426741",
        clientSecret: "03fe7aec06a7794dedfcc123b6475f0231f6a0ce",
        repo: "wmyskxz.github.io",
        owner: "wmyskxz",
        admin: "wmyskxz",
        id: pageUrl,
        distractionFreeMode: false  // Facebook-like distraction free mode
      });
      gitalk.render('gitalk-container');
    }
  }

  $(function () {
    pjax_gitalk();
  });
</script>




<!-- darkmodejs -->


<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
    var clipboard = new ClipboardJS('.btn-copy', {
        target: function (trigger) {
            return trigger.nextElementSibling
        }
    });
    function wait(callback, seconds) {
        var timelag = null;
        timelag = window.setTimeout(callback, seconds)
    }
    function pjax_initCopyCode() {
        var copyHtml = '';
        copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
        copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
        copyHtml += '</button>';
        $(".highlight .code pre").before(copyHtml);
        $(".article pre code").before(copyHtml);
        clipboard.off('success').on('success', function (e) {
            let $btn = $(e.trigger);
            $btn.addClass('copied');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-check-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPIED';
            wait(function () {
                $icon.removeClass('fa-check-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        });
        clipboard.off('error').on('error', function (e) {
            e.clearSelection();
            let $btn = $(e.trigger);
            $btn.addClass('copy-failed');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-times-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPY FAILED';
            wait(function () {
                $icon.removeClass('fa-times-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        })
    }
    $(function () {
        pjax_initCopyCode()
    });
</script>


<!-- scrollreveal -->

  <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    function pjax_scrollrebeal() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '32px',
        duration: '800',
        interval: '20',
        scale: '1',
        easing: 'ease-out'
      });
    }

    $(function () {
      pjax_scrollrebeal();
    });
  </script>

<!-- ******************************** -->

<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  function pjax_fancybox() {
    $(".article-entry").find("img").not('.inline').not('a img').each(function () { //渲染 fancybox
      var element = document.createElement("a"); // a 标签
      $(element).attr("class", "fancybox");
      $(element).attr("pjax-fancybox", "");  // 过滤 pjax
      $(element).attr("href", $(this).attr("src"));
      if ($(this).attr("data-original")) {
        $(element).attr("href", $(this).attr("data-original"));
      }
      $(element).attr("data-fancybox", "images");
      var caption = "";   // 描述信息
      if ($(this).attr('alt')) {  // 判断当前页面是否存在描述信息
        $(element).attr('data-caption', $(this).attr('alt'));
        caption = $(this).attr('alt');
      }
      var div = document.createElement("div");
      $(div).addClass("fancybox");
      $(this).wrap(div); // 最外层套 div ，其实主要作用还是 class 样式
      var span = document.createElement("span");
      $(span).addClass("image-caption");
      $(span).text(caption); // 加描述
      $(this).after(span);  // 再套一层描述
      $(this).wrap(element);  // 最后套 a 标签
    })
    $(".article-entry").find("img").fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
      closeClick: true,
      helpers: {
        overlay: {closeClick: true}
      },
      buttons: [
        "zoom",
        "close"
      ]
    });
  };
  $(function () {
    pjax_fancybox();
  });
</script>

<!-- ******************************** -->


  
<script src="/js/app.js"></script>




  
    
<script src="/js/search.js"></script>

  



  <script defer src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js" data-pjax></script>



  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function () {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>





  
    
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
  




    
      


<script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script>

<!-- 样式位于：source/css/_third-party/pjaxanimate.styl -->

<div class="pjax-animate">
  
    <script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>
    <div id="loading-bar-wrapper"><script>NProgress.configure({parent:"#loading-bar-wrapper",trickleSpeed: 100})</script></div>
    <script>
      window.ShowLoading = function() {
        NProgress.start();
      };
      window.HideLoading = function() {
        NProgress.done();
      }
    </script>
  
</div>

<script>
    var pjax;
    document.addEventListener('DOMContentLoaded', function () {
      pjax = new Pjax({
        elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([pjax-fancybox])',
        selectors: [
          "title",
          "#pjax-container",
          "#pjax-header-nav-list"
        ],
        cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
        timeout: 5000
      });
    });

    document.addEventListener('pjax:send', function (e) {
      window.stop(); // 相当于点击了浏览器的停止按钮

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = [""];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      window.subData = null; // 移除标题（用于一二级导航栏切换处）
      $.fancybox.close();    // 关闭弹窗
      $('.l_header .switcher .s-search').removeClass('active'); // 关闭移动端激活的搜索框
      $('.l_header').removeClass('z_search-open'); // 关闭移动端激活的搜索框
      $('.wrapper').removeClass('sub'); // 跳转页面时关闭二级导航

      // 解绑事件 避免重复监听
      $('.s-top').unbind('click');
      $('.menu a').unbind('click');
      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');
      window.ShowLoading();
    });

    document.addEventListener('pjax:complete', function () {
      // 关于百度统计对 SPA 页面的处理：
      // 方案一：百度统计>管理>单页应用设置中，打开开启按钮即可对SPA进行统计。 https://tongji.baidu.com/web/help/article?id=324
      // 方案二：取消注释下列代码。 https://tongji.baidu.com/web/help/article?id=235
      // 

      // 关于谷歌统计对 SPA 页面的处理：
      // 当应用以动态方式加载内容并更新地址栏中的网址时，也应该更新通过 gtag.js 存储的网页网址。
      // https://developers.google.cn/analytics/devguides/collection/gtagjs/single-page-applications?hl=zh-cn
      

      $('.nav-main').find('.list-v').not('.menu-phone').removeAttr("style",""); // 移除小尾巴的移除
      $('.menu-phone.list-v').removeAttr("style",""); // 移除小尾巴的移除
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });

      try{
        pjax_fancybox();
        
          
          if ('.cover') {
            $('.cover').backstretch("resize");
          } else {
            $.backstretch("resize");
          }
        
        
        document.querySelectorAll('pre code').forEach((block) => {
          hljs.highlightBlock(block);
        });
        
        
          pjax_scrollrebeal();
        
        
          pjax_initCopyCode();
        
        
        
        
          pjax_gitalk();
        
        
        
      } catch (e) {
        console.log(e);
      }
      window.HideLoading();
    });

    document.addEventListener('pjax:error', function (e) {
      window.HideLoading();
      window.location.href = e.triggerElement.href;
    });
</script>

    
  </div>
</body>
</html>
